<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Перезажигал</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@600;700;800&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#07080e;--bg2:#0c0e18;--surface:#161928;--surface2:#1d2235;--surface3:#242b42;
  --border:rgba(255,255,255,0.07);--border2:rgba(255,255,255,0.13);
  --accent:#7c6bff;--accent2:#a695ff;--accent3:#4fc3f7;
  --green:#3ecf8e;--red:#ff6b76;--yellow:#ffc948;--orange:#ff8c42;
  --text:#edf0ff;--text2:#8890b8;--text3:#444d6e;
  /* статусы */
  --s-online:#3ecf8e;--s-idle:#ffc948;--s-dnd:#ff6b76;--s-offline:#444d6e;--s-invisible:#444d6e;
}
html,body{height:100%;overflow:hidden;font-family:'Manrope',sans-serif;background:var(--bg);color:var(--text);font-size:14px;-webkit-overflow-scrolling:touch}
@supports (-webkit-touch-callout:none){body{position:fixed;width:100%}}
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--surface3);border-radius:4px}

/* ── APP THEMES ── */
body.theme-nord{--bg:#1a1e2e;--bg2:#1f2335;--surface:#24283b;--surface2:#2f3549;--surface3:#3b4261;--border:rgba(255,255,255,.08);--border2:rgba(255,255,255,.14);--accent:#7aa2f7;--accent2:#7dcfff;--text:#c0caf5;--text2:#9aa5ce;--text3:#565f89}
body.theme-dracula{--bg:#1a1625;--bg2:#211d2e;--surface:#2a2640;--surface2:#332e4a;--surface3:#3e3855;--border:rgba(255,255,255,.07);--border2:rgba(255,255,255,.13);--accent:#bd93f9;--accent2:#ff79c6;--text:#f8f8f2;--text2:#b0aac8;--text3:#5c5270}
body.theme-forest{--bg:#0e1a12;--bg2:#131f16;--surface:#1a2b1e;--surface2:#213526;--surface3:#2a4232;--border:rgba(255,255,255,.07);--border2:rgba(255,255,255,.13);--accent:#4ade80;--accent2:#86efac;--text:#ecfef0;--text2:#86c898;--text3:#3a6048}
body.theme-abyss{--bg:#000;--bg2:#050508;--surface:#0a0a10;--surface2:#0f0f18;--surface3:#14141f;--border:rgba(255,255,255,.06);--border2:rgba(255,255,255,.1);--accent:#7c6bff;--accent2:#a695ff;--text:#dde0ff;--text2:#6870a0;--text3:#303555}
body.theme-sunset{--bg:#120c0e;--bg2:#1a0e12;--surface:#261420;--surface2:#321a2a;--surface3:#3f2236;--border:rgba(255,255,255,.07);--border2:rgba(255,255,255,.13);--accent:#fb923c;--accent2:#f472b6;--text:#ffeef5;--text2:#c87494;--text3:#6b3555}
body.theme-matrix{--bg:#000904;--bg2:#000f05;--surface:#001a0a;--surface2:#002410;--surface3:#003016;--border:rgba(0,255,65,.06);--border2:rgba(0,255,65,.12);--accent:#00ff41;--accent2:#39ff14;--text:#ccffe5;--text2:#44c870;--text3:#1a5c30}

/* ── EFFECTS CANVAS ── */
#fx-canvas{position:fixed;inset:0;pointer-events:none;z-index:1;opacity:.7}

/* ── FONT SIZE ── */
body.fs-sm{font-size:12px}body.fs-md{font-size:14px}body.fs-lg{font-size:16px}body.fs-xl{font-size:18px}

/* ══════════ NEW ADMIN FEATURES CSS ══════════ */
/* ── Spy Mode ── */
.spy-user-card{display:flex;align-items:center;gap:10px;padding:10px 12px;background:rgba(255,255,255,.02);border-radius:10px;cursor:pointer;border:1px solid transparent;transition:.15s;margin-bottom:6px}
.spy-user-card:hover{background:rgba(124,107,255,.08);border-color:rgba(124,107,255,.2)}
.spy-user-card.on{background:rgba(124,107,255,.12);border-color:rgba(124,107,255,.4)}
.spy-conv-list{max-height:200px;overflow-y:auto;margin-bottom:12px}
.spy-conv-item{display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:8px;cursor:pointer;transition:.15s;border:1px solid transparent}
.spy-conv-item:hover{background:rgba(79,195,247,.08);border-color:rgba(79,195,247,.2)}
.spy-conv-item.on{background:rgba(79,195,247,.12);border-color:rgba(79,195,247,.4)}
.spy-msg-stream{background:rgba(0,0,0,.2);border-radius:12px;border:1px solid rgba(255,255,255,.06);height:320px;overflow-y:auto;padding:12px;display:flex;flex-direction:column;gap:8px}
.spy-msg{padding:8px 12px;border-radius:8px;font-size:12px;line-height:1.5;position:relative;max-width:80%}
.spy-msg.from-a{background:rgba(124,107,255,.15);align-self:flex-start;border-bottom-left-radius:2px}
.spy-msg.from-b{background:rgba(79,195,247,.12);align-self:flex-end;border-bottom-right-radius:2px}
.spy-msg-meta{font-size:10px;color:var(--text3);margin-bottom:3px}
.spy-live-pulse{display:inline-block;width:7px;height:7px;border-radius:50%;background:#3ecf8e;animation:livePulse 1.4s ease-in-out infinite;margin-right:5px}
@keyframes livePulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(.8)}}
.spy-empty{text-align:center;color:var(--text3);font-size:13px;padding:40px;opacity:.6}

/* ── Multi-account detection ── */
.multi-group{background:rgba(255,201,72,.04);border:1px solid rgba(255,201,72,.15);border-radius:12px;padding:14px;margin-bottom:10px}
.multi-group-ip{font-family:monospace;font-size:11px;color:var(--yellow);font-weight:700;margin-bottom:8px;display:flex;align-items:center;gap:6px}
.multi-account-row{display:flex;align-items:center;gap:8px;padding:6px 0;border-top:1px solid rgba(255,255,255,.04)}
.multi-risk{padding:2px 8px;border-radius:20px;font-size:10px;font-weight:700;text-transform:uppercase}
.multi-risk.high{background:rgba(255,107,118,.15);color:var(--red)}
.multi-risk.medium{background:rgba(255,201,72,.12);color:var(--yellow)}

/* ── Shadow Mute indicator ── */
.shadow-muted-badge{padding:2px 8px;background:rgba(79,195,247,.1);border:1px solid rgba(79,195,247,.25);color:var(--accent3);border-radius:20px;font-size:9px;font-weight:700;letter-spacing:.05em}

/* ── AutoMod ── */
.automod-rule{display:flex;align-items:center;gap:10px;padding:10px 14px;background:rgba(255,255,255,.02);border-radius:10px;border:1px solid var(--border);margin-bottom:6px;transition:.15s}
.automod-rule:hover{border-color:var(--border2)}
.automod-rule-word{font-family:monospace;font-size:12px;color:var(--accent2);font-weight:700;flex:1}
.automod-action-badge{padding:2px 8px;border-radius:20px;font-size:10px;font-weight:700}
.automod-action-badge.warn{background:rgba(255,201,72,.12);color:var(--yellow)}
.automod-action-badge.mute{background:rgba(255,107,118,.1);color:var(--red)}
.automod-action-badge.ban{background:rgba(255,60,60,.15);color:#ff4444}
.automod-action-badge.delete{background:rgba(100,100,100,.15);color:var(--text3)}

/* ── Roles ── */
.role-badge{display:inline-flex;align-items:center;gap:4px;padding:3px 8px;border-radius:20px;font-size:10px;font-weight:700;letter-spacing:.04em}
.role-badge.vip{background:linear-gradient(135deg,rgba(255,201,72,.2),rgba(255,140,66,.15));border:1px solid rgba(255,201,72,.3);color:var(--yellow)}
.role-badge.mod{background:rgba(62,207,142,.1);border:1px solid rgba(62,207,142,.25);color:var(--green)}
.role-badge.dev{background:rgba(124,107,255,.12);border:1px solid rgba(124,107,255,.3);color:var(--accent2)}
.role-badge.ghost{background:rgba(150,150,180,.08);border:1px solid rgba(150,150,180,.2);color:var(--text3)}
.role-opt{padding:10px 14px;border-radius:12px;border:2px solid transparent;cursor:pointer;background:var(--surface2);transition:.15s;text-align:center}
.role-opt:hover{border-color:rgba(255,255,255,.15)}
.role-opt.on{border-color:var(--accent)}

/* ── Live Feed ── */
.live-feed-item{display:flex;align-items:flex-start;gap:10px;padding:8px 12px;border-radius:8px;background:rgba(255,255,255,.02);margin-bottom:4px;animation:feedItemIn .25s ease both;border-left:2px solid var(--border2)}
@keyframes feedItemIn{from{opacity:0;transform:translateX(-8px)}to{opacity:1;transform:none}}
.live-feed-item.join{border-left-color:var(--green)}
.live-feed-item.ban{border-left-color:var(--red)}
.live-feed-item.msg{border-left-color:var(--accent)}
.live-feed-item.warn{border-left-color:var(--yellow)}
.live-feed-item.leave{border-left-color:var(--text3)}
.live-feed-icon{font-size:16px;flex-shrink:0;margin-top:1px}
.live-feed-text{font-size:12px;color:var(--text2);line-height:1.5;flex:1}
.live-feed-time{font-size:10px;color:var(--text3);white-space:nowrap;margin-top:2px}
.live-feed-wrap{height:400px;overflow-y:auto;display:flex;flex-direction:column}
#live-feed-container{display:flex;flex-direction:column-reverse;min-height:100%}

/* ── Impersonate ── */
.impersonate-preview{background:rgba(124,107,255,.06);border:1px solid rgba(124,107,255,.2);border-radius:12px;padding:14px;margin:12px 0;display:none}
.impersonate-preview.show{display:block}
.imp-fake-bubble{background:rgba(124,107,255,.18);border-radius:16px;border-bottom-right-radius:3px;padding:10px 14px;font-size:13px;color:var(--text);max-width:70%;margin-left:auto}

/* ── GeoIP ── */
.geoip-card{background:rgba(255,255,255,.02);border-radius:10px;border:1px solid var(--border);padding:12px 14px;margin-bottom:8px}
.geoip-flag{font-size:24px;margin-right:8px}
.geoip-info{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:8px}
.geoip-field{font-size:11px}
.geoip-label{color:var(--text3);display:block;margin-bottom:1px}
.geoip-val{color:var(--text2);font-weight:600}

/* ── Admin Panel new tabs width fix ── */
.adm-nav{overflow-y:auto}

/* ── Activity heatmap ── */
.heatmap-grid{display:grid;grid-template-columns:repeat(24,1fr);gap:2px;margin-top:8px}
.heatmap-cell{height:14px;border-radius:2px;background:rgba(124,107,255,.08);transition:.2s}
.heatmap-cell:hover{transform:scale(1.3)}

/* ── User Timeline ── */
.timeline-item{display:flex;gap:12px;padding:8px 0;position:relative}
.timeline-item::before{content:'';position:absolute;left:15px;top:0;bottom:0;width:1px;background:rgba(255,255,255,.06);z-index:0}
.timeline-dot{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0;position:relative;z-index:1}
.timeline-content{flex:1;padding-top:4px}

/* ── THEME PICKER ── */
.theme-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:16px}
.theme-opt{padding:6px;border-radius:12px;border:2px solid transparent;cursor:pointer;text-align:center;transition:.18s;background:var(--surface2)}
.theme-opt:hover{border-color:rgba(255,255,255,.2)}
.theme-opt.on{border-color:var(--accent)}
.theme-swatch{height:28px;border-radius:7px;margin-bottom:5px}
.theme-opt span{font-size:9px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.3px}
.theme-opt.on span{color:var(--accent2)}

/* ── EFFECTS PICKER ── */
.fx-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:16px}
.fx-opt{padding:10px 6px;border-radius:12px;border:2px solid transparent;cursor:pointer;text-align:center;background:var(--surface2);transition:.18s}
.fx-opt:hover{border-color:rgba(255,255,255,.2)}
.fx-opt.on{border-color:var(--accent);background:rgba(124,107,255,.12)}
.fx-opt .fx-ico{font-size:22px;margin-bottom:4px}
.fx-opt span{font-size:9px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.3px;display:block}
.fx-opt.on span{color:var(--accent2)}

/* ── LOADER ── */
#loader{position:fixed;inset:0;background:var(--bg);z-index:9999;display:flex;flex-direction:column;align-items:center;justify-content:center}
.ld-logo{display:flex;align-items:center;gap:14px;margin-bottom:44px;animation:fadeUp .6s ease both}
.ld-name{font-family:'Syne',sans-serif;font-size:34px;font-weight:800;background:linear-gradient(135deg,#fff,#a695ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.ld-bar-wrap{width:200px;height:3px;background:rgba(255,255,255,.07);border-radius:3px;overflow:hidden;margin-bottom:18px}
.ld-bar{height:100%;width:0;background:linear-gradient(90deg,#7c6bff,#a695ff,#4fc3f7);border-radius:3px;animation:ldBar 2s cubic-bezier(.4,0,.2,1) forwards}
@keyframes ldBar{0%{width:0}55%{width:70%}80%{width:88%}100%{width:100%}}
.ld-txt{font-size:13px;color:var(--text3);animation:fadeUp .8s .3s ease both}
.ld-dots{display:flex;gap:5px;margin-top:10px}
.ld-dot{width:5px;height:5px;border-radius:50%;background:var(--accent);opacity:.3;animation:ldot 1.2s ease infinite}
.ld-dot:nth-child(2){animation-delay:.2s}.ld-dot:nth-child(3){animation-delay:.4s}
@keyframes ldot{0%,100%{opacity:.2;transform:scale(.8)}50%{opacity:1;transform:scale(1)}}
#loader.out{animation:loaderOut .45s ease both}
@keyframes loaderOut{to{opacity:0;transform:scale(1.03)}}
@keyframes hlflash{0%,100%{box-shadow:none}50%{box-shadow:0 0 0 3px var(--accent2)}}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:none}}

/* ── AUTH ── */
#auth{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:900;background:var(--bg);overflow:hidden}
.auth-bg{
  position:absolute;inset:0;
  background:
    radial-gradient(ellipse 70% 60% at 20% 10%, rgba(124,107,255,.18) 0%, transparent 60%),
    radial-gradient(ellipse 50% 70% at 80% 90%, rgba(79,195,247,.12) 0%, transparent 55%),
    radial-gradient(ellipse 40% 40% at 60% 50%, rgba(236,72,153,.07) 0%, transparent 50%);
}
/* Геральдическая сетка */
.auth-grid{
  position:absolute;inset:0;
  background-image:
    linear-gradient(rgba(255,255,255,.025) 1px,transparent 1px),
    linear-gradient(90deg,rgba(255,255,255,.025) 1px,transparent 1px);
  background-size:40px 40px;
  mask-image:radial-gradient(ellipse 80% 80% at center,black 40%,transparent 100%);
}
/* Декоративные орбиты */
.auth-orbs{position:absolute;inset:0;overflow:hidden;pointer-events:none}
.auth-orb{position:absolute;border-radius:50%;filter:blur(60px);opacity:.25;animation:orbFloat 8s ease-in-out infinite}
.auth-orb:nth-child(1){width:300px;height:300px;background:var(--accent);top:-80px;left:-60px;animation-delay:0s}
.auth-orb:nth-child(2){width:200px;height:200px;background:var(--accent3);bottom:-40px;right:-40px;animation-delay:-3s}
.auth-orb:nth-child(3){width:160px;height:160px;background:#ec4899;top:40%;left:60%;animation-delay:-5s}
@keyframes orbFloat{0%,100%{transform:translate(0,0) scale(1)}33%{transform:translate(20px,-15px) scale(1.05)}66%{transform:translate(-10px,20px) scale(.95)}}

.auth-wrap{position:relative;width:440px;z-index:1}
.auth-card{
  background:linear-gradient(145deg,rgba(16,19,34,.97) 0%,rgba(10,12,22,.99) 100%);
  border:1px solid rgba(255,255,255,.08);
  border-top:1px solid rgba(255,255,255,.14);
  border-radius:28px;
  padding:48px 44px;
  box-shadow:
    0 50px 120px rgba(0,0,0,.8),
    0 0 0 1px rgba(124,107,255,.1),
    0 0 80px rgba(124,107,255,.05),
    inset 0 1px 0 rgba(255,255,255,.06),
    inset 0 -1px 0 rgba(0,0,0,.3);
  animation:authCardIn .65s cubic-bezier(.34,1.4,.64,1) both;
  position:relative;
  overflow:hidden;
}
.auth-card::before{
  content:'';position:absolute;top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,rgba(124,107,255,.6),rgba(79,195,247,.4),transparent);
}
.auth-card::after{
  content:'';position:absolute;inset:0;border-radius:28px;
  background:radial-gradient(ellipse 80% 40% at 50% 0%,rgba(124,107,255,.06) 0%,transparent 70%);
  pointer-events:none;
}
@keyframes authCardIn{from{opacity:0;transform:translateY(30px) scale(.97)}to{opacity:1;transform:none}}

/* Герб в центре */
.auth-crest{
  display:flex;flex-direction:column;align-items:center;gap:10px;
  margin-bottom:32px;position:relative;
}
.auth-crest-img{
  width:80px;height:80px;border-radius:50%;object-fit:cover;
  box-shadow:0 0 0 3px rgba(124,107,255,.25),0 0 0 6px rgba(124,107,255,.08),0 12px 40px rgba(0,0,0,.6);
  animation:crestGlow 3s ease-in-out infinite alternate;
}
@keyframes crestGlow{
  from{box-shadow:0 0 0 3px rgba(124,107,255,.25),0 0 0 6px rgba(124,107,255,.08),0 12px 40px rgba(0,0,0,.6),0 0 30px rgba(124,107,255,.1)}
  to{box-shadow:0 0 0 3px rgba(124,107,255,.5),0 0 0 8px rgba(124,107,255,.12),0 12px 40px rgba(0,0,0,.6),0 0 50px rgba(124,107,255,.25)}
}
.auth-crest-divider{
  display:flex;align-items:center;gap:12px;width:100%;
}
.auth-crest-line{flex:1;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1))}
.auth-crest-line:last-child{background:linear-gradient(90deg,rgba(255,255,255,.1),transparent)}
.auth-crest-diamond{width:5px;height:5px;background:var(--accent);transform:rotate(45deg);flex-shrink:0;box-shadow:0 0 8px var(--accent)}

.brand{display:none}
.brand-name{font-family:'Syne',sans-serif;font-size:26px;font-weight:800;background:linear-gradient(135deg,#fff 30%,var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:-.3px}

.auth-title{
  font-family:'Syne',sans-serif;font-size:22px;font-weight:800;
  margin-bottom:4px;text-align:center;
  background:linear-gradient(135deg,#fff,rgba(255,255,255,.7));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.auth-sub{color:var(--text3);font-size:12.5px;margin-bottom:24px;line-height:1.55;text-align:center;letter-spacing:.2px}
.tabs{
  display:flex;background:rgba(0,0,0,.25);border-radius:12px;padding:4px;
  margin-bottom:22px;border:1px solid rgba(255,255,255,.06);
  box-shadow:inset 0 1px 3px rgba(0,0,0,.3);
}
.tab-btn{
  flex:1;padding:10px;border-radius:9px;border:none;background:none;
  color:var(--text3);font-family:'Manrope',sans-serif;font-size:13px;font-weight:700;
  cursor:pointer;transition:.25s;letter-spacing:.2px;
}
.tab-btn.on{
  background:linear-gradient(135deg,rgba(124,107,255,.25),rgba(79,195,247,.1));
  color:var(--text);
  box-shadow:0 2px 12px rgba(0,0,0,.3),inset 0 1px 0 rgba(255,255,255,.08);
  border:1px solid rgba(124,107,255,.2);
}
.fld{margin-bottom:14px}
.fld label{display:block;font-size:10.5px;font-weight:800;color:rgba(255,255,255,.3);text-transform:uppercase;letter-spacing:1px;margin-bottom:7px}
.inp{
  width:100%;
  background:rgba(255,255,255,.03);
  border:1.5px solid rgba(255,255,255,.07);
  border-radius:12px;padding:13px 16px;
  color:var(--text);font-family:'Manrope',sans-serif;font-size:14px;
  outline:none;transition:.25s;
  box-shadow:inset 0 2px 4px rgba(0,0,0,.2);
}
.inp:focus{
  border-color:rgba(124,107,255,.5);
  background:rgba(124,107,255,.05);
  box-shadow:0 0 0 4px rgba(124,107,255,.1),inset 0 2px 4px rgba(0,0,0,.15);
}
.inp::placeholder{color:rgba(255,255,255,.18)}
.auth-err{color:var(--red);font-size:12px;margin-bottom:12px;display:none;padding:10px 14px;background:rgba(255,107,118,.07);border:1px solid rgba(255,107,118,.18);border-radius:10px;letter-spacing:.2px;backdrop-filter:blur(4px)}
.auth-err.on{display:block}
.btn-primary{
  width:100%;padding:15px;
  background:linear-gradient(135deg,#6c5ce7,#7c6bff,#9b8bff);
  border:none;border-radius:13px;color:#fff;
  font-family:'Syne',sans-serif;font-size:14px;font-weight:800;
  cursor:pointer;margin-top:6px;transition:.25s;
  box-shadow:0 8px 28px rgba(124,107,255,.4),inset 0 1px 0 rgba(255,255,255,.2);
  letter-spacing:.5px;text-transform:uppercase;position:relative;overflow:hidden;
}
.btn-primary::before{
  content:'';position:absolute;top:-50%;left:-60%;width:40%;height:200%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.15),transparent);
  transform:skewX(-20deg);transition:.6s;
}
.btn-primary:hover::before{left:120%}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 14px 36px rgba(124,107,255,.55),inset 0 1px 0 rgba(255,255,255,.25)}
.btn-primary:active{transform:translateY(0);box-shadow:0 4px 16px rgba(124,107,255,.3)}
.hidden{display:none!important}

/* ── APP ── */
#app{display:none;height:100vh;width:100vw}
#app.on{display:flex}

/* ── SIDEBAR ── */
.sidebar{width:295px;min-width:295px;height:100vh;background:linear-gradient(180deg,rgba(12,14,24,.98) 0%,rgba(9,11,20,.99) 100%);border-right:1px solid var(--border);display:flex;flex-direction:column}
.sb-head{padding:14px 16px 12px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border)}
.sb-brand{font-family:'Syne',sans-serif;font-size:17px;font-weight:800;display:flex;align-items:center;gap:9px;background:linear-gradient(135deg,#fff,var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.sb-btns{display:flex;gap:2px}
.ico-btn{width:32px;height:32px;border-radius:9px;border:none;background:none;color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.15s;flex-shrink:0}
.ico-btn:hover{background:var(--surface2);color:var(--text)}
.ico-btn svg{width:16px;height:16px;stroke:currentColor;fill:none;stroke-width:1.8}
.sb-search{padding:10px 12px;border-bottom:1px solid var(--border)}
.srch-wrap{position:relative}
.srch-wrap svg{position:absolute;left:10px;top:50%;transform:translateY(-50%);width:14px;height:14px;stroke:var(--text3);fill:none;stroke-width:2;pointer-events:none}
.srch-inp{width:100%;background:var(--surface);border:1.5px solid transparent;border-radius:10px;padding:9px 10px 9px 32px;color:var(--text);font-family:'Manrope',sans-serif;font-size:13px;outline:none;transition:.2s}
.srch-inp:focus{border-color:var(--accent)}
.srch-inp::placeholder{color:var(--text3)}
.filter-tabs{display:flex;padding:6px 10px;gap:3px;border-bottom:1px solid var(--border)}
.ftab{flex:1;padding:7px 4px;border-radius:8px;border:none;background:none;color:var(--text3);font-family:'Manrope',sans-serif;font-size:11px;font-weight:600;cursor:pointer;transition:.15s;text-align:center}
.ftab.on{background:rgba(124,107,255,.13);color:var(--accent2)}
.ftab:hover:not(.on){color:var(--text2)}
.chat-list{flex:1;overflow-y:auto;padding:4px 0}
.ci{display:flex;align-items:center;gap:11px;padding:9px 14px;cursor:pointer;transition:.12s;border-left:3px solid transparent;position:relative}
.ci:hover{background:var(--surface)}
.ci.on{background:rgba(124,107,255,.1);border-left-color:var(--accent)}
.ava{width:46px;height:46px;min-width:46px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-size:17px;font-weight:700;position:relative;flex-shrink:0;overflow:hidden}
.ava img{width:100%;height:100%;object-fit:cover;border-radius:50%}
.ava.sm{width:30px;height:30px;min-width:30px;font-size:12px}
.ava.xs{width:22px;height:22px;min-width:22px;font-size:9px}

/* Индикатор присутствия (Discord-style) */
.presence-ring{position:absolute;bottom:0px;right:0px;width:13px;height:13px;border:2.5px solid var(--bg2);border-radius:50%;flex-shrink:0}
.presence-ring.online{background:var(--s-online)}
.presence-ring.idle{background:var(--s-idle)}
.presence-ring.dnd{background:var(--s-dnd)}
.presence-ring.offline,.presence-ring.invisible{background:var(--s-offline)}
/* Idle — луна внутри */
.presence-ring.idle::after{content:'';position:absolute;inset:1px;border-radius:50%;background:var(--s-idle);clip-path:inset(0 40% 0 0)}
/* DND — черточка */
.presence-ring.dnd::after{content:'';position:absolute;top:50%;left:1.5px;right:1.5px;height:2px;background:#fff;transform:translateY(-50%);border-radius:2px}
/* offline — кружок пустой */
.presence-ring.offline{background:transparent;border-color:var(--s-offline);border-width:2px}

.ci-meta{flex:1;min-width:0}
.ci-name{font-weight:600;font-size:13.5px;margin-bottom:2px;display:flex;align-items:center;gap:5px;overflow:visible}
.ci-name-txt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:0;max-width:120px}
.ci-prev{font-size:12px;color:var(--text2);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.ci-right{display:flex;flex-direction:column;align-items:flex-end;gap:4px;flex-shrink:0;min-width:32px}
.ci-time{font-size:11px;color:var(--text3)}
.badge{background:var(--accent);color:#fff;border-radius:20px;font-size:10px;font-weight:700;padding:2px 6px;min-width:18px;text-align:center}
.ci-checks { display:inline-flex; align-items:center; opacity:.7; }

/* ── Message read ticks (SVG double checkmarks) ── */
.msg-ticks {
  display:inline-flex;align-items:center;
  color:rgba(255,255,255,.45);
  transition:color .3s ease;
  margin-left:1px;
}
.msg-ticks.read {
  color:var(--accent3);
  filter:drop-shadow(0 0 3px rgba(79,195,247,.5));
}
.verified-badge{
  width:16px;height:16px;
  background:linear-gradient(135deg,#4fc3f7 0%,#7c6bff 60%,#a695ff 100%);
  border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;
  box-shadow:0 0 8px rgba(79,195,247,.5),0 0 0 1.5px rgba(255,255,255,.15);
  transition:transform .2s cubic-bezier(.34,1.56,.64,1),box-shadow .2s;
  cursor:default;position:relative;
}
.verified-badge svg{width:9px;height:9px;stroke:white;fill:none;stroke-width:3;filter:drop-shadow(0 1px 1px rgba(0,0,0,.3))}
.verified-badge::after{display:none}
.verified-badge::before{display:none}
.verified-badge:hover{transform:scale(1.2);box-shadow:0 0 14px rgba(79,195,247,.7),0 0 0 2px rgba(124,107,255,.3)}

/* ═══════════════════════════════════════════════════════
   ★  DEVELOPER STAR — Красная звезда разработчика
   ═══════════════════════════════════════════════════════ */
@keyframes devPulse{
  0%,100%{filter:drop-shadow(0 0 3px rgba(255,100,60,.5))}
  50%{filter:drop-shadow(0 0 8px rgba(255,120,60,.9)) drop-shadow(0 0 14px rgba(255,60,30,.4))}
}
@keyframes devAppear{
  0%{transform:scale(0) rotate(-60deg);opacity:0}
  65%{transform:scale(1.18) rotate(8deg);opacity:1}
  100%{transform:scale(1) rotate(0deg);opacity:1}
}
.dev-badge{
  position:relative;
  width:18px;height:18px;
  display:inline-flex;align-items:center;justify-content:center;
  flex-shrink:0;cursor:default;
  /* Многослойный фон: внутренний блик + тёмно-красный → ярко-красный */
  background:
    radial-gradient(circle at 40% 30%,rgba(255,220,200,.35) 0%,transparent 50%),
    linear-gradient(145deg,#ff6b4a 0%,#e53935 30%,#b71c1c 60%,#c62828 80%,#ff3d30 100%);
  border-radius:5px;
  /* Рамка + свечение */
  box-shadow:
    0 0 0 1px rgba(255,180,120,.25),
    0 0 10px rgba(255,80,40,.6),
    0 2px 6px rgba(150,0,0,.6),
    inset 0 1px 0 rgba(255,255,255,.22),
    inset 0 -1px 0 rgba(0,0,0,.2);
  animation:devAppear .55s cubic-bezier(.34,1.56,.64,1) both;
  transition:transform .22s cubic-bezier(.34,1.56,.64,1), box-shadow .22s;
  /* Пульс только для SVG (через filter на svg) */
}
/* Верхний блик (имитация стекла) */
.dev-badge::before{
  content:'';
  position:absolute;top:2px;left:3px;right:3px;height:5px;
  background:linear-gradient(180deg,rgba(255,255,255,.38) 0%,transparent 100%);
  border-radius:3px 3px 0 0;
  pointer-events:none;
}
/* Тултип — убран из CSS, реализован через JS глобальный тултип */
.dev-badge::after{display:none}
.dev-badge svg{
  width:11px;height:11px;fill:#fff;
  position:relative;z-index:1;
  animation:devPulse 2s ease-in-out 1s infinite;
  filter:drop-shadow(0 0 2px rgba(255,200,160,.7)) drop-shadow(0 1px 2px rgba(0,0,0,.5));
}
.dev-badge:hover{
  transform:scale(1.3) rotate(15deg);
  box-shadow:
    0 0 0 2px rgba(255,130,80,.45),
    0 0 18px rgba(255,80,40,.9),
    0 4px 12px rgba(180,0,0,.6),
    inset 0 1px 0 rgba(255,255,255,.28);
}
/* Sidebar footer */
.sb-footer{padding:10px 12px;border-top:1px solid var(--border);display:flex;align-items:center;gap:10px;flex-shrink:0;position:relative}
.sb-footer-left{display:flex;align-items:center;gap:10px;flex:1;min-width:0;cursor:pointer;transition:.15s;border-radius:8px;padding:4px 6px}
.sb-footer-left:hover{background:var(--surface)}
.sb-fi{flex:1;min-width:0}
.sb-fn{font-weight:700;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.sb-ft{font-size:11px;color:var(--text3);display:flex;align-items:center;gap:4px}
.sb-status-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}

/* Меню статусов */
.status-menu{position:absolute;bottom:calc(100% + 6px);left:10px;background:var(--surface);border:1px solid var(--border2);border-radius:14px;padding:6px;min-width:210px;z-index:350;box-shadow:0 20px 60px rgba(0,0,0,.6);display:none}
.status-menu.on{display:block;animation:fadeUp .18s ease both}
.status-opt{display:flex;align-items:center;gap:10px;padding:8px 10px;border-radius:9px;cursor:pointer;transition:.12s;font-size:13px;font-weight:600}
.status-opt:hover{background:var(--surface2)}
.status-opt.active{background:rgba(124,107,255,.12);color:var(--accent2)}
.status-opt-dot{width:10px;height:10px;border-radius:50%;flex-shrink:0;position:relative}
.status-opt-dot.online{background:var(--s-online)}
.status-opt-dot.idle{background:var(--s-idle)}
.status-opt-dot.dnd{background:var(--s-dnd)}
.status-opt-dot.invisible{background:transparent;border:2px solid var(--s-offline)}
.status-opt-sub{font-size:11px;color:var(--text3);font-weight:400}
.new-chat-row{display:flex;align-items:center;gap:9px;padding:9px 14px;cursor:pointer;transition:.12s;color:var(--accent2);font-weight:600;font-size:13px;border-top:1px solid var(--border)}
.new-chat-row:hover{background:rgba(124,107,255,.07)}
.new-chat-row svg{width:15px;height:15px;stroke:currentColor;fill:none;stroke-width:2.2;flex-shrink:0}

/* ── MAIN ── */
.main{flex:1;min-width:0;height:100vh;display:flex;flex-direction:column;background:radial-gradient(ellipse 80% 60% at 50% 80%,rgba(124,107,255,.04) 0%,var(--bg) 60%)}
.empty{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:22px;text-align:center;padding:40px;position:relative}
.empty::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 60% 50% at 50% 40%,rgba(124,107,255,.06) 0%,transparent 70%);pointer-events:none}
.empty-ico{width:130px;height:130px;border-radius:36px;background:linear-gradient(135deg,var(--surface),var(--surface2));border:1px solid var(--border2);display:flex;align-items:center;justify-content:center;font-size:36px;box-shadow:0 20px 80px rgba(0,0,0,.5),0 0 0 1px rgba(124,107,255,.15),0 0 60px rgba(124,107,255,.08);animation:crestGlow 3s ease-in-out infinite alternate;position:relative;overflow:hidden}
.empty-ico::after{content:'';position:absolute;inset:0;border-radius:36px;background:radial-gradient(ellipse 80% 60% at 50% 0%,rgba(124,107,255,.08) 0%,transparent 70%);pointer-events:none}
.empty h2{font-family:'Syne',sans-serif;font-size:24px;font-weight:800;background:linear-gradient(135deg,#fff 30%,var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.empty p{color:var(--text2);font-size:13.5px;max-width:280px;line-height:1.65}

/* ── CHAT VIEW ── */
.cv{display:none;flex-direction:column;height:100vh;position:relative}
.cv.on{display:flex}
.chat-hdr{padding:12px 18px;border-bottom:1px solid rgba(255,255,255,.05);display:flex;align-items:center;gap:11px;background:rgba(7,8,14,.9);backdrop-filter:blur(24px);flex-shrink:0;box-shadow:0 1px 0 rgba(255,255,255,.04)}
.hdr-info{flex:1;cursor:pointer;min-width:0}
.hdr-name{font-weight:700;font-size:15px;display:flex;align-items:center;gap:6px}
.hdr-name-txt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:220px}
.hdr-status{font-size:11.5px;margin-top:1px;display:flex;align-items:center;gap:5px}
.hdr-status-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0}
.hdr-status-dot.online{background:var(--s-online)}
.hdr-status-dot.idle{background:var(--s-idle)}
.hdr-status-dot.dnd{background:var(--s-dnd)}
.hdr-status-dot.offline,.hdr-status-dot.invisible{background:var(--s-offline)}
.hdr-status-txt.online{color:var(--s-online)}
.hdr-status-txt.idle{color:var(--s-idle)}
.hdr-status-txt.dnd{color:var(--s-dnd)}
.hdr-status-txt.offline,.hdr-status-txt.invisible{color:var(--text3)}
.hdr-acts{display:flex;gap:2px}

/* pinned */
.pinned{background:rgba(124,107,255,.07);border-bottom:1px solid rgba(124,107,255,.14);padding:6px 18px;display:flex;align-items:center;gap:8px;font-size:12px;color:var(--text2);cursor:pointer;flex-shrink:0;transition:.15s}
.pinned:hover{background:rgba(124,107,255,.12)}
.pinned svg{width:12px;height:12px;fill:var(--accent2);flex-shrink:0}

/* messages */
.msgs{flex:1;overflow-y:auto;padding:16px 18px;display:flex;flex-direction:column;gap:1px}
.date-sep{text-align:center;margin:10px 0;position:relative}
.date-sep::before,.date-sep::after{content:'';position:absolute;top:50%;height:1px;background:var(--border);width:calc(50% - 65px)}
.date-sep::before{left:0}.date-sep::after{right:0}
.date-sep span{font-size:11px;color:var(--text3);background:var(--bg);padding:0 10px;position:relative}
.msg-row{display:flex;align-items:flex-end;gap:7px;margin-bottom:2px}
.msg-row.me{flex-direction:row-reverse}
.msg-row.me .ava{display:none}
.bw{display:flex;flex-direction:column;max-width:62%;gap:2px}
.msg-row.me .bw{align-items:flex-end}
.bubble{padding:10px 14px;border-radius:18px;font-size:14px;line-height:1.52;word-break:break-word;position:relative}
.bubble.in{background:var(--surface);border:1px solid var(--border);border-bottom-left-radius:4px}
.bubble.out{background:linear-gradient(135deg,#7c6bff,#9480ff);color:#fff;border-bottom-right-radius:4px;box-shadow:0 4px 14px rgba(124,107,255,.28)}
.bt{display:flex;align-items:center;gap:3px;margin-top:5px;font-size:10.5px;justify-content:flex-end;opacity:.65}
.b-sender{font-size:11px;font-weight:700;color:var(--accent2);margin-bottom:3px}
.rb{background:rgba(0,0,0,.18);border-left:3px solid var(--accent2);border-radius:8px;padding:6px 10px;margin-bottom:6px;cursor:pointer;transition:background .15s}
.rb:hover{background:rgba(0,0,0,.3)}
.msg-highlight .bubble,.msg-highlight .img-bbl,.msg-highlight .file-bbl{animation:hlflash .4s ease 2;}
.rb-n{color:var(--accent2);font-weight:600;font-size:11px;margin-bottom:1px}
.rb-t{color:rgba(255,255,255,.6);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.img-bbl{border-radius:12px;overflow:hidden;cursor:pointer;max-width:260px;position:relative;background:var(--surface2)}
.img-bbl img{width:100%;max-height:220px;object-fit:cover;display:block;border-radius:12px}
.file-bbl{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:14px;border-bottom-left-radius:4px;background:var(--surface);border:1px solid var(--border);min-width:200px;max-width:280px;cursor:pointer;transition:.15s}
.file-bbl:hover{background:var(--surface2)}
.file-bbl.out{background:rgba(0,0,0,.2);border:1px solid rgba(255,255,255,.1);border-bottom-right-radius:4px;border-bottom-left-radius:14px}
.file-ico{width:38px;height:38px;border-radius:10px;background:rgba(124,107,255,.15);display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:18px}
.file-info{flex:1;min-width:0}
.file-name{font-weight:600;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.file-size{font-size:11px;opacity:.6;margin-top:1px}

/* typing */
.typing{display:none;align-items:center;gap:8px;padding:5px 18px 3px}
.typing.on{display:flex}
.typing-dots{display:flex;gap:3px;background:var(--surface);border:1px solid var(--border);padding:9px 13px;border-radius:16px;border-bottom-left-radius:4px}
.tdot{width:5px;height:5px;border-radius:50%;background:var(--text3);animation:tdot 1.3s ease infinite}
.tdot:nth-child(2){animation-delay:.2s}.tdot:nth-child(3){animation-delay:.4s}
@keyframes tdot{0%,60%,100%{transform:none}30%{transform:translateY(-5px)}}
@keyframes msgIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
.bubble,.img-bbl,.file-bbl{animation:msgIn .18s ease both}

/* input area */
.ia{padding:12px 18px;border-top:1px solid rgba(255,255,255,.04);background:rgba(7,8,14,.9);backdrop-filter:blur(24px);flex-shrink:0;position:relative;box-shadow:0 -1px 0 rgba(255,255,255,.03)}
.reply-bar{background:var(--surface);border-left:3px solid var(--accent);border-radius:8px;padding:7px 12px;margin-bottom:8px;display:none;align-items:center;gap:8px}
.reply-bar.on{display:flex}
.rb2-info{flex:1;min-width:0}
.rb2-who{font-size:11px;font-weight:700;color:var(--accent2);margin-bottom:1px}
.rb2-what{font-size:12px;color:var(--text2);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.rb2-close{background:none;border:none;color:var(--text3);cursor:pointer;font-size:20px;line-height:1;transition:.15s;padding:2px 4px}
.rb2-close:hover{color:var(--text)}
.file-prev-bar{display:none;background:var(--surface);border:1px solid var(--border2);border-radius:10px;padding:8px 12px;margin-bottom:8px;align-items:center;gap:10px}
.file-prev-bar.on{display:flex}
.fp-ico{font-size:22px;flex-shrink:0}
.fp-info{flex:1;min-width:0}
.fp-name{font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.fp-size{font-size:11px;color:var(--text3)}
.fp-close{background:none;border:none;color:var(--text3);cursor:pointer;font-size:18px;transition:.15s;padding:2px 4px}
.fp-close:hover{color:var(--red)}
.ir{display:flex;align-items:flex-end;gap:8px}
.att-btn{width:40px;height:40px;min-width:40px;border-radius:12px;border:1.5px solid var(--border2);background:var(--surface);color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.2s;flex-shrink:0;position:relative}
.att-btn:hover{border-color:var(--accent);color:var(--accent)}
.att-btn svg{width:17px;height:17px;stroke:currentColor;fill:none;stroke-width:2}
.att-btn input[type=file]{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%}
.input-box{flex:1;background:var(--surface);border:1.5px solid var(--border2);border-radius:16px;display:flex;align-items:flex-end;padding:0 10px;transition:.2s}
.input-box:focus-within{border-color:var(--accent);box-shadow:0 0 0 3px rgba(124,107,255,.1)}
.msg-ta{flex:1;background:none;border:none;outline:none;color:var(--text);font-family:'Manrope',sans-serif;font-size:14px;padding:12px 4px;resize:none;max-height:120px;line-height:1.4}
.msg-ta::placeholder{color:var(--text3)}
.emo-toggle{background:none;border:none;cursor:pointer;padding:6px 4px;font-size:18px;line-height:1;transition:transform .2s;color:var(--text2);flex-shrink:0}
.emo-toggle:hover{transform:scale(1.2)}
.send-btn{width:42px;height:42px;min-width:42px;border-radius:13px;border:none;background:linear-gradient(135deg,#7c6bff,#9480ff);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.2s;box-shadow:0 4px 14px rgba(124,107,255,.35);flex-shrink:0}
.send-btn:hover{transform:scale(1.06);box-shadow:0 6px 20px rgba(124,107,255,.5)}
.send-btn:active{transform:scale(.95)}
.send-btn svg{width:17px;height:17px;fill:white}
.emo-panel{position:absolute;bottom:68px;right:16px;background:var(--surface);border:1px solid var(--border2);border-radius:16px;padding:10px 8px 6px;display:none;z-index:450;box-shadow:0 20px 60px rgba(0,0,0,.6);width:338px}
.emo-panel.on{display:block}
.emo-cats{display:flex;gap:2px;margin-bottom:8px;border-bottom:1px solid var(--border);padding-bottom:8px;flex-wrap:wrap}
.emo-cat{background:none;border:none;cursor:pointer;padding:5px 8px;border-radius:8px;font-size:16px;transition:.12s;opacity:.55}
.emo-cat:hover,.emo-cat.on{opacity:1;background:var(--surface2)}
.emo-grid{display:grid;grid-template-columns:repeat(8,1fr);gap:1px;max-height:200px;overflow-y:auto}
.emo-btn{background:none;border:none;cursor:pointer;padding:6px;border-radius:8px;font-size:20px;line-height:1;transition:.1s;display:flex;align-items:center;justify-content:center}
.emo-btn:hover{background:var(--surface2);transform:scale(1.15)}

/* ── RIGHT PANEL ── */
/* ═══════════════ RIGHT PANEL PREMIUM ═══════════════ */
.rp{
  width:290px;min-width:290px;height:100vh;
  background:linear-gradient(175deg,#0a0c16 0%,#070810 40%,#06070e 100%);
  border-left:1px solid rgba(255,255,255,.045);
  display:none;flex-direction:column;
  overflow-y:auto;overflow-x:hidden;position:relative;
}
.rp::-webkit-scrollbar{width:0}
.rp.on{display:flex;animation:rpSlideIn .28s cubic-bezier(.25,.46,.45,.94) both}
@keyframes rpSlideIn{from{opacity:0;transform:translateX(18px)}to{opacity:1;transform:none}}

/* ── Hero background mesh ── */
.rp-hero-bg{
  position:absolute;top:0;left:0;right:0;height:260px;
  background:
    radial-gradient(ellipse 160% 80% at 50% -10%,rgba(124,107,255,.18) 0%,transparent 60%),
    radial-gradient(ellipse 60% 40% at 80% 30%,rgba(79,195,247,.08) 0%,transparent 50%),
    radial-gradient(ellipse 50% 30% at 20% 20%,rgba(166,149,255,.06) 0%,transparent 50%);
  pointer-events:none;z-index:0;
}
.rp-hero-bg::after{
  content:'';position:absolute;inset:0;
  background-image:linear-gradient(rgba(255,255,255,.018) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.018) 1px,transparent 1px);
  background-size:28px 28px;
  mask-image:linear-gradient(180deg,rgba(0,0,0,.5) 0%,transparent 100%);
}

/* ── Head ── */
.rp-head{
  padding:32px 18px 22px;
  text-align:center;flex-shrink:0;position:relative;z-index:1;
}
.rp-close-btn{
  position:absolute;top:14px;right:14px;
  width:28px;height:28px;border-radius:50%;
  background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);
  color:var(--text3);cursor:pointer;display:flex;align-items:center;justify-content:center;
  transition:.15s;font-size:14px;font-weight:300;line-height:1;
}
.rp-close-btn:hover{background:rgba(255,255,255,.1);color:var(--text);transform:rotate(90deg)}

/* ── Avatar with orbital glow ── */
.rp-ava-wrap{
  position:relative;width:96px;height:96px;margin:0 auto 16px;
  filter:drop-shadow(0 0 24px rgba(124,107,255,.35));
}
.rp-ava-orbit{
  position:absolute;inset:-6px;border-radius:50%;
  border:1.5px dashed rgba(124,107,255,.25);
  animation:rpOrbit 12s linear infinite;
}
.rp-ava-orbit::before{
  content:'';position:absolute;top:-3px;left:50%;
  width:6px;height:6px;border-radius:50%;
  background:var(--accent);transform:translateX(-50%);
  box-shadow:0 0 8px var(--accent),0 0 16px rgba(124,107,255,.5);
}
@keyframes rpOrbit{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
.rp-ava-glow{
  position:absolute;inset:-3px;border-radius:50%;
  background:conic-gradient(from 0deg,transparent 0%,rgba(124,107,255,.45) 30%,rgba(79,195,247,.35) 50%,transparent 70%);
  animation:rpGlowSpin 3s linear infinite;filter:blur(3px);
}
@keyframes rpGlowSpin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
.rp-ava{
  position:relative;z-index:1;
  width:96px;height:96px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-family:'Syne',sans-serif;font-size:32px;font-weight:700;
  overflow:hidden;
  box-shadow:0 0 0 2px rgba(255,255,255,.08),0 8px 32px rgba(0,0,0,.6);
}
.rp-ava img{width:100%;height:100%;object-fit:cover;border-radius:50%}

/* ── Status dot on avatar ── */
.rp-presence-wrap{
  position:absolute;bottom:2px;right:2px;z-index:2;
  width:18px;height:18px;border-radius:50%;
  background:var(--bg);display:flex;align-items:center;justify-content:center;
}
.rp-presence-dot{width:11px;height:11px;border-radius:50%;background:var(--s-offline)}
.rp-presence-dot.online{background:var(--s-online);box-shadow:0 0 6px var(--s-online)}
.rp-presence-dot.idle{background:var(--s-idle);box-shadow:0 0 6px var(--s-idle)}
.rp-presence-dot.dnd{background:var(--s-dnd);box-shadow:0 0 6px var(--s-dnd)}

/* ── Name & meta ── */
.rp-name{
  font-family:'Syne',sans-serif;font-size:18px;font-weight:800;letter-spacing:-.2px;
  margin-bottom:3px;
  display:flex;align-items:center;justify-content:center;gap:6px;flex-wrap:nowrap;
  color:#fff;
  text-shadow:0 2px 20px rgba(124,107,255,.3);
}
.rp-tag{font-size:12px;color:var(--text3);margin-bottom:8px;letter-spacing:.3px}
.rp-status{
  display:inline-flex;align-items:center;justify-content:center;gap:5px;
  background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.07);
  border-radius:20px;padding:4px 12px;
  font-size:11.5px;font-weight:600;color:var(--text2);
  margin:0 auto 4px;
}
.rp-blocked-badge{
  display:none;align-items:center;justify-content:center;gap:5px;
  background:linear-gradient(135deg,rgba(255,107,118,.15),rgba(255,107,118,.08));
  border:1px solid rgba(255,107,118,.35);
  border-radius:20px;padding:5px 14px;
  font-size:11px;font-weight:700;color:var(--red);
  margin:8px auto 0;width:fit-content;letter-spacing:.4px;
  box-shadow:0 2px 12px rgba(255,107,118,.15);
}
.rp-blocked-badge.on{display:flex}

/* ── Divider ── */
.rp-divider{
  height:1px;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.07) 30%,rgba(255,255,255,.07) 70%,transparent);
  margin:0;flex-shrink:0;
}

/* ── Action buttons ── */
.rp-acts{
  display:flex;gap:7px;padding:14px 14px;
  flex-shrink:0;position:relative;z-index:1;
}
.rp-act{
  flex:1;padding:12px 4px 10px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.07);
  background:rgba(255,255,255,.03);
  color:rgba(255,255,255,.5);
  font-size:10px;font-weight:700;
  cursor:pointer;
  display:flex;flex-direction:column;align-items:center;gap:5px;
  transition:all .2s cubic-bezier(.34,1.2,.64,1);
  font-family:'Manrope',sans-serif;letter-spacing:.5px;
  position:relative;overflow:hidden;
  backdrop-filter:blur(4px);
}
.rp-act-icon{
  width:34px;height:34px;border-radius:10px;
  background:rgba(255,255,255,.06);
  display:flex;align-items:center;justify-content:center;
  transition:.2s;
}
.rp-act svg{width:17px;height:17px;stroke:currentColor;fill:none;stroke-width:2;flex-shrink:0}
.rp-act:hover{
  border-color:rgba(124,107,255,.4);
  color:rgba(255,255,255,.9);
  transform:translateY(-3px) scale(1.03);
  box-shadow:0 8px 24px rgba(124,107,255,.2),0 2px 8px rgba(0,0,0,.3);
}
.rp-act:hover .rp-act-icon{
  background:rgba(124,107,255,.2);
  box-shadow:0 0 16px rgba(124,107,255,.3);
}
.rp-act:active{transform:translateY(-1px) scale(1)}
/* Mute active */
.rp-act.muted .rp-act-icon{background:rgba(255,107,118,.15)}
.rp-act.muted{color:var(--red);border-color:rgba(255,107,118,.25)}

/* ── Sections ── */
.rp-sec{
  padding:16px 16px 14px;
  flex-shrink:0;position:relative;z-index:1;
}
.rp-sec-title{
  font-size:9px;font-weight:800;
  color:rgba(255,255,255,.25);
  text-transform:uppercase;letter-spacing:1.6px;
  margin-bottom:10px;
  display:flex;align-items:center;gap:8px;
}
.rp-sec-title::before{
  content:'';width:3px;height:3px;border-radius:50%;
  background:var(--accent);box-shadow:0 0 6px var(--accent);flex-shrink:0;
}
.rp-sec-title::after{
  content:'';flex:1;height:1px;
  background:linear-gradient(90deg,rgba(124,107,255,.15),transparent);
}

/* ── Info rows ── */
.rp-info-card{
  background:rgba(255,255,255,.025);
  border:1px solid rgba(255,255,255,.06);
  border-radius:14px;
  overflow:hidden;
}
.rp-row{
  display:flex;align-items:center;gap:12px;
  padding:10px 14px;font-size:12.5px;color:var(--text2);
  transition:.15s;cursor:default;position:relative;
}
.rp-row + .rp-row::before{
  content:'';position:absolute;top:0;left:14px;right:14px;
  height:1px;background:rgba(255,255,255,.05);
}
.rp-row-icon{
  width:30px;height:30px;border-radius:9px;
  background:rgba(255,255,255,.05);
  display:flex;align-items:center;justify-content:center;flex-shrink:0;
}
.rp-row-icon svg{width:14px;height:14px;stroke:var(--text3);fill:none;stroke-width:2}
.rp-row svg{width:15px;height:15px;stroke:currentColor;fill:none;stroke-width:2;flex-shrink:0;opacity:.5}
.rp-row-text{display:flex;flex-direction:column;gap:1px;min-width:0}
.rp-row-label{font-size:9.5px;color:var(--text3);font-weight:700;text-transform:uppercase;letter-spacing:.8px}
.rp-row-val{font-size:12.5px;color:var(--text2);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

/* ── Actions section ── */
.rp-action-list{display:flex;flex-direction:column;gap:4px}
.rp-action-btn{
  display:flex;align-items:center;gap:12px;
  padding:11px 14px;border-radius:12px;
  border:1px solid transparent;
  background:rgba(255,255,255,.025);
  color:var(--text2);font-size:13px;font-weight:600;
  cursor:pointer;transition:.15s;font-family:'Manrope',sans-serif;
  width:100%;text-align:left;
}
.rp-action-btn:hover{background:rgba(255,255,255,.05);border-color:rgba(255,255,255,.08);color:var(--text)}
.rp-action-btn.danger{color:var(--red)}
.rp-action-btn.danger:hover{background:rgba(255,107,118,.08);border-color:rgba(255,107,118,.15)}
.rp-action-btn svg{width:16px;height:16px;stroke:currentColor;fill:none;stroke-width:2;flex-shrink:0;opacity:.8}
.rp-action-btn .rp-action-ico{
  width:32px;height:32px;border-radius:9px;
  display:flex;align-items:center;justify-content:center;flex-shrink:0;
  transition:.15s;
}
.rp-action-btn:hover .rp-action-ico{transform:scale(1.1)}
.rp-action-btn.danger .rp-action-ico{background:rgba(255,107,118,.1)}
.rp-action-btn.safe .rp-action-ico{background:rgba(255,255,255,.05)}

/* ── Media grid ── */
.media-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:3px;border-radius:14px;overflow:hidden}
.media-thumb{aspect-ratio:1;background:var(--surface);overflow:hidden;position:relative;cursor:pointer}
.media-thumb img{width:100%;height:100%;object-fit:cover;transition:.25s}
.media-thumb:hover img{transform:scale(1.08)}
.media-thumb::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,transparent 60%,rgba(124,107,255,.2));
  opacity:0;transition:.2s;
}
.media-thumb:hover::after{opacity:1}
.rp-media-empty{
  display:flex;align-items:center;gap:10px;
  padding:14px;
  background:rgba(255,255,255,.02);border:1px dashed rgba(255,255,255,.07);
  border-radius:12px;color:var(--text3);font-size:12px;
}

/* ── Block confirmation modal ── */
.block-modal{
  position:fixed;inset:0;z-index:8000;
  display:flex;align-items:center;justify-content:center;
  background:rgba(0,0,0,.75);backdrop-filter:blur(12px);
  opacity:0;pointer-events:none;transition:.25s;
}
.block-modal.on{opacity:1;pointer-events:all}
.block-modal-card{
  background:linear-gradient(160deg,rgba(18,21,36,.99),rgba(10,12,22,1));
  border:1px solid rgba(255,255,255,.1);
  border-radius:24px;padding:32px 28px 26px;
  width:330px;text-align:center;position:relative;
  box-shadow:0 50px 100px rgba(0,0,0,.85),0 0 0 1px rgba(255,107,118,.06),0 0 60px rgba(255,107,118,.04);
  animation:blockCardIn .3s cubic-bezier(.34,1.4,.64,1) both;
  overflow:hidden;
}
.block-modal-card::before{
  content:'';position:absolute;top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,rgba(255,107,118,.5),transparent);
}
@keyframes blockCardIn{from{transform:scale(.9) translateY(20px);opacity:0}to{transform:none;opacity:1}}
.block-modal-ico{
  width:64px;height:64px;border-radius:50%;
  background:radial-gradient(circle,rgba(255,107,118,.15),rgba(255,107,118,.05));
  border:1px solid rgba(255,107,118,.25);
  display:flex;align-items:center;justify-content:center;
  margin:0 auto 16px;font-size:28px;
  box-shadow:0 0 30px rgba(255,107,118,.15);
}
.block-modal-title{font-family:'Syne',sans-serif;font-size:19px;font-weight:800;margin-bottom:8px;color:#fff}
.block-modal-sub{font-size:13px;color:var(--text2);line-height:1.65;margin-bottom:26px}
.block-modal-btns{display:flex;gap:10px}
.block-modal-cancel{
  flex:1;padding:13px;border-radius:13px;
  border:1px solid rgba(255,255,255,.1);
  background:rgba(255,255,255,.04);color:var(--text2);
  font-size:13px;font-weight:700;cursor:pointer;transition:.15s;
  font-family:'Manrope',sans-serif;
}
.block-modal-cancel:hover{border-color:rgba(255,255,255,.2);color:var(--text)}
.block-modal-confirm{
  flex:1;padding:13px;border-radius:13px;border:none;
  background:linear-gradient(135deg,#d63031,#ff6b76);
  color:#fff;font-size:13px;font-weight:800;
  cursor:pointer;transition:.2s;
  font-family:'Syne',sans-serif;
  box-shadow:0 6px 20px rgba(255,107,118,.4);
}
.block-modal-confirm:hover{transform:translateY(-2px);box-shadow:0 10px 28px rgba(255,107,118,.55)}

/* ── Blocked chat notice ── */
.blocked-notice{
  display:none;position:absolute;bottom:0;left:0;right:0;z-index:5;
  background:linear-gradient(180deg,transparent,rgba(7,9,18,.97) 25%);
  padding:28px 22px 18px;
  flex-direction:column;align-items:center;gap:8px;
}
.blocked-notice.on{display:flex}
.blocked-notice-ico{font-size:32px;filter:drop-shadow(0 4px 12px rgba(255,107,118,.4))}
.blocked-notice-title{font-size:14px;font-weight:800;font-family:'Syne',sans-serif;color:var(--text)}
.blocked-notice-sub{font-size:11.5px;color:var(--text3);text-align:center;line-height:1.55;max-width:240px}

.mtile{aspect-ratio:1;border-radius:6px;font-size:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:opacity .15s;background:var(--surface2);overflow:hidden}
.mtile:hover{opacity:.8}
.mtile img{width:100%;height:100%;object-fit:cover}

/* ── CALL MODAL ── */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);backdrop-filter:blur(10px);z-index:200;display:none;align-items:center;justify-content:center}
.overlay.on{display:flex}
.call-modal{background:linear-gradient(145deg,var(--surface),var(--bg2));border:1px solid var(--border2);border-radius:24px;padding:40px 36px;min-width:300px;text-align:center;position:relative;overflow:hidden;box-shadow:0 40px 100px rgba(0,0,0,.8)}
.call-ava{width:80px;height:80px;border-radius:50%;margin:0 auto 16px;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-size:30px;font-weight:700;overflow:hidden}
.call-ava img{width:100%;height:100%;object-fit:cover;border-radius:50%}
.call-name{font-family:'Syne',sans-serif;font-size:22px;font-weight:700;margin-bottom:6px}
.call-sub{font-size:13px;color:var(--text2);margin-bottom:8px}
.call-timer{font-family:'Syne',sans-serif;font-size:20px;color:var(--text2);margin-bottom:28px;display:none}
.call-btns{display:flex;gap:16px;justify-content:center;align-items:center}
.call-btn{width:56px;height:56px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.2s;flex-shrink:0}
.call-btn:hover{transform:scale(1.08)}
.call-btn svg{width:22px;height:22px;stroke:white;fill:none;stroke-width:2}
.call-btn.mute{background:var(--surface2)}
.call-btn.end{background:var(--red);width:64px;height:64px}
.call-btn.spk{background:var(--surface2)}
.call-btn.end svg{width:24px;height:24px}
.inc-call-modal{background:linear-gradient(145deg,var(--surface),var(--bg2));border:1px solid var(--border2);border-radius:24px;padding:36px;min-width:280px;text-align:center;box-shadow:0 40px 100px rgba(0,0,0,.8)}
.inc-btns{display:flex;gap:20px;justify-content:center;margin-top:20px}
.inc-btn{width:60px;height:60px;border-radius:50%;border:none;cursor:pointer;font-size:26px;display:flex;align-items:center;justify-content:center;transition:.2s}
.inc-btn:hover{transform:scale(1.1)}
.inc-btn.accept{background:var(--green)}
.inc-btn.decline{background:var(--red)}
.call-video-area{position:absolute;inset:0;background:#000;z-index:-1;border-radius:24px;overflow:hidden;display:none}
.call-video-area.on{display:block}
.call-video-area video{width:100%;height:100%;object-fit:cover}
.call-local-video{position:absolute;bottom:100px;right:16px;width:100px;height:140px;border-radius:12px;overflow:hidden;border:2px solid rgba(255,255,255,.2);background:#111;display:none}
.call-local-video.on{display:block}
.call-local-video video{width:100%;height:100%;object-fit:cover}
.rtc-status{position:absolute;top:16px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.5);color:#fff;font-size:11px;padding:4px 10px;border-radius:20px;display:none}
.rtc-status.on{display:block}

/* ── CONTEXT MENU ── */
.ctx{position:fixed;background:var(--surface);border:1px solid var(--border2);border-radius:12px;padding:5px;min-width:180px;z-index:500;display:none;box-shadow:0 20px 60px rgba(0,0,0,.6)}
.ctx.on{display:block;animation:fadeUp .15s ease both}
.ctx-item{display:flex;align-items:center;gap:9px;padding:8px 10px;border-radius:8px;cursor:pointer;font-size:13px;transition:.1s;color:var(--text2)}
.ctx-item:hover{background:var(--surface2);color:var(--text)}
.ctx-item.red{color:var(--red)}
.ctx-item svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2;flex-shrink:0}
.ctx-sep{height:1px;background:var(--border);margin:4px 0}

/* ── SEARCH ── */
.srch-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(8px);z-index:400;display:none;align-items:flex-start;justify-content:center;padding-top:80px}
.srch-overlay.on{display:flex}
.srch-modal{background:var(--surface);border:1px solid var(--border2);border-radius:18px;width:500px;max-width:95vw;overflow:hidden;box-shadow:0 40px 100px rgba(0,0,0,.7)}
.sm-top{display:flex;align-items:center;gap:10px;padding:14px 16px;border-bottom:1px solid var(--border)}
.sm-top svg{width:16px;height:16px;stroke:var(--text3);fill:none;stroke-width:2;flex-shrink:0}
.sm-top input{flex:1;background:none;border:none;outline:none;color:var(--text);font-family:'Manrope',sans-serif;font-size:14px}
.sm-results{max-height:400px;overflow-y:auto;padding:6px}
.sm-lbl{font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.8px;padding:8px 10px 4px}
.sm-item{display:flex;align-items:center;gap:11px;padding:9px 10px;border-radius:10px;cursor:pointer;transition:.12s}
.sm-item:hover{background:var(--surface2)}
.sm-item-name{font-weight:600;font-size:13px}
.sm-item-tag{font-size:11px;color:var(--text2);margin-top:1px}

/* ── PROFILE MODAL ── */
.pm-overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);backdrop-filter:blur(12px);z-index:400;display:none;align-items:center;justify-content:center}
.pm-overlay.on{display:flex}
.pm-modal{background:linear-gradient(145deg,rgba(16,19,34,.98) 0%,rgba(10,12,22,.99) 100%);border:1px solid rgba(255,255,255,.08);border-top:1px solid rgba(255,255,255,.14);border-radius:24px;width:500px;max-width:95vw;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 50px 120px rgba(0,0,0,.85),0 0 0 1px rgba(124,107,255,.1),0 0 80px rgba(124,107,255,.05),inset 0 1px 0 rgba(255,255,255,.06);position:relative}
.pm-modal::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(124,107,255,.5),rgba(79,195,247,.3),transparent);z-index:1}
.pm-head{display:flex;align-items:center;justify-content:space-between;padding:20px 24px;border-bottom:1px solid var(--border);flex-shrink:0}
.pm-head h2{font-family:'Syne',sans-serif;font-size:17px;font-weight:700}
.pm-body{padding:24px;overflow-y:auto;flex:1}
.pm-ava-row{display:flex;align-items:flex-start;gap:16px;margin-bottom:20px}
.pm-ava{width:80px;height:80px;min-width:80px;border-radius:50%;background:var(--surface2);display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-size:28px;font-weight:700;overflow:hidden;position:relative;cursor:pointer}
.pm-ava img{width:100%;height:100%;object-fit:cover;border-radius:50%}
.pm-ava-over{position:absolute;inset:0;background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;font-size:20px;opacity:0;transition:.15s;cursor:pointer}
.pm-ava:hover .pm-ava-over{opacity:1}
.pm-ava-over input{position:absolute;inset:0;opacity:0;cursor:pointer}
.pm-ava-ctrl{flex:1}
.pm-ava-ctrl-title{font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.6px;margin-bottom:8px}
.color-picks{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px}
.cp{width:20px;height:20px;border-radius:50%;cursor:pointer;transition:.15s;border:2px solid transparent}
.cp.on,.cp:hover{transform:scale(1.2);border-color:rgba(255,255,255,.5)}
.emo-grid-sm{display:flex;flex-wrap:wrap;gap:2px;max-height:80px;overflow-y:auto;margin-bottom:6px}
.eg-btn{background:none;border:none;cursor:pointer;font-size:18px;padding:3px 5px;border-radius:6px;transition:.12s}
.eg-btn:hover,.eg-btn.on{background:var(--surface2)}
.pm-clear-btn,.pm-upload-btn{background:var(--surface2);border:1px solid var(--border2);border-radius:8px;padding:5px 10px;font-size:11px;color:var(--text2);cursor:pointer;font-family:'Manrope',sans-serif;transition:.15s;position:relative;overflow:hidden}
.pm-clear-btn:hover,.pm-upload-btn:hover{color:var(--text);border-color:var(--border2)}
.pm-upload-btn input{position:absolute;inset:0;opacity:0;cursor:pointer}
.pm-foot{display:flex;gap:8px;padding:14px 20px;border-top:1px solid var(--border);flex-shrink:0}
.btn-ghost{flex:1;padding:10px;border-radius:10px;border:1px solid var(--border2);background:none;color:var(--text2);font-family:'Manrope',sans-serif;font-size:13px;font-weight:600;cursor:pointer;transition:.15s}
.btn-ghost:hover{background:var(--surface2);color:var(--text)}
.btn-save{flex:2;padding:10px;border-radius:10px;border:none;background:linear-gradient(135deg,#7c6bff,#9b8bff);color:#fff;font-family:'Syne',sans-serif;font-size:13px;font-weight:700;cursor:pointer;transition:.2s}
.btn-save:hover{transform:translateY(-1px);box-shadow:0 8px 24px rgba(124,107,255,.4)}

/* ── LIGHTBOX ── */
.lightbox{position:fixed;inset:0;background:rgba(0,0,0,.92);z-index:600;display:none;align-items:center;justify-content:center;cursor:zoom-out}
.lightbox.on{display:flex}
.lightbox img{max-width:90vw;max-height:90vh;border-radius:12px;box-shadow:0 20px 80px rgba(0,0,0,.8)}

/* ── NOTIFICATIONS ── */
.notif{position:fixed;top:18px;right:18px;background:var(--surface);border:1px solid var(--border2);border-radius:14px;padding:12px 14px;display:flex;gap:11px;align-items:center;min-width:240px;max-width:320px;z-index:999;box-shadow:0 16px 40px rgba(0,0,0,.5);animation:notifIn .3s cubic-bezier(.34,1.56,.64,1) both;cursor:pointer}
@keyframes notifIn{from{opacity:0;transform:translateX(20px) scale(.96)}to{opacity:1;transform:none}}
@keyframes notifOut{to{opacity:0;transform:translateX(20px) scale(.95)}}
.notif-ico{width:36px;height:36px;border-radius:10px;overflow:hidden;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:18px}
.notif-ico img{width:100%;height:100%;object-fit:cover}
.notif-title{font-weight:700;font-size:13px;margin-bottom:2px}
.notif-txt{font-size:12px;color:var(--text2)}

/* ── УЛУЧШЕНИЯ ИНТЕРФЕЙСА ── */
.ld-name { font-size: 30px !important; }
.brand-name { font-size: 22px !important; }
.sb-brand { font-size: 16px !important; }

/* Glassmorphism header */
.chat-hdr {
  background: rgba(12,14,24,0.92) !important;
  box-shadow: 0 1px 0 rgba(255,255,255,0.06);
}

/* Better sidebar */
.sidebar { background: linear-gradient(180deg, #0c0e18, #080a12) !important; }

/* Improved chat item hover */
.ci { border-radius: 10px; margin: 1px 6px; padding: 9px 10px !important; border-left: none !important; transition: all .18s !important; }
.ci:hover { background: rgba(124,107,255,0.08) !important; transform: translateX(2px); }
.ci.on { background: linear-gradient(90deg, rgba(124,107,255,0.15), rgba(124,107,255,0.05)) !important; border-left: none !important; box-shadow: inset 3px 0 0 var(--accent); }

/* Better input area */
.input-box { border-radius: 20px !important; }
.msg-ta { padding: 13px 6px !important; }

/* Better send button */
.send-btn { border-radius: 50% !important; width: 46px !important; height: 46px !important; }

/* Better badges */
.badge { background: linear-gradient(135deg, var(--accent), #4fc3f7) !important; font-size: 9px !important; padding: 2px 5px !important; box-shadow: 0 2px 8px rgba(124,107,255,.4); }

/* Typing indicator */
.typing-dots { border-radius: 20px !important; }

/* Better message bubbles */
/* bubble styles consolidated below */

/* Smooth scrollbar */
.msgs::-webkit-scrollbar { width: 3px; }
.msgs::-webkit-scrollbar-thumb { background: rgba(124,107,255,.3); border-radius: 3px; }

/* Profile modal improvements */
.pm-modal { border-radius: 24px !important; }

/* ═══ PROFILE MODAL TABS ═══ */
.pm-tabs{display:flex;gap:2px;background:rgba(0,0,0,.25);border-radius:12px;padding:3px;margin-bottom:20px;border:1px solid rgba(255,255,255,.05)}
.pm-tab{flex:1;padding:8px 4px;border-radius:9px;border:none;background:none;color:var(--text3);font-family:'Manrope',sans-serif;font-size:11px;font-weight:700;cursor:pointer;transition:.2s;letter-spacing:.2px;display:flex;flex-direction:column;align-items:center;gap:2px}
.pm-tab .pm-tab-ico{font-size:14px;transition:.2s}
.pm-tab.on{background:linear-gradient(135deg,rgba(124,107,255,.2),rgba(79,195,247,.08));color:var(--text);border:1px solid rgba(124,107,255,.2);box-shadow:0 2px 8px rgba(0,0,0,.25)}
.pm-tab:hover:not(.on){color:var(--text2)}
.pm-pane{display:none}.pm-pane.on{display:block}

/* ═══ SECTION HEADERS ═══ */
.pm-sec-hdr{font-size:10px;font-weight:800;color:rgba(255,255,255,.25);text-transform:uppercase;letter-spacing:1.4px;margin:0 0 10px;display:flex;align-items:center;gap:7px}
.pm-sec-hdr::after{content:'';flex:1;height:1px;background:linear-gradient(90deg,rgba(124,107,255,.15),transparent)}

/* ═══ AVATAR RING PRESETS ═══ */
.ava-ring-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:16px}
.ava-ring-opt{display:flex;flex-direction:column;align-items:center;gap:6px;cursor:pointer;padding:10px 6px;border-radius:12px;border:1.5px solid rgba(255,255,255,.07);background:rgba(255,255,255,.02);transition:.18s}
.ava-ring-opt:hover{background:rgba(124,107,255,.08);border-color:rgba(124,107,255,.25)}
.ava-ring-opt.on{border-color:var(--accent);background:rgba(124,107,255,.12);box-shadow:0 2px 12px rgba(124,107,255,.2)}
.ava-ring-preview{width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,#7c6bff,#a695ff);position:relative;flex-shrink:0}
.ava-ring-preview::before{content:'';position:absolute;inset:-3px;border-radius:50%}
.ava-ring-preview .arp-inner{width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,#7c6bff,#a695ff)}
.ava-ring-opt span{font-size:9.5px;font-weight:700;color:var(--text3);text-align:center;letter-spacing:.3px;text-transform:uppercase}
.ava-ring-opt.on span{color:var(--accent2)}

/* Ring styles on actual avatar */
.rp-ava-wrap.ring-orbit .rp-ava-orbit{animation:rpOrbit 12s linear infinite;border-style:dashed}
.rp-ava-wrap.ring-orbit .rp-ava-glow{animation-duration:3s}
.rp-ava-wrap.ring-none .rp-ava-glow,.rp-ava-wrap.ring-none .rp-ava-orbit{display:none!important}
.rp-ava-wrap.ring-solid .rp-ava-glow{display:none!important}
.rp-ava-wrap.ring-solid .rp-ava-orbit{border-style:solid;border-color:var(--accent);opacity:1;animation:none}
.rp-ava-wrap.ring-pulse .rp-ava-glow{display:none!important}
.rp-ava-wrap.ring-pulse .rp-ava-orbit{border-style:solid;border-color:var(--accent);animation:rpOrbitPulse 2s ease-in-out infinite}
@keyframes rpOrbitPulse{0%,100%{opacity:.4;transform:scale(1)}50%{opacity:1;transform:scale(1.04)}}
.rp-ava-wrap.ring-gradient .rp-ava-orbit{border-style:none;animation:none}
.rp-ava-wrap.ring-gradient .rp-ava-glow{animation-duration:2s}
.rp-ava-wrap.ring-neon .rp-ava-orbit{border-style:solid;border-color:var(--accent);opacity:1;animation:none}
.rp-ava-wrap.ring-neon::after{content:'';position:absolute;inset:-8px;border-radius:50%;background:radial-gradient(circle,rgba(124,107,255,.25) 0%,transparent 70%);animation:neonPulse 2s ease-in-out infinite;pointer-events:none}
@keyframes neonPulse{0%,100%{opacity:.5;transform:scale(1)}50%{opacity:1;transform:scale(1.05)}}
.rp-ava-wrap.ring-double .rp-ava-orbit{border-style:solid;border-color:var(--accent);opacity:.9;animation:rpOrbit 8s linear infinite}
.rp-ava-wrap.ring-double .rp-ava-glow{display:none!important}
.rp-ava-wrap.ring-double::before{content:'';position:absolute;inset:-10px;border-radius:50%;border:1px solid rgba(124,107,255,.25);animation:rpOrbit 14s linear infinite reverse}

/* ═══ NAME STYLE OPTIONS ═══ */
.name-style-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:16px}
.name-style-opt{padding:10px 8px;border-radius:11px;border:1.5px solid rgba(255,255,255,.07);background:rgba(255,255,255,.02);cursor:pointer;text-align:center;transition:.18s;font-family:'Syne',sans-serif;font-size:14px;font-weight:800}
.name-style-opt:hover{border-color:rgba(124,107,255,.25);background:rgba(124,107,255,.06)}
.name-style-opt.on{border-color:var(--accent);background:rgba(124,107,255,.1)}
.name-style-opt.ns-white{color:#fff}
.name-style-opt.ns-accent{background:linear-gradient(135deg,var(--accent),#4fc3f7);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.name-style-opt.ns-gold{background:linear-gradient(135deg,#f59e0b,#fbbf24,#fcd34d);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.name-style-opt.ns-fire{background:linear-gradient(135deg,#ff6b35,#f7931e,#ffcc02);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.name-style-opt.ns-ice{background:linear-gradient(135deg,#74b9ff,#a29bfe,#fd79a8);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.name-style-opt.ns-neon{background:linear-gradient(135deg,#00f5ff,#39ff14);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

/* ═══ BUBBLE THEME ═══ */
.bubble-theme-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:16px}
.bubble-theme-opt{padding:8px 6px;border-radius:11px;border:1.5px solid rgba(255,255,255,.07);background:rgba(255,255,255,.02);cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:6px;transition:.18s}
.bubble-theme-opt:hover{border-color:rgba(124,107,255,.25)}
.bubble-theme-opt.on{border-color:var(--accent);background:rgba(124,107,255,.1)}
.bubble-theme-opt .bt-preview{width:36px;height:20px;border-radius:8px 8px 2px 8px}
.bubble-theme-opt span{font-size:9px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.3px}
.bubble-theme-opt.on span{color:var(--accent2)}

/* ═══ CHAT BG ═══ */
.chat-bg-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:16px}
.chat-bg-opt{aspect-ratio:1.4;border-radius:11px;border:1.5px solid rgba(255,255,255,.07);cursor:pointer;overflow:hidden;position:relative;transition:.18s}
.chat-bg-opt:hover{border-color:rgba(124,107,255,.3);transform:scale(1.03)}
.chat-bg-opt.on{border-color:var(--accent);box-shadow:0 0 0 2px rgba(124,107,255,.3)}
.chat-bg-opt::after{content:'✓';position:absolute;top:4px;right:4px;width:16px;height:16px;border-radius:50%;background:var(--accent);color:#fff;font-size:9px;font-weight:900;display:flex;align-items:center;justify-content:center;opacity:0;transition:.15s;line-height:16px;text-align:center}
.chat-bg-opt.on::after{opacity:1}

/* ═══ STATUS BADGE ═══ */
.status-badge-inp{width:100%;background:rgba(255,255,255,.04);border:1.5px solid rgba(255,255,255,.08);border-radius:12px;padding:11px 14px;color:var(--text);font-family:'Manrope',sans-serif;font-size:13px;outline:none;transition:.2s}
.status-badge-inp:focus{border-color:rgba(124,107,255,.5);background:rgba(124,107,255,.05);box-shadow:0 0 0 3px rgba(124,107,255,.1)}
.status-badge-inp::placeholder{color:rgba(255,255,255,.2)}

/* ═══ TOGGLE SWITCH ═══ */
.pm-toggle{position:relative;width:42px;height:23px;flex-shrink:0}
.pm-toggle input{opacity:0;width:0;height:0;position:absolute}
.pm-toggle-track{position:absolute;inset:0;border-radius:12px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.1);transition:.25s;cursor:pointer}
.pm-toggle input:checked + .pm-toggle-track{background:linear-gradient(135deg,var(--accent),#4fc3f7);border-color:var(--accent)}
.pm-toggle-track::after{content:'';position:absolute;top:2px;left:2px;width:17px;height:17px;border-radius:50%;background:#fff;box-shadow:0 2px 4px rgba(0,0,0,.3);transition:.25s}
.pm-toggle input:checked + .pm-toggle-track::after{left:21px}

/* ═══ SETTING ROW ═══ */
.pm-setting-row{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-radius:12px;background:rgba(255,255,255,.025);border:1px solid rgba(255,255,255,.05);margin-bottom:7px;transition:.15s}
.pm-setting-row:hover{background:rgba(255,255,255,.04)}
.pm-setting-left{display:flex;align-items:center;gap:11px}
.pm-setting-ico{width:32px;height:32px;border-radius:9px;background:rgba(124,107,255,.12);display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0}
.pm-setting-info{}
.pm-setting-name{font-size:13px;font-weight:600;color:var(--text)}
.pm-setting-desc{font-size:11px;color:var(--text3);margin-top:1px}

/* ═══ PROFILE PREVIEW CARD ═══ */
.pm-preview{background:linear-gradient(145deg,rgba(22,25,40,.8),rgba(14,17,30,.9));border:1px solid rgba(255,255,255,.07);border-radius:16px;padding:16px;margin-bottom:16px;display:flex;align-items:center;gap:14px}
.pm-preview-ava{width:52px;height:52px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-size:20px;font-weight:700;overflow:hidden;position:relative}
.pm-preview-ava img{width:100%;height:100%;object-fit:cover;border-radius:50%}
.pm-preview-name{font-family:'Syne',sans-serif;font-size:15px;font-weight:800;margin-bottom:2px}
.pm-preview-tag{font-size:11px;color:var(--text3)}
.pm-preview-badge{font-size:11px;margin-top:3px;color:var(--text2)}

/* Compact mode */
body.compact .bubble{padding:7px 11px;font-size:13px}
body.compact .msgs{gap:0;padding:10px 16px}
body.compact .ci{padding:7px 14px}
body.compact .ava{width:38px;height:38px;min-width:38px;font-size:14px}

/* ── GLOBAL FLOATING TOOLTIP ── */
#g-tooltip{
  position:fixed;
  z-index:99999;
  pointer-events:none;
  opacity:0;
  transition:opacity .15s;
  font-family:'Manrope',sans-serif;
  font-size:11px;
  font-weight:700;
  letter-spacing:.3px;
  white-space:nowrap;
  border-radius:10px;
  padding:5px 12px;
}
#g-tooltip.show{opacity:1}
#g-tooltip.type-verified{
  background:linear-gradient(145deg,rgba(16,19,34,.97),rgba(10,12,22,.99));
  border:1px solid rgba(124,107,255,.35);
  color:var(--text);
  box-shadow:0 8px 24px rgba(0,0,0,.6),0 0 0 1px rgba(124,107,255,.12);
}
#g-tooltip.type-dev{
  background:linear-gradient(160deg,rgba(18,10,10,.98),rgba(10,5,5,1));
  border:1px solid rgba(255,80,50,.25);
  color:#ff8a70;
  text-shadow:0 0 8px rgba(255,80,40,.4);
  box-shadow:0 8px 24px rgba(0,0,0,.7),0 0 16px rgba(255,50,20,.07);
}
/* Scrollbar refinements */
.pm-body::-webkit-scrollbar{width:4px}
.pm-body::-webkit-scrollbar-track{background:transparent}
.pm-body::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);border-radius:4px}

/* Auth card glow */
.auth-card { box-shadow: 0 40px 100px rgba(0,0,0,.8), 0 0 0 1px rgba(124,107,255,.15), 0 0 60px rgba(124,107,255,.06), inset 0 1px 0 rgba(255,255,255,.05) !important; }





/* ── ПОЛНЫЙ РЕДИЗАЙН В СТИЛЕ РЕГИСТРАЦИИ ── */

/* Sidebar — как auth card */
.sidebar {
  background: linear-gradient(180deg, rgba(12,14,24,.99) 0%, rgba(8,10,18,1) 100%) !important;
  border-right: 1px solid rgba(255,255,255,.06) !important;
  position: relative;
}
.sidebar::after {
  content: '';
  position: absolute;
  top: 0; right: 0; bottom: 0;
  width: 1px;
  background: linear-gradient(180deg, rgba(124,107,255,.3) 0%, rgba(79,195,247,.15) 50%, transparent 100%);
  pointer-events: none;
}

/* Sidebar header */
.sb-head {
  background: linear-gradient(135deg, rgba(124,107,255,.08), rgba(79,195,247,.04)) !important;
  border-bottom: 1px solid rgba(255,255,255,.06) !important;
  padding: 14px 16px !important;
  position: relative;
}
.sb-head::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(124,107,255,.4), transparent);
}

/* Chat list items */
.ci {
  border-radius: 12px !important;
  margin: 2px 8px !important;
  padding: 9px 10px !important;
  border-left: none !important;
  transition: all .18s cubic-bezier(.4,0,.2,1) !important;
  position: relative;
}
.ci:hover {
  background: rgba(124,107,255,.09) !important;
  transform: translateX(2px) !important;
  box-shadow: inset 3px 0 0 rgba(124,107,255,.4) !important;
}
.ci.on {
  background: linear-gradient(90deg, rgba(124,107,255,.18), rgba(124,107,255,.06)) !important;
  box-shadow: inset 3px 0 0 var(--accent), 0 2px 12px rgba(124,107,255,.1) !important;
}

/* Chat header */
.chat-hdr {
  background: linear-gradient(180deg, rgba(10,12,22,.96) 0%, rgba(7,8,14,.93) 100%) !important;
  border-bottom: 1px solid rgba(255,255,255,.05) !important;
  backdrop-filter: blur(24px) !important;
  position: relative !important;
  box-shadow: 0 1px 0 rgba(124,107,255,.1) !important;
}
.chat-hdr::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(124,107,255,.35), rgba(79,195,247,.2), transparent);
}

/* Message bubbles */
.bubble.out {
  background: linear-gradient(135deg, #6c5ce7, #7c6bff, #9b8bff) !important;
  box-shadow: 0 4px 18px rgba(124,107,255,.38), inset 0 1px 0 rgba(255,255,255,.15) !important;
  border-bottom-right-radius: 5px !important;
  border-radius: 18px 18px 5px 18px !important;
}
.bubble.in {
  background: linear-gradient(145deg, rgba(22,25,40,.9), rgba(18,21,35,.95)) !important;
  border: 1px solid rgba(255,255,255,.07) !important;
  border-top: 1px solid rgba(255,255,255,.1) !important;
  border-bottom-left-radius: 5px !important;
  border-radius: 18px 18px 18px 5px !important;
}

/* Input area */
.ia {
  background: linear-gradient(180deg, rgba(7,8,14,.92), rgba(8,10,18,.95)) !important;
  border-top: 1px solid rgba(255,255,255,.04) !important;
  backdrop-filter: blur(24px) !important;
  position: relative !important;
}
.ia::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(124,107,255,.2), transparent);
}
.input-box {
  border-radius: 18px !important;
  background: rgba(255,255,255,.04) !important;
  border: 1.5px solid rgba(255,255,255,.08) !important;
  transition: border-color .2s, box-shadow .2s !important;
}
.input-box:focus-within {
  border-color: rgba(124,107,255,.5) !important;
  background: rgba(124,107,255,.04) !important;
  box-shadow: 0 0 0 3px rgba(124,107,255,.1) !important;
}
.send-btn {
  border-radius: 50% !important;
  width: 44px !important; height: 44px !important;
  background: linear-gradient(135deg, #6c5ce7, #7c6bff, #9b8bff) !important;
  box-shadow: 0 4px 16px rgba(124,107,255,.4) !important;
}
.send-btn:hover {
  transform: scale(1.08) !important;
  box-shadow: 0 6px 22px rgba(124,107,255,.55) !important;
}

/* Right panel overrides */

/* Badges */
.badge {
  background: linear-gradient(135deg, var(--accent), #4fc3f7) !important;
  box-shadow: 0 2px 10px rgba(124,107,255,.45) !important;
  font-size: 9px !important;
}

/* Context menu */
.ctx {
  background: linear-gradient(145deg, rgba(16,19,34,.98), rgba(10,12,22,.99)) !important;
  border: 1px solid rgba(255,255,255,.08) !important;
  border-top: 1px solid rgba(255,255,255,.13) !important;
  border-radius: 14px !important;
  box-shadow: 0 20px 60px rgba(0,0,0,.7), 0 0 0 1px rgba(124,107,255,.08) !important;
  position: relative;
  overflow: hidden;
}
.ctx::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(124,107,255,.5), rgba(79,195,247,.3), transparent);
}

/* Search modal */
.srch-modal {
  background: linear-gradient(145deg, rgba(16,19,34,.98), rgba(10,12,22,.99)) !important;
  border: 1px solid rgba(255,255,255,.08) !important;
  border-top: 1px solid rgba(255,255,255,.13) !important;
  box-shadow: 0 40px 100px rgba(0,0,0,.8), 0 0 0 1px rgba(124,107,255,.1) !important;
  position: relative;
  overflow: hidden;
}
.srch-modal::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(124,107,255,.5), rgba(79,195,247,.3), transparent);
  z-index: 1;
}

/* Status menu */
.status-menu {
  background: linear-gradient(145deg, rgba(16,19,34,.98), rgba(10,12,22,.99)) !important;
  border: 1px solid rgba(255,255,255,.08) !important;
  border-top: 1px solid rgba(255,255,255,.14) !important;
  box-shadow: 0 20px 60px rgba(0,0,0,.7), 0 0 0 1px rgba(124,107,255,.08) !important;
  position: relative;
  overflow: hidden;
}
.status-menu::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(124,107,255,.5), rgba(79,195,247,.3), transparent);
}

/* Notifications */
.notif {
  background: linear-gradient(145deg, rgba(16,19,34,.98), rgba(10,12,22,.99)) !important;
  border: 1px solid rgba(255,255,255,.08) !important;
  border-top: 1px solid rgba(124,107,255,.25) !important;
  box-shadow: 0 20px 60px rgba(0,0,0,.7), 0 0 0 1px rgba(124,107,255,.1) !important;
  position: relative;
  overflow: hidden;
}
.notif::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(124,107,255,.5), rgba(79,195,247,.3), transparent);
}

/* Incoming call modal */
.inc-call-modal {
  background: linear-gradient(145deg, rgba(13,15,30,.98), rgba(8,10,22,.99)) !important;
  border: 1px solid rgba(255,255,255,.08) !important;
  border-top: 1px solid rgba(255,255,255,.14) !important;
  box-shadow: 0 50px 120px rgba(0,0,0,.85), 0 0 0 1px rgba(124,107,255,.12), 0 0 80px rgba(124,107,255,.06) !important;
  position: relative;
  overflow: hidden;
}
.inc-call-modal::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(124,107,255,.6), rgba(79,195,247,.4), transparent);
}

/* Incoming call accept button pulse */
.inc-btn.accept {
  background: linear-gradient(135deg, #2ecc71, #3ecf8e) !important;
  box-shadow: 0 0 0 0 rgba(62,207,142,.5);
  animation: acceptPulse 1.8s ease infinite;
}
@keyframes acceptPulse {
  0% { box-shadow: 0 0 0 0 rgba(62,207,142,.5); }
  60% { box-shadow: 0 0 0 10px rgba(62,207,142,0); }
  100% { box-shadow: 0 0 0 0 rgba(62,207,142,0); }
}
.inc-btn.decline {
  background: linear-gradient(135deg, #e74c3c, #ff6b76) !important;
  box-shadow: 0 4px 18px rgba(255,107,118,.35) !important;
}

/* Empty state */
.empty::before {
  background: radial-gradient(ellipse 60% 50% at 50% 40%, rgba(124,107,255,.08) 0%, transparent 70%),
    linear-gradient(rgba(255,255,255,.015) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,.015) 1px, transparent 1px) !important;
  background-size: auto, 40px 40px, 40px 40px !important;
}

/* Profile modal inner sections */
.pm-body .fld label {
  text-transform: uppercase;
  letter-spacing: .8px;
  font-size: 10.5px;
  color: rgba(255,255,255,.3);
  font-weight: 800;
}
.pm-body .inp {
  background: rgba(255,255,255,.03) !important;
  border: 1.5px solid rgba(255,255,255,.07) !important;
}
.pm-body .inp:focus {
  border-color: rgba(124,107,255,.5) !important;
  background: rgba(124,107,255,.05) !important;
}

/* Filter tabs */
.ftab.on {
  background: linear-gradient(135deg, rgba(124,107,255,.18), rgba(79,195,247,.06)) !important;
  color: var(--accent2) !important;
}

/* RTC status pill */
.rtc-status {
  background: rgba(0,0,0,.55) !important;
  backdrop-filter: blur(8px) !important;
  border: 1px solid rgba(255,255,255,.1) !important;
}

/* Scrollbar in messages */
.msgs::-webkit-scrollbar { width: 3px; }
.msgs::-webkit-scrollbar-thumb { background: rgba(124,107,255,.3); border-radius: 3px; }

/* Typing indicator */
.typing-dots {
  background: linear-gradient(145deg, rgba(22,25,40,.9), rgba(18,21,35,.95)) !important;
  border: 1px solid rgba(255,255,255,.07) !important;
}

/* Reply bar */
.reply-bar {
  background: linear-gradient(145deg, rgba(22,25,40,.9), rgba(18,21,35,.95)) !important;
  border-left-color: var(--accent) !important;
}

/* New chat row */
.new-chat-row {
  background: linear-gradient(90deg, rgba(124,107,255,.05), transparent) !important;
}
.new-chat-row:hover {
  background: linear-gradient(90deg, rgba(124,107,255,.12), rgba(124,107,255,.04)) !important;
}

/* Search in sidebar */
.srch-inp {
  background: rgba(255,255,255,.04) !important;
  border: 1.5px solid rgba(255,255,255,.06) !important;
  border-radius: 12px !important;
}
.srch-inp:focus {
  border-color: rgba(124,107,255,.4) !important;
  background: rgba(124,107,255,.04) !important;
  box-shadow: 0 0 0 3px rgba(124,107,255,.08) !important;
}

/* RPA act overrides */

/* Ico btn */
.ico-btn:hover {
  background: rgba(124,107,255,.12) !important;
  color: var(--accent2) !important;
}

/* Date separators */
.date-sep span {
  background: var(--bg) !important;
  padding: 2px 14px !important;
  border-radius: 20px !important;
  border: 1px solid rgba(255,255,255,.05) !important;
}

.call-modal {
  background: linear-gradient(145deg, #0d0f1e, #080a16) !important;
  border: 1px solid rgba(124,107,255,.2) !important;
  border-radius: 20px !important;
  min-width: 340px !important;
  transition: all .35s cubic-bezier(.4,0,.2,1) !important;
  position: relative !important;
  overflow: hidden !important;
}
.call-modal.expanded {
  min-width: min(96vw, 900px) !important;
  min-height: min(90vh, 600px) !important;
  border-radius: 16px !important;
}
.call-modal.expanded .call-ava,
.call-modal.expanded .call-name,
.call-modal.expanded .call-sub { opacity: 0; pointer-events: none; height: 0; margin: 0; overflow: hidden; }
.call-modal.expanded .call-timer { position: absolute; top: 16px; left: 50%; transform: translateX(-50%); font-size: 15px; z-index: 5; background: rgba(0,0,0,.45); padding: 4px 14px; border-radius: 20px; }

/* Toolbar внутри звонка */
.call-toolbar {
  position: absolute;
  top: 12px;
  right: 12px;
  display: flex;
  gap: 6px;
  z-index: 10;
}
.ct-btn {
  width: 34px;
  height: 34px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.45);
  backdrop-filter: blur(8px);
  color: white;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: .15s;
  flex-shrink: 0;
}
.ct-btn:hover { background: rgba(255,255,255,.15); }
.ct-btn.active { background: rgba(124,107,255,.5); border-color: var(--accent); }
.ct-btn svg { width: 16px; height: 16px; stroke: white; fill: none; stroke-width: 2; }

/* Screen share area */
.screen-share-area {
  position: absolute;
  inset: 0;
  background: #000;
  z-index: 1;
  border-radius: 16px;
  overflow: hidden;
  display: none;
  align-items: center;
  justify-content: center;
}
.screen-share-area.on { display: flex; }
.screen-share-area video { width: 100%; height: 100%; object-fit: contain; }
.screen-share-label {
  position: absolute;
  top: 12px;
  left: 12px;
  background: rgba(124,107,255,.7);
  color: white;
  font-size: 11px;
  font-weight: 700;
  padding: 4px 10px;
  border-radius: 20px;
  z-index: 5;
  display: flex;
  align-items: center;
  gap: 5px;
}
/* pip local video (в расширенном режиме) */
.call-local-video {
  border-radius: 14px !important;
  border: 2px solid rgba(255,255,255,.15) !important;
  z-index: 6 !important;
  cursor: move !important;
  transition: box-shadow .2s !important;
}
.call-local-video:hover { box-shadow: 0 4px 20px rgba(0,0,0,.5) !important; }

/* Кнопки звонка в расширенном режиме - снизу по центру */
.call-modal.expanded .call-btns {
  position: absolute;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
  gap: 12px;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(12px);
  padding: 12px 20px;
  border-radius: 50px;
  border: 1px solid rgba(255,255,255,.1);
}
.call-modal.expanded .call-video-area { border-radius: 0 0 16px 16px; }

/* Share screen button */
.call-btn.share { background: var(--surface2); }
.call-btn.share.active { background: rgba(79,195,247,.3); border: 1px solid var(--accent3); }

/* Online counter pill */
.online-count { padding: 4px 10px 8px; display: flex; align-items: center; justify-content: center; }
.online-pill {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: rgba(62,207,142,.07);
  border: 1px solid rgba(62,207,142,.18);
  border-radius: 20px;
  padding: 4px 12px 4px 10px;
  font-size: 11px;
  font-weight: 700;
  color: var(--s-online);
  letter-spacing: .2px;
}
.online-label { color: var(--text3); font-weight: 500; font-size: 10.5px; }
.online-pulse {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--s-online);
  flex-shrink: 0;
  box-shadow: 0 0 0 0 rgba(62,207,142,.5);
  animation: pulse-ring 2s ease infinite;
}
@keyframes pulse-ring {
  0% { box-shadow: 0 0 0 0 rgba(62,207,142,.5); }
  60% { box-shadow: 0 0 0 5px rgba(62,207,142,0); }
  100% { box-shadow: 0 0 0 0 rgba(62,207,142,0); }
}

/* ═══ SCROLL TO BOTTOM ═══ */
.scroll-btn {
  position: absolute !important;
  bottom: 84px !important;
  right: 18px !important;
  width: 40px !important; height: 40px !important;
  border-radius: 50% !important;
  border: 1px solid rgba(255,255,255,.1);
  background: linear-gradient(145deg, rgba(22,25,40,.97), rgba(14,17,30,.99));
  color: var(--text2);
  cursor: pointer;
  display: flex !important; align-items: center; justify-content: center;
  box-shadow: 0 8px 24px rgba(0,0,0,.5), 0 0 0 1px rgba(124,107,255,.15);
  transition: all .25s cubic-bezier(.34,1.4,.64,1);
  z-index: 20;
  opacity: 0; pointer-events: none; transform: translateY(12px) scale(.9);
  flex-shrink: 0; align-self: auto;
  min-width: 0 !important; min-height: 0 !important;
}
.scroll-btn.on { opacity: 1; pointer-events: auto; transform: translateY(0) scale(1); }
.scroll-btn:hover { background: linear-gradient(145deg, rgba(30,35,60,.97), rgba(20,24,45,.99)); color: var(--text); transform: translateY(-2px) scale(1.06); box-shadow: 0 12px 32px rgba(0,0,0,.6), 0 0 0 1px rgba(124,107,255,.3); }
.scroll-btn svg { width: 16px; height: 16px; stroke: currentColor; fill: none; stroke-width: 2; }
.scroll-btn .scroll-unread {
  position: absolute;
  top: -5px; right: -5px;
  min-width: 18px; height: 18px;
  border-radius: 9px;
  background: linear-gradient(135deg, var(--accent), #4fc3f7);
  color: #fff; font-size: 9px; font-weight: 800;
  display: flex; align-items: center; justify-content: center;
  padding: 0 4px;
  box-shadow: 0 2px 8px rgba(124,107,255,.5);
  animation: fadeUp .2s ease both;
}

/* ═══ MESSAGE HOVER ACTIONS ═══ */
.msg-row { position: relative; }
.bw { position: relative; }
.msg-actions {
  position: absolute;
  bottom: calc(100% + 4px);
  left: 0;
  display: flex; gap: 3px;
  padding: 4px;
  background: linear-gradient(145deg, rgba(16,19,34,.98), rgba(10,12,22,.99));
  border: 1px solid rgba(255,255,255,.1);
  border-radius: 12px;
  box-shadow: 0 8px 28px rgba(0,0,0,.6), 0 0 0 1px rgba(124,107,255,.1);
  opacity: 0; pointer-events: none;
  transform: translateY(4px) scale(.95);
  transition: all .18s cubic-bezier(.34,1.2,.64,1);
  z-index: 10;
  white-space: nowrap;
}
.msg-row.me .bw .msg-actions { left: auto; right: 0; }
.msg-row:hover .msg-actions { opacity: 1; pointer-events: auto; transform: translateY(0) scale(1); }
.ma-btn {
  width: 28px; height: 28px;
  border-radius: 8px;
  border: none;
  background: none;
  color: var(--text2);
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px;
  transition: .15s;
  flex-shrink: 0;
}
.ma-btn:hover { background: rgba(124,107,255,.15); color: var(--text); transform: scale(1.1); }
.ma-btn.danger:hover { background: rgba(255,107,118,.15); color: var(--red); }
.ma-btn svg { width: 13px; height: 13px; stroke: currentColor; fill: none; stroke-width: 2; }

/* ═══ SKELETON LOADING ═══ */
@keyframes shimmer {
  0% { background-position: -300px 0; }
  100% { background-position: 300px 0; }
}
.skeleton {
  background: linear-gradient(90deg, var(--surface) 25%, var(--surface2) 50%, var(--surface) 75%);
  background-size: 600px 100%;
  animation: shimmer 1.4s ease-in-out infinite;
  border-radius: 8px;
}
.sk-item {
  display: flex; align-items: center; gap: 11px;
  padding: 9px 10px;
  margin: 2px 8px;
  border-radius: 12px;
}
.sk-ava { width: 40px; height: 40px; border-radius: 50%; flex-shrink: 0; }
.sk-lines { flex: 1; display: flex; flex-direction: column; gap: 6px; }
.sk-name { height: 11px; width: 60%; border-radius: 6px; }
.sk-prev { height: 9px; width: 80%; border-radius: 6px; }

/* ═══ SEND BUTTON DISABLED STATE ═══ */
.send-btn {
  transition: opacity .2s, transform .2s, width .2s, min-width .2s, margin .2s, box-shadow .2s !important;
  overflow: hidden !important;
}
.send-btn:disabled, .send-btn.empty {
  opacity: 0 !important;
  transform: scale(0.5) !important;
  box-shadow: none !important;
  cursor: default !important;
  pointer-events: none !important;
  width: 0 !important;
  min-width: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* ═══ ENHANCED TYPING INDICATOR ═══ */
.typing-name {
  font-size: 11.5px;
  font-weight: 600;
  color: var(--text3);
  white-space: nowrap;
}
.typing-name span { color: var(--accent2); }

/* ═══ INPUT CHARACTER COUNTER ═══ */
.char-counter {
  font-size: 10px;
  color: var(--text3);
  padding: 0 4px;
  align-self: center;
  opacity: 0;
  transition: .2s;
  flex-shrink: 0;
}
.char-counter.on { opacity: 1; }
.char-counter.warn { color: var(--yellow); }
.char-counter.over { color: var(--red); }

/* ═══════════════ BAN SCREEN ═══════════════ */
#ban-screen {
  position: fixed; inset: 0; z-index: 99999;
  display: none; align-items: center; justify-content: center;
  background: radial-gradient(ellipse at center, #1a0000 0%, #090005 50%, #000 100%);
  overflow: hidden;
}
#ban-screen.on { display: flex; }
#ban-screen .bs-particles {
  position: absolute; inset: 0; overflow: hidden; pointer-events: none;
}
#ban-screen .bs-particle {
  position: absolute; width: 2px; height: 2px; border-radius: 50%;
  background: rgba(255,70,70,.6); animation: bsParticle linear infinite;
}
@keyframes bsParticle {
  0% { transform: translateY(110vh) scale(0); opacity: 0; }
  10% { opacity: 1; }
  90% { opacity: 1; }
  100% { transform: translateY(-10vh) scale(1); opacity: 0; }
}
#ban-screen .bs-grid {
  position: absolute; inset: 0;
  background-image:
    linear-gradient(rgba(255,50,50,.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,50,50,.04) 1px, transparent 1px);
  background-size: 48px 48px;
  mask-image: radial-gradient(ellipse 80% 80% at center, black 30%, transparent 80%);
}
#ban-screen .bs-glow {
  position: absolute; inset: -20%; border-radius: 50%;
  background: radial-gradient(ellipse at center, rgba(255,30,30,.15) 0%, transparent 65%);
  animation: bsGlowPulse 3s ease-in-out infinite;
}
@keyframes bsGlowPulse { 0%,100%{opacity:.6;transform:scale(1)} 50%{opacity:1;transform:scale(1.05)} }
#ban-screen .bs-card {
  position: relative; z-index: 1;
  background: linear-gradient(145deg, rgba(30,5,5,.95) 0%, rgba(15,0,0,.98) 100%);
  border: 1px solid rgba(255,50,50,.25);
  border-top: 1px solid rgba(255,80,80,.4);
  border-radius: 28px; padding: 52px 48px;
  max-width: 520px; width: 92vw; text-align: center;
  box-shadow:
    0 60px 120px rgba(0,0,0,.9),
    0 0 0 1px rgba(255,50,50,.08),
    0 0 80px rgba(255,20,20,.12),
    inset 0 1px 0 rgba(255,100,100,.1);
  animation: bsCardIn .6s cubic-bezier(.34,1.2,.64,1) both;
}
@keyframes bsCardIn { from{opacity:0;transform:scale(.85) translateY(30px)} to{opacity:1;transform:none} }
#ban-screen .bs-card::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(255,80,80,.6), rgba(255,120,60,.4), transparent);
}
#ban-screen .bs-shield {
  width: 80px; height: 80px; margin: 0 auto 24px;
  background: radial-gradient(circle at 40% 30%, rgba(255,200,200,.1), transparent 60%),
    linear-gradient(145deg, rgba(255,50,50,.2), rgba(200,0,0,.08));
  border: 1px solid rgba(255,70,70,.3);
  border-radius: 24px; display: flex; align-items: center; justify-content: center;
  box-shadow: 0 0 40px rgba(255,30,30,.2), inset 0 1px 0 rgba(255,120,120,.15);
  animation: bsShieldPulse 2s ease-in-out infinite;
  font-size: 36px;
}
@keyframes bsShieldPulse {
  0%,100%{box-shadow:0 0 40px rgba(255,30,30,.2),inset 0 1px 0 rgba(255,120,120,.15)}
  50%{box-shadow:0 0 60px rgba(255,30,30,.35),inset 0 1px 0 rgba(255,120,120,.2)}
}
#ban-screen .bs-title {
  font-family: 'Syne', sans-serif; font-size: 28px; font-weight: 800;
  color: #ff4444; margin-bottom: 8px; letter-spacing: -.3px;
  text-shadow: 0 0 30px rgba(255,50,50,.5);
}
#ban-screen .bs-subtitle {
  font-size: 13px; color: rgba(255,255,255,.35);
  margin-bottom: 28px; font-weight: 600; text-transform: uppercase; letter-spacing: 1.5px;
}
#ban-screen .bs-divider {
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(255,50,50,.25), transparent);
  margin: 0 0 24px;
}
#ban-screen .bs-reason-card {
  background: rgba(255,40,40,.06); border: 1px solid rgba(255,50,50,.15);
  border-radius: 16px; padding: 18px 20px; margin-bottom: 20px; text-align: left;
}
#ban-screen .bs-reason-label {
  font-size: 10px; font-weight: 800; color: rgba(255,100,100,.5);
  text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 8px;
}
#ban-screen .bs-reason-text {
  font-size: 14px; color: rgba(255,200,200,.8); line-height: 1.6; font-weight: 500;
}
#ban-screen .bs-until {
  display: inline-flex; align-items: center; gap: 8px;
  background: rgba(255,50,50,.08); border: 1px solid rgba(255,50,50,.15);
  border-radius: 20px; padding: 8px 16px; margin-bottom: 28px;
  font-size: 12px; font-weight: 700; color: rgba(255,150,150,.7);
}
#ban-screen .bs-until::before { content: '⏱'; font-size: 14px; }
#ban-screen .bs-id {
  font-size: 11px; color: rgba(255,255,255,.15); margin-bottom: 24px;
  font-family: monospace; letter-spacing: 1px;
}
#ban-screen .bs-btn {
  width: 100%; padding: 14px; border-radius: 14px;
  background: rgba(255,50,50,.1); border: 1px solid rgba(255,50,50,.25);
  color: rgba(255,150,150,.7); font-family: 'Syne', sans-serif;
  font-size: 13px; font-weight: 700; cursor: pointer; transition: .2s;
  letter-spacing: .5px; text-transform: uppercase;
}
#ban-screen .bs-btn:hover {
  background: rgba(255,50,50,.2); color: #ff8080;
  border-color: rgba(255,50,50,.4);
}

/* ═══════════════ KICK SCREEN ═══════════════ */
#kick-screen {
  position: fixed; inset: 0; z-index: 99999;
  display: none; align-items: center; justify-content: center;
  background: radial-gradient(ellipse at center, #0a0800 0%, #050404 50%, #000 100%);
}
#kick-screen.on { display: flex; }
#kick-screen .ks-card {
  background: linear-gradient(145deg, rgba(20,16,5,.95), rgba(10,8,0,.98));
  border: 1px solid rgba(255,200,50,.2);
  border-top: 1px solid rgba(255,200,50,.35);
  border-radius: 28px; padding: 44px 40px;
  max-width: 440px; width: 92vw; text-align: center;
  box-shadow: 0 60px 120px rgba(0,0,0,.9), 0 0 60px rgba(255,180,0,.08);
  animation: bsCardIn .5s cubic-bezier(.34,1.2,.64,1) both;
}
#kick-screen .ks-icon { font-size: 52px; margin-bottom: 18px; }
#kick-screen .ks-title {
  font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800;
  color: var(--yellow); margin-bottom: 8px;
}
#kick-screen .ks-reason {
  font-size: 13px; color: rgba(255,255,255,.4); line-height: 1.6;
  margin-bottom: 24px; padding: 14px; background: rgba(255,200,50,.04);
  border-radius: 12px; border: 1px solid rgba(255,200,50,.1);
}
#kick-screen .ks-btn {
  width: 100%; padding: 13px; border-radius: 12px;
  background: rgba(255,200,50,.1); border: 1px solid rgba(255,200,50,.2);
  color: var(--yellow); font-family: 'Syne', sans-serif;
  font-size: 13px; font-weight: 700; cursor: pointer; transition: .2s;
}
#kick-screen .ks-btn:hover { background: rgba(255,200,50,.18); }

/* ═══════════════ ADMIN PANEL v2 — PREMIUM REDESIGN ═══════════════ */

/* Overlay */
.adm-overlay {
  position: fixed; inset: 0;
  background: rgba(0,0,0,.88);
  backdrop-filter: blur(16px) saturate(180%);
  z-index: 9000; display: none; align-items: center; justify-content: center;
  animation: admFadeIn .2s ease both;
}
.adm-overlay.on { display: flex; }
@keyframes admFadeIn { from { opacity: 0; } to { opacity: 1; } }

/* Panel shell */
.adm-panel {
  width: 1180px; max-width: 98vw; height: 92vh;
  background: linear-gradient(145deg, #0d0f1c 0%, #090b16 100%);
  border: 1px solid rgba(255,255,255,.08);
  border-top: 1px solid rgba(255,255,255,.14);
  border-radius: 24px;
  display: flex; flex-direction: column; overflow: hidden;
  box-shadow:
    0 60px 140px rgba(0,0,0,.9),
    0 0 0 1px rgba(124,107,255,.12),
    0 0 80px rgba(124,107,255,.04),
    inset 0 1px 0 rgba(255,255,255,.05);
  animation: admPanelIn .35s cubic-bezier(.34,1.2,.64,1) both;
  position: relative;
}
.adm-panel::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
  background: linear-gradient(90deg, transparent 5%, rgba(255,80,80,.6) 35%, rgba(255,140,60,.4) 65%, transparent 95%);
}
@keyframes admPanelIn {
  from { opacity: 0; transform: translateY(20px) scale(.97); }
  to { opacity: 1; transform: none; }
}

/* Header */
.adm-header {
  padding: 18px 26px; border-bottom: 1px solid rgba(255,255,255,.06);
  display: flex; align-items: center; gap: 16px;
  background: linear-gradient(135deg, rgba(255,50,50,.06) 0%, rgba(255,100,50,.03) 100%);
  flex-shrink: 0; position: relative;
}
.adm-header-left { display: flex; align-items: center; gap: 14px; }
.adm-shield {
  width: 38px; height: 38px; border-radius: 12px;
  background: linear-gradient(135deg, rgba(255,80,80,.2), rgba(255,50,50,.08));
  border: 1px solid rgba(255,100,100,.2);
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 4px 16px rgba(255,50,50,.15);
}
.adm-shield svg { width: 18px; height: 18px; stroke: #ff7070; fill: none; stroke-width: 2; }
.adm-title-wrap {}
.adm-title {
  font-family: 'Syne', sans-serif; font-size: 17px; font-weight: 800;
  color: #fff; letter-spacing: -.2px;
}
.adm-subtitle { font-size: 11px; color: var(--text3); font-weight: 500; margin-top: 1px; }
.adm-badge {
  background: linear-gradient(135deg, #ff3344, #c20028);
  color: #fff; font-size: 9px; font-weight: 800;
  padding: 3px 10px; border-radius: 20px; letter-spacing: 1px; text-transform: uppercase;
  box-shadow: 0 3px 12px rgba(255,50,50,.4);
}
.adm-header-right { margin-left: auto; display: flex; align-items: center; gap: 10px; }
.adm-live-dot {
  display: flex; align-items: center; gap: 6px;
  background: rgba(62,207,142,.08); border: 1px solid rgba(62,207,142,.2);
  border-radius: 20px; padding: 4px 10px;
  font-size: 10px; font-weight: 700; color: var(--green); letter-spacing: .5px;
}
.adm-live-dot::before {
  content: ''; width: 6px; height: 6px; border-radius: 50%;
  background: var(--green); box-shadow: 0 0 8px var(--green);
  animation: livePulse 1.5s ease-in-out infinite;
}
@keyframes livePulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.5;transform:scale(.8)} }
.adm-close {
  width: 34px; height: 34px; border-radius: 10px; border: 1px solid rgba(255,255,255,.08);
  background: rgba(255,255,255,.04); color: var(--text2);
  cursor: pointer; display: flex; align-items: center; justify-content: center; transition: .2s;
}
.adm-close:hover { background: rgba(255,107,118,.15); color: var(--red); border-color: rgba(255,107,118,.2); transform: rotate(90deg); }
.adm-close svg { width: 16px; height: 16px; stroke: currentColor; fill: none; stroke-width: 2; }

/* Body */
.adm-body { display: flex; flex: 1; overflow: hidden; }

/* Sidebar nav */
.adm-nav {
  width: 190px; border-right: 1px solid rgba(255,255,255,.05);
  padding: 14px 10px; display: flex; flex-direction: column; gap: 2px;
  background: rgba(0,0,0,.25); flex-shrink: 0;
}
.adm-nav-section {
  font-size: 9px; font-weight: 800; color: var(--text3);
  text-transform: uppercase; letter-spacing: 1px;
  padding: 8px 10px 4px; margin-top: 6px;
}
.adm-nav-section:first-child { margin-top: 0; }
.adm-nav-btn {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 12px; border-radius: 11px; border: none;
  background: none; color: var(--text3);
  font-family: 'Manrope', sans-serif; font-size: 12.5px; font-weight: 600;
  cursor: pointer; transition: .15s; text-align: left; width: 100%;
  position: relative;
}
.adm-nav-btn:hover { background: rgba(255,255,255,.05); color: var(--text); }
.adm-nav-btn.on {
  background: linear-gradient(135deg, rgba(255,80,80,.15), rgba(255,50,50,.06));
  color: #ff8080; border: 1px solid rgba(255,80,80,.18);
}
.adm-nav-btn svg { width: 15px; height: 15px; stroke: currentColor; fill: none; stroke-width: 1.8; flex-shrink: 0; }
.adm-nav-badge {
  margin-left: auto; background: var(--red); color: #fff;
  font-size: 9px; font-weight: 800; padding: 1px 6px; border-radius: 10px;
  min-width: 18px; text-align: center;
}

/* Content area */
.adm-content { flex: 1; overflow-y: auto; padding: 24px 28px; }
.adm-content::-webkit-scrollbar { width: 4px; }
.adm-content::-webkit-scrollbar-thumb { background: var(--surface3); border-radius: 4px; }

/* Tab panels */
.adm-tab-panel { display: none; }
.adm-tab-panel.on { display: block; animation: tabIn .2s ease both; }
@keyframes tabIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: none; } }

/* Section titles */
.adm-section-title {
  font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 800;
  color: var(--text); margin-bottom: 16px;
  display: flex; align-items: center; gap: 10px;
  padding-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,.05);
}
.adm-section-title .icon {
  width: 28px; height: 28px; border-radius: 8px;
  background: rgba(255,255,255,.05); border: 1px solid rgba(255,255,255,.07);
  display: flex; align-items: center; justify-content: center; font-size: 13px;
}

/* Stats cards */
.adm-cards {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 12px; margin-bottom: 24px;
}
.adm-card {
  background: rgba(255,255,255,.03);
  border: 1px solid rgba(255,255,255,.06);
  border-radius: 16px; padding: 18px 16px;
  text-align: center; position: relative; overflow: hidden;
  transition: .2s;
}
.adm-card:hover { background: rgba(255,255,255,.05); transform: translateY(-2px); }
.adm-card::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: var(--card-accent, transparent);
}
.adm-card.green { --card-accent: linear-gradient(90deg, var(--green), rgba(62,207,142,.3)); }
.adm-card.red { --card-accent: linear-gradient(90deg, var(--red), rgba(255,107,118,.3)); }
.adm-card.accent { --card-accent: linear-gradient(90deg, var(--accent2), rgba(166,149,255,.3)); }
.adm-card.yellow { --card-accent: linear-gradient(90deg, var(--yellow), rgba(255,201,72,.3)); }
.adm-card.orange { --card-accent: linear-gradient(90deg, var(--orange), rgba(255,140,66,.3)); }
.adm-card-icon { font-size: 20px; margin-bottom: 10px; }
.adm-card-val {
  font-family: 'Syne', sans-serif; font-size: 30px; font-weight: 800; line-height: 1;
}
.adm-card.green .adm-card-val { color: var(--green); }
.adm-card.red .adm-card-val { color: var(--red); }
.adm-card.accent .adm-card-val { color: var(--accent2); }
.adm-card.yellow .adm-card-val { color: var(--yellow); }
.adm-card.orange .adm-card-val { color: var(--orange); }
.adm-card-lbl {
  font-size: 10px; color: var(--text3); margin-top: 6px;
  font-weight: 700; text-transform: uppercase; letter-spacing: 1px;
}

/* Tables */
.adm-table-wrap {
  background: rgba(255,255,255,.02);
  border: 1px solid rgba(255,255,255,.06);
  border-radius: 16px; overflow: hidden;
}
.adm-table { width: 100%; border-collapse: collapse; font-size: 13px; }
.adm-table th {
  text-align: left; padding: 12px 16px;
  border-bottom: 1px solid rgba(255,255,255,.05);
  font-size: 10px; font-weight: 800; color: var(--text3);
  text-transform: uppercase; letter-spacing: 1px;
  background: rgba(0,0,0,.3);
}
.adm-table td { padding: 11px 16px; border-bottom: 1px solid rgba(255,255,255,.03); vertical-align: middle; }
.adm-table tr:last-child td { border-bottom: none; }
.adm-table tbody tr { transition: .12s; }
.adm-table tbody tr:hover td { background: rgba(255,255,255,.02); }

/* User row in table */
.adm-user-row { display: flex; align-items: center; gap: 10px; }
.adm-ava {
  width: 34px; height: 34px; border-radius: 50%;
  background: var(--surface3); display: flex; align-items: center; justify-content: center;
  font-size: 14px; font-weight: 700; flex-shrink: 0; overflow: hidden;
}
.adm-ava img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
.adm-user-info strong { display: block; font-size: 13px; color: var(--text); line-height: 1.3; }
.adm-user-info small { color: var(--text3); font-size: 11px; }

/* Status dots */
.adm-status-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 5px; }
.adm-status-dot.online { background: var(--green); box-shadow: 0 0 6px var(--green); }
.adm-status-dot.offline { background: var(--text3); }
.adm-status-dot.banned { background: var(--red); box-shadow: 0 0 6px rgba(255,107,118,.5); }
.adm-status-dot.muted { background: var(--yellow); }

/* Tags */
.adm-tag {
  display: inline-block; font-size: 9px; font-weight: 800;
  padding: 2px 7px; border-radius: 6px; letter-spacing: .5px; text-transform: uppercase;
}
.adm-tag.banned { background: rgba(255,107,118,.12); color: var(--red); border: 1px solid rgba(255,107,118,.2); }
.adm-tag.muted { background: rgba(255,201,72,.1); color: var(--yellow); border: 1px solid rgba(255,201,72,.2); }
.adm-tag.warn { background: rgba(255,140,66,.1); color: var(--orange); border: 1px solid rgba(255,140,66,.2); }

/* Action buttons */
.adm-actions { display: flex; gap: 4px; flex-wrap: wrap; }
.adm-btn {
  padding: 6px 12px; border-radius: 8px; border: none;
  font-family: 'Manrope', sans-serif; font-size: 11px; font-weight: 700;
  cursor: pointer; transition: .15s; letter-spacing: .3px;
  display: inline-flex; align-items: center; gap: 5px; white-space: nowrap;
}
.adm-btn svg { width: 12px; height: 12px; stroke: currentColor; fill: none; stroke-width: 2; }
.adm-btn.primary { background: rgba(124,107,255,.2); color: var(--accent2); border: 1px solid rgba(124,107,255,.25); }
.adm-btn.primary:hover { background: var(--accent); color: #fff; }
.adm-btn.danger { background: rgba(255,107,118,.1); color: var(--red); border: 1px solid rgba(255,107,118,.18); }
.adm-btn.danger:hover { background: var(--red); color: #fff; }
.adm-btn.success { background: rgba(62,207,142,.1); color: var(--green); border: 1px solid rgba(62,207,142,.18); }
.adm-btn.success:hover { background: var(--green); color: #000; }
.adm-btn.warn { background: rgba(255,201,72,.1); color: var(--yellow); border: 1px solid rgba(255,201,72,.18); }
.adm-btn.warn:hover { background: var(--yellow); color: #000; }
.adm-btn.neutral { background: rgba(255,255,255,.05); color: var(--text2); border: 1px solid rgba(255,255,255,.07); }
.adm-btn.neutral:hover { background: rgba(255,255,255,.08); color: var(--text); }
.adm-btn.lg { padding: 10px 20px; font-size: 13px; border-radius: 11px; }

/* Search row */
.adm-search-row { display: flex; gap: 10px; margin-bottom: 16px; align-items: center; }
.adm-inp {
  background: rgba(255,255,255,.04);
  border: 1.5px solid rgba(255,255,255,.07);
  border-radius: 11px; padding: 10px 14px;
  color: var(--text); font-family: 'Manrope', sans-serif; font-size: 13px;
  outline: none; transition: .2s;
}
.adm-inp:focus { border-color: rgba(124,107,255,.5); background: rgba(124,107,255,.04); box-shadow: 0 0 0 3px rgba(124,107,255,.1); }
.adm-inp::placeholder { color: var(--text3); }
.adm-inp.full { width: 100%; }
.adm-inp-group { display: flex; flex-direction: column; gap: 6px; margin-bottom: 14px; }
.adm-inp-group label { font-size: 10px; font-weight: 800; color: var(--text3); text-transform: uppercase; letter-spacing: .9px; }

/* Quick actions bar */
.adm-quick-actions { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 24px; }

/* Server info bar */
.adm-server-bar {
  background: rgba(0,0,0,.3); border: 1px solid rgba(255,255,255,.05);
  border-radius: 12px; padding: 12px 16px;
  display: flex; align-items: center; gap: 20px; flex-wrap: wrap;
  font-size: 11px; color: var(--text3); margin-top: 16px;
}
.adm-server-bar span { display: flex; align-items: center; gap: 5px; }
.adm-server-bar b { color: var(--text2); }

/* Modals */
.adm-modal-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,.75);
  backdrop-filter: blur(8px); z-index: 9100;
  display: none; align-items: center; justify-content: center;
}
.adm-modal-overlay.on { display: flex; }
.adm-modal {
  background: linear-gradient(145deg, #0f1121, #0a0c18);
  border: 1px solid rgba(255,255,255,.1);
  border-top: 1px solid rgba(255,255,255,.16);
  border-radius: 22px; padding: 32px;
  width: 440px; max-width: 95vw;
  box-shadow: 0 50px 100px rgba(0,0,0,.9), 0 0 0 1px rgba(124,107,255,.08);
  animation: modalIn .3s cubic-bezier(.34,1.2,.64,1) both;
  position: relative; overflow: hidden;
}
.adm-modal::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(124,107,255,.5), transparent);
}
@keyframes modalIn { from { opacity: 0; transform: scale(.93) translateY(16px); } to { opacity: 1; transform: none; } }
.adm-modal-ico {
  width: 52px; height: 52px; border-radius: 16px; margin: 0 auto 18px;
  display: flex; align-items: center; justify-content: center; font-size: 22px;
}
.adm-modal-ico.red { background: rgba(255,107,118,.12); border: 1px solid rgba(255,107,118,.2); }
.adm-modal-ico.yellow { background: rgba(255,201,72,.1); border: 1px solid rgba(255,201,72,.2); }
.adm-modal-ico.blue { background: rgba(124,107,255,.1); border: 1px solid rgba(124,107,255,.2); }
.adm-modal h3 {
  font-family: 'Syne', sans-serif; font-size: 18px; font-weight: 800;
  margin-bottom: 6px; color: var(--text); text-align: center;
}
.adm-modal p { font-size: 12px; color: var(--text3); text-align: center; margin-bottom: 20px; line-height: 1.6; }
.adm-modal-footer { display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px; }

/* Toast notifications — STACKING */
.adm-toasts {
  position: fixed; top: 20px; right: 20px; z-index: 9999;
  display: flex; flex-direction: column; gap: 8px; pointer-events: none;
  max-width: 340px; width: 100%;
}
.adm-toast {
  background: rgba(20,22,36,.96);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 14px; padding: 14px 18px;
  font-size: 13px; font-weight: 600;
  display: flex; align-items: flex-start; gap: 11px;
  box-shadow: 0 16px 50px rgba(0,0,0,.7), 0 0 0 1px rgba(255,255,255,.04);
  backdrop-filter: blur(20px);
  pointer-events: all;
  animation: toastSlideIn .35s cubic-bezier(.34,1.2,.64,1) both;
  transform-origin: top right;
  position: relative; overflow: hidden;
}
@keyframes toastSlideIn { from { opacity: 0; transform: translateX(100%) scale(.9); } to { opacity: 1; transform: none; } }
@keyframes toastSlideOut { to { opacity: 0; transform: translateX(110%) scale(.9); max-height: 0; padding: 0; margin: 0; } }
.adm-toast.out { animation: toastSlideOut .3s ease forwards; }
.adm-toast-line {
  position: absolute; top: 0; left: 0; bottom: 0; width: 3px;
}
.adm-toast.success .adm-toast-line { background: var(--green); }
.adm-toast.error .adm-toast-line { background: var(--red); }
.adm-toast.info .adm-toast-line { background: var(--accent2); }
.adm-toast.warn .adm-toast-line { background: var(--yellow); }
.adm-toast-icon { font-size: 16px; flex-shrink: 0; margin-top: 1px; }
.adm-toast-body { flex: 1; }
.adm-toast-title { color: var(--text); font-family: 'Syne', sans-serif; font-size: 13px; font-weight: 700; }
.adm-toast-msg { color: var(--text2); font-size: 11.5px; margin-top: 2px; line-height: 1.4; }
.adm-toast-close {
  background: none; border: none; color: var(--text3); cursor: pointer;
  font-size: 14px; padding: 0; line-height: 1; flex-shrink: 0;
  margin-top: 1px; transition: color .15s;
}
.adm-toast-close:hover { color: var(--text); }
.adm-toast-progress {
  position: absolute; bottom: 0; left: 0; height: 2px;
  background: var(--toast-progress-color, rgba(255,255,255,.2));
  animation: toastProgress linear forwards;
}
@keyframes toastProgress { from { width: 100%; } to { width: 0%; } }
.adm-toast.success .adm-toast-progress { --toast-progress-color: var(--green); }
.adm-toast.error .adm-toast-progress { --toast-progress-color: var(--red); }
.adm-toast.info .adm-toast-progress { --toast-progress-color: var(--accent2); }
.adm-toast.warn .adm-toast-progress { --toast-progress-color: var(--yellow); }

/* Log items */
.adm-log-item {
  padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,.04);
  display: grid; grid-template-columns: auto 1fr auto; gap: 14px; align-items: start;
}
.adm-log-item:last-child { border-bottom: none; }
.adm-log-action {
  font-size: 9px; font-weight: 800; padding: 3px 9px; border-radius: 20px;
  text-transform: uppercase; letter-spacing: .7px; white-space: nowrap;
  background: rgba(124,107,255,.12); color: var(--accent2);
  border: 1px solid rgba(124,107,255,.15);
}
.adm-log-action.ban, .adm-log-action.auto_ban { background: rgba(255,107,118,.12); color: var(--red); border-color: rgba(255,107,118,.2); }
.adm-log-action.delete_user { background: rgba(255,107,118,.18); color: var(--red); border-color: rgba(255,107,118,.3); }
.adm-log-action.kick, .adm-log-action.mute { background: rgba(255,201,72,.1); color: var(--yellow); border-color: rgba(255,201,72,.18); }
.adm-log-action.warn { background: rgba(255,140,66,.1); color: var(--orange); border-color: rgba(255,140,66,.18); }
.adm-log-action.broadcast, .adm-log-action.announce { background: rgba(79,195,247,.1); color: var(--accent3); border-color: rgba(79,195,247,.18); }
.adm-log-action.unban, .adm-log-action.unmute { background: rgba(62,207,142,.1); color: var(--green); border-color: rgba(62,207,142,.18); }
.adm-log-details { font-size: 12px; color: var(--text2); line-height: 1.4; }
.adm-log-time { font-size: 10.5px; color: var(--text3); white-space: nowrap; margin-top: 2px; }

/* Broadcast type selector */
.adm-broadcast-type { display: flex; gap: 8px; }
.adm-type-btn {
  padding: 9px 16px; border-radius: 10px; border: 1.5px solid rgba(255,255,255,.07);
  font-size: 12px; font-weight: 700; cursor: pointer;
  background: rgba(255,255,255,.03); color: var(--text3); transition: .2s;
}
.adm-type-btn.on.info { border-color: var(--accent2); color: var(--accent2); background: rgba(124,107,255,.1); }
.adm-type-btn.on.warning { border-color: var(--yellow); color: var(--yellow); background: rgba(255,201,72,.1); }
.adm-type-btn.on.danger { border-color: var(--red); color: var(--red); background: rgba(255,107,118,.1); }

/* Pagination */
.adm-pagination { display: flex; gap: 6px; align-items: center; margin-top: 16px; justify-content: center; }
.adm-page-btn {
  width: 34px; height: 34px; border-radius: 9px; border: 1px solid rgba(255,255,255,.07);
  background: rgba(255,255,255,.03); color: var(--text3);
  font-family: 'Manrope', sans-serif; font-size: 12px; font-weight: 700;
  cursor: pointer; transition: .15s; display: flex; align-items: center; justify-content: center;
}
.adm-page-btn:hover { background: rgba(255,255,255,.07); color: var(--text); }
.adm-page-btn.on { background: rgba(124,107,255,.2); color: var(--accent2); border-color: rgba(124,107,255,.3); }

/* Broadcasts history */
.adm-broadcast-item {
  padding: 14px; background: rgba(255,255,255,.02);
  border-radius: 12px; margin-bottom: 8px;
  border: 1px solid rgba(255,255,255,.05);
  border-left: 3px solid var(--bcast-color, rgba(255,255,255,.1));
  transition: .15s;
}
.adm-broadcast-item:hover { background: rgba(255,255,255,.04); }
.adm-broadcast-item.info { --bcast-color: var(--accent2); }
.adm-broadcast-item.warning { --bcast-color: var(--yellow); }
.adm-broadcast-item.danger { --bcast-color: var(--red); }
.adm-broadcast-text { font-size: 13px; color: var(--text); margin-bottom: 5px; line-height: 1.5; }
.adm-broadcast-meta { font-size: 11px; color: var(--text3); display: flex; align-items: center; gap: 10px; }

/* Warn badge */
.adm-warn-badge {
  background: rgba(255,140,66,.15); color: var(--orange);
  border: 1px solid rgba(255,140,66,.2);
  font-size: 10px; font-weight: 800; padding: 2px 8px; border-radius: 8px;
}

/* Confirm overlay for destructive actions */
.adm-confirm {
  position: fixed; inset: 0; background: rgba(0,0,0,.8);
  backdrop-filter: blur(12px); z-index: 9200;
  display: none; align-items: center; justify-content: center;
}
.adm-confirm.on { display: flex; }
.adm-confirm-card {
  background: linear-gradient(145deg, #130a0a, #0d0608);
  border: 1px solid rgba(255,80,80,.15);
  border-top: 1px solid rgba(255,80,80,.3);
  border-radius: 22px; padding: 36px; text-align: center;
  width: 380px; max-width: 95vw;
  box-shadow: 0 50px 100px rgba(0,0,0,.9), 0 0 60px rgba(255,50,50,.1);
  animation: modalIn .3s cubic-bezier(.34,1.2,.64,1) both;
}
.adm-confirm-ico { font-size: 36px; margin-bottom: 16px; }
.adm-confirm-title { font-family: 'Syne', sans-serif; font-size: 20px; font-weight: 800; color: var(--red); margin-bottom: 8px; }
.adm-confirm-sub { font-size: 13px; color: var(--text3); line-height: 1.6; margin-bottom: 24px; }
.adm-confirm-btns { display: flex; gap: 10px; justify-content: center; }

/* User profile in admin */
.adm-user-profile-card {
  background: rgba(255,255,255,.02); border: 1px solid rgba(255,255,255,.06);
  border-radius: 16px; padding: 20px; margin-bottom: 16px;
  display: flex; align-items: center; gap: 16px;
}
.adm-profile-ava {
  width: 60px; height: 60px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 22px; font-weight: 700; flex-shrink: 0; overflow: hidden;
}
.adm-profile-ava img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
.adm-profile-info { flex: 1; }
.adm-profile-name { font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 800; color: var(--text); }
.adm-profile-tags { display: flex; gap: 6px; margin-top: 6px; flex-wrap: wrap; }

/* Colored notif in old style — compatibility */
.adm-notif { display: none; }
.adm-page-btn{padding:5px 12px;border-radius:7px;border:1px solid var(--border);background:var(--surface);color:var(--text2);cursor:pointer;font-size:12px;transition:.15s}
.adm-page-btn:hover,.adm-page-btn.on{background:var(--accent);color:#fff;border-color:var(--accent)}
#adm-trigger-btn{display:none}
#adm-trigger-btn.visible{display:flex}
.adm-warn-badge{background:rgba(255,107,118,.15);color:var(--red);font-size:10px;font-weight:700;padding:2px 7px;border-radius:20px;border:1px solid rgba(255,107,118,.3)}


/* ═══ Quick Actions Btn ═══ */
#adm-tab-quickactions .adm-btn.neutral {
  display: flex; flex-direction: column; align-items: center;
  height: auto; gap: 6px; text-align: center;
}
/* ═══ Ban screen countdown ═══ */
#bs-countdown {
  font-family: 'Syne', sans-serif;
  font-size: 40px; font-weight: 800; color: rgba(255,80,80,.7);
  margin: 16px 0 8px; letter-spacing: -2px;
  text-shadow: 0 0 20px rgba(255,50,50,.4);
}
#bs-countdown span { font-size: 14px; color: rgba(255,255,255,.2); font-weight: 500; letter-spacing: 0; }
/* ═══ Analytics Chart Bar ═══ */
#adm-chart-bars > div { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 4px; }
/* ═══ Bot message sender ═══ */
.adm-bot-preview {
  background: rgba(124,107,255,.06); border: 1px dashed rgba(124,107,255,.2);
  border-radius: 12px; padding: 12px 14px; margin-top: 10px;
  font-size: 12px; color: var(--text2); line-height: 1.6;
}
</style>
</head>
<body>
<canvas id="fx-canvas" style="display:none"></canvas>

<!-- LOADER -->
<div id="loader">
  <div class="ld-logo" style="flex-direction:column;gap:20px">
    <img src="data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCAEAAQADASIAAhEBAxEB/8QAHQAAAgICAwEAAAAAAAAAAAAAAAgGBwMFAQIECf/EAFUQAAECBQEDBgcLCQcBBwUBAAECAwAEBQYRBxIhMQgTIkFRYRQVN3F0gcEXGCMyVVaRkpOh0UJSVFd2lbGy0hYkM1NicpSkCSdkouHw8SU2Q4KDwv/EABsBAAICAwEAAAAAAAAAAAAAAAAFBAYBAwcC/8QAOxEAAQMCAgYGCAYCAwEAAAAAAQACAwQRBSEGEjFBUXETFGGRwdEWIjIzNVJTgRU0QqGx8CNyYqLhkv/aAAwDAQACEQMRAD8Aq/EGIIIp67ujEGIIIEIxBiCCBCMQYgggQjEGIIIEIxBiCCBCMQYgggQjEGIIIEIxBiCCBCMQYgzBAhGIMQQQIRiDEEECEYgxBBAhGIMQQQIRiDEEECEYgxBBAhEEEECwiJfpDZ7V8XeKG9OOSiC0pznEJCju7jEQi2eSj5Vk+ir9kbqdofK1p2KBikz4aOSRhsQMls5zSrTOWm3ZaZ1MQ0+0rZcQpABSeyMXuYaW/rRa+qIUvWnyqXHkYPhy/ZGgRQqytCVopk2pKhkENHeIf9Rg+Vcz9I8S+qe4eSdP3MNLf1ot/VEHuYaW/rRa+qIS7xBW/kqb+yMHiCt/JU39kYOowfKj0jxL6p7h5J0fcw0t/Wi19UQe5hpb+tFr6ohLvEFb+Spv7IweIK38lTf2Rg6jB8qPSPEvqnuHknR9zDS39aLX1RB7mGlv60WvqiEu8QVv5Km/sjB4grfyVN/ZGDqMHyo9I8S+qe4eSdH3MNLf1otfVEHuY6W/rRa+qIS7xBW/kqb+yMHiCt/JU39kYOowfKs+keJfVPcPJOj7mGlv60W/qiD3MNLf1ot/VEJd4grfyVN/ZGDxBW/kqb+yMHUYPlWPSPEvqnuHknR9zHS39aDX1BB7mGlv60W/qiEu8QVv5Km/sjB4grfyVN/ZGDqMHyo9I8S+qe4eSdH3MNLf1otfVEHuYaW/rRb+qIS7xBW/kqb+yMHiCt/JU39kYOowfKj0jxL6p7h5J0fcw0t/Wi19UQe5hpb+tFv6ohLvEFb+Spv7IweIK38lTf2Rg6jB8qPSPEvqnuHknR9zDS39aLX1RB7mGlv60WvqiEu8QVv5Km/sjB4grfyVN/ZGDqMHyo9I8S+qe4eSdEaY6W/rRa+qIPcx0tx5UGvqCEu8QVv5Km/sjB4grfyVN/ZGDqMHyo9I8S+qe4eSdH3MNLf1otfVEZpLSnTSbmmpSW1MQ6+8oJbQlAyo9ghJnKHWG0KWumTSUpGSS2cARI9DQFau2yCMjw9Htg6jB8qPSPEvqnuHkmB1nsqWsW6GqTKzjk2hbCXCtaQCCerdEHi4+Vr5RJf0RHtinIQ1LQyVzRsXSsImfPRRySG5IzRBBBGhMUQQQQIRFs8lHyrJ9FX7IqaLZ5KPlWT6Kv2RIpPfN5pZjXw+b/UpXNZ/K3cXp6vZDiV2fu1y4bXta1KhSqVLm2WJ11b0nzm0cITjd174TvWfyuXCf/Hq9kOXLH/vZtsdYspnI/8A2ahpjVTJS0Es0Rs4DJcjpYxJM1rthK48S6t/PS3f3Wr8YPEurfz0t391q/GLC4cYOvEcr9MMW+oP/keSs34VTcFXviXVv56W7+61fjB4l1b+elu/utX4xYUEHphi31B3DyR+FU3BV74l1b+elu/utX4weJdW/npbv7rV+MTubnJWUSDMzDbWfihR3nzDjGVpaHUBbagtJ4EHdGfS7F7X6T/qPJY/DKW9rfuq/wDEurfz0t391q/GMU3TdVpVrnX72t5KM4z4qWfbE8qU6mSbSrwd+YUo4CGgM+ffGrrlxUxuzKlXkPIclpVhxS8/kqTuKTnrBjdFpTjMhFn5E29keS8Pw6laDko2mjatLSFIva3FJIyCmmKIP3xz4l1b+elu/utX4wcnm6VXZpjJTbja0PyqjKuFX5ZTjpD6YsKPVZpPjFLO+F8mbSR7I8kQ4dSyMDw3aq98S6t/PS3f3Wr8Y4XR9WUIK13vbaEpGSpVMUAB3nMWHFccoq6lWlplOzLTSlvzhEq2RwQVg9L1Ygo9J8Yqp2QskF3ED2R5Imw6liYXkbFxJ0/VWba51i9reUjOMmlLHtjN4l1b+elu/utX4xI6HcFMcsym1t15tqXmWWyjH5SlbgkY6yd0bSnTiZxCz4O/LqQcFDoGfPujzLpTjMZN35A29keSGYdSuAyUI8S6t/PS3f3Wr8YPEurfz0t391q/GLAcWhtJU4pKEgZJJwBGKUm5WbQpcs+26EnCgk70+ccY1el2L2vr/wDUeS2fhdLe1v3UE8S6t/PS3f3Wr8YPEurfz0t391q/GLCgjz6YYt9Qdw8kfhVNwVe+JdW/npbv7rV+MHiXVv56W7+61fjFhQRn0wxb6n/UeSPwqm4Kq6RVrtFw3baN1ztLqjDduuzTS2JTm8K3jrhSdC/K9bHp6PbDcTflgu79kXf5jCj6F+V62PT0e2OqYPUyVVDFNKbuIzVZqWCOVzW7Amr5WvlEl/RE+2Kci4+Vr5RJf0RPtinIV1nv3c11rAvh0PJEEEERk1RBBBAhEWzyUfKsn0Vfsipotnko+VZPoq/ZEik983mlmNfD5v8AUpXNaVbOrVxHsn1H+EOXLKCtWLaWBjNksH/zNQmWtnlXuT05fshzJEZ1Ttnfwshj+ZqJukfwubkuTUX5hnNWEo5JMRTVK4k21bLc4qY8GTMTrEqt3rbQ4vZUoeYHOYleIXjlsXBLs2xS7cSsc/MPl5wA70pGCk4798chwOk65XxQ2yJz5BWmtl6KBzlfdKlWWpZtyXmX30LbBC3HivaGM53x6/NCX6Z61XXYxZo0+pFVpqQC005uWlOPyVHh9EW81ym7K5vE1SqnLvgb2vjZPn2Ya4holiUEhDG644jxCjwYpA5vrGxWn11vu5rf1cbkqBT5SeeEm0GGphoOELXncgEHecRZOkN5P1tpVIrNORS6w00Hly6dwUD2DAA4HcIWG+tV52papt6hUOWEo7KBtEuy70xsJJ+Pw47ocKkBi5abRrkmZIys4GudQFjC2toYUD3EfxhhjtG2iw+Bk0QBLbawOYcNxG8LRRTdJLIWm/Dkt6DsK2ycAbzCW6halz7bt4WZKS6BTajVnFhzaxhIUvbx/uKgfVEz141eq87VqtQ7YrjNMpsg2EPOtnacmVlQBCSDuAzg8eBhbXw48+UBSnFLVlK1bsnr+mHGiujj4I+nqgPWsQOFjcEqJiVcJHajNybDQC4ZKiaZyLUpPszD0uh6dqLYVhLKFJTsJV/qJSoDzRekpVJGYal1CZbSqYSFIST2jOI+fNsXDPWzWZOoy5YU2FAqQ+0VoCh+UUgjJHEQ4FjXDK3RasuaKxUlSZeRMT1Unmi2lSkqBwjIG1nATuPCFelOB9FL04zDibnnnn4bzsW7Dq06upwVjv1OSbamFpmELLAO2kHgQOEULygK/KVvTqdbnZ1liYebZnae2o5Q8gJUVpT/AKhlOfPE4vS4Ja1LUmnaszUkSYfcmZGpyLZcCVLJV08A7ONop3nfCdXJcM9dFXm6lOlgAkkIl2ihBWr8oJJOCeuM6K4J0kvWNgaRY8bcPHeNiziNb6uorC081Lm1m0LKnGguQp9URlzjkFSNgdwSoZh0V4Ks5zneD2x8zJXnG3RhS2FoWFFYG9PZmGW0J1ZrUpV6TRLnrbNTps8gtsvrOHJdYJCQo54HGBw4iGmlWjrp2CemAGrrEjebm5IWjDa4Ru1JN6trV683aO2mh0WnIqladbLqZde9KQOGRg5zngYrbQe+7muDVpyRrkhKyLhlHEvtsNhslSBuCwBxGYu2upZtqlVy45SRVOVAtc6sITlbmzuSkdwB+6FAsbVSbpOqDt/VuUVOuzZcTMNI6A2VfmceG+E+B0ja3D544YgSG2Dicy47rbgpdZN0U0bnG3HkneMeSqMMrlnHn5h5lttslSkOlASO04imHuU3ZqWiZSkVSYfIyGz0cespioNStaLsvkzFGk3G6VS1py8y1vUpPYpQOFdXUIXYdoliU8oD26g4nwC3T4pA1uRuU1WmNxIuW2XJtqYEy3Lzr0ol7P8AiJbVgK789sSiF45FNxS0xbNTtwqCZiXf59tJO9SVZKj6t0MOBnhvhXjlH1OvkhAyBy5KTQzdLA1yq2b8sF3fsi7/ADGFH0L8r1seno9sNzOeWG7v2Rd/mMKNoX5XrY9PR7Y69o78Mh5KrVv5h/NNXytfKJL+iJ9sU5Fx8rXyiS/oifbFORCrPfu5rq+BfDoeSIIIIjJqiCCCBCItnko+VZPoq/ZFTRbPJR8qyfRV+yJFJ75vNLMa+Hzf6lK1rZ5V7k9OX7IcbnFNakW86hKlLRYrSkgdZBahOdbPKvcnpy/ZDlyYB1UtfOd1ksfzNRO0iNsMm5eK5NRC87ea8t0ar2taFnonpud8PqK2woyKchwuEZII/JAPbiE/vC4aje91zNy3E+G0OK3N9SEjghI44/GGK5Wem8rOURy+qUw2zOyYAnEITgOt/n4HWMevMKrstraQ++0pTZ6O0Fk7J74U6IUlEKY1UOb3ZG+0dn92qTick2v0b9gXql3zP1tU4vCJdtJ48EgJwB/77Y7MoROSwLh2VrWrmFde7O7zRwWKeWxLLm3pcfGAUgbKvWDvjmeJkEtutNLcCRhtw7kjzARcEsVoclay13beXjKqtc9SaWQtxtaOi45+SD2jccxafKWdv62FP3Hb1UXL0OYlUyky00AS0cnBAI3A7QGREm5KlMZpuj8g82OnOOKfdWeJyAQPVvjPe89VKfepFYk35m1ZuX5p5HMJdQpW/t3g7xvEcuqsUkqMbcbBzWXGqd4G23/I7lZaaivS2Bs45pd9JrUpExQZ69bwVMqbpju0zILaUgTqlYIKlEbxlWdxHCPFqhczF1S0oinNNPzji8tS0nK7PMAbsDAyeI7YZaVt9m/ngidpr0hakmyW5SVUObW8vGNs46gCcb+oRBrP0Kq1l6mC4pKtyjVClCVIUtvnH9kkHZ2VJI9ecw1jx6ldM+WodaRou1pOQ4NuBtvty7L5LDqd9PD0UbQdbJxte3LzStT9PfllutTodYmm962nUFJHqIhlORvPytQlp6iVBqZmJhtQmWDzh5ptG4cAeOQeMeflgUe33q/SajKvNJqE8hTL+wNytnGwTjdklRzEc5GroZ1OmZZc6tn+6qSGkpyHyCdx7McfVDLEaluJYC+osWm17cCD/CVwR9DVhm3NSflkVSUkUSdCpzczLTDhMw+Q4eaWjfkYPXkjhC4U+QmJksokOdfm3VdBlpBUo47gIunlkrQ9qaxLpmlOnwZIKFjAZyBuHbnjEg5IdJoMtcFWnZl1pU/JNpaZKx8UqztkZ8wjGHVLcNwFlRYuIF+ZKzPH09YWXtmq/wBL7llrUYmUVFtqXnkLHOSs5KlRfB3YORkD6I9erVrUmXosjetniYS1U3cvU9ttSkyawCSpKgNwynO8njFpXloVVb01MVcE9XZRyhTRC1Lbb2H9kEkJACQPXnMTiZoTNhzgbk6Q9ULWnGA1NMp6amFgY2sE8CBv38TC6XHqVszJad15HC7m3y/1uRt4d29MxTyVEPRSNA1fZNrE81DuTSNQLmXKXPcdVU9RJWVXKSzbgwXjlOSR142cZPbFY8qqyXbUvFNTpaOapdUJWhtKOi25+UB2DeIv+xp6rT98gUeVdYtOVleaZbUwllKFbtwx8Y7uJjzcqqltVLSGedWQl2SdQ+0rHDGSR68CFVJiskGNtdYNa+w1RlYE5X7Qdv3RU0NqWxNyM7pNnkplJchC8lC08+rrPA480dX5jwCtJnEdOWcSOHBScbx/77I5kf78HXVsLbCtzjg3pO7sPsgDFOCTKtTUxMD4xAQNlPrzujqKra29nXFULHuuVuW23QtttWS2T8dB4oUOyG/tHVi2L0tFyelp4SNSQgkyRPwgdAyAkflAnszCOrCEoL8q2pttJxtFZ6UNTyStNJSRobd8VWWbdnJwHwNDidoNo/PGes7/ADYin6X0tD1cVU9w8ZC2/sP9yTPDJZuk6NmwqXBa3NVLnccGFrs1alDrBOYUzQvyvWx6ej2w3E2P++C7tw/+0Xf5jCj6F+V62PT0e2G+j1vwyG3BRaz37uaavla+USX9ET7YpyLj5WvlEl/RE+2KciDWe/dzXWMC+HQ8kQQQRGTVEEY+fZ/zm/rCDn2f85v6wgWbHgskWzyUfKsn0VfsioufZ/zm/rCLb5JziF6rJ2FpV/dV8DnsiRSe+bzSzGgRh83+pSua2eVe5PTl+yHLkvKpbH7EMfzNQmmtZzqvch/8cv2Q5UqoJ1StgqIAFkM5JOMdJqJukfwubl4rktF+YZzUxueRaqduVGnTCQpmYl1IUD1jEfOiQJ8MmZJX+GsLGyeojODH0WuWoytOtmeqkw6lMszLqcUs8MYj5yy5KJl+aPAlQR3k8Iq+gGvqTg7Lt787+CZY3bXYh1e1TmNpIUtl4tp708cfSY2LacVN2TQn+7LZC3EdSSUgk/THjlZZ5/m2mUDZQrbcWo4Rtecx3qEzsIXKyiHFrc3OulJ6fcO6OhpGm+5IdxytW0wRSUuI8MprpS42D0tg42Tj1GLRmrjkabW2qXPTTUq5Mo2mFKc+Pjt7I+fFjXJcFq15ueoE67JzSdyscCOsKHZDY8mW7/7dtVmpVtcu9XtvYcSBvEvgYAB6s7Ucv0k0c6vJLW7WHOw2gk/xfNWGgr9drYTtV2OOpKkbS87e5G/juzujWTYfqTHP0t7pMOqbcQsdBeCQQfWIwVqTnZd6Sm6Mwl3wdR25ZSwnbSQeBO4HJ+6IXeU+pcnPVA2U8hTbRMw7MziWmBjrUTja9R3xUqSk6Vw1T/GWdswSP5TKaUsFiFRnKFrCJ+96dRWJqUcRT1qdfalGglto7spyD0lDHYOqOvI+cdVqtPKYnmJdtUurbbWjKnhk4Cd+4jjFY3DW36pMzlbnktIfmlFlpDYIS2gfmg78b4uXkRSTprtXnRIIeZEuEKmTuLSsjd6/bHV8ThFDgUkXBtt20qtwP6Wra7tWq5YCnk6pSrrsyxMNpYQEpQnewMDoq7zxjtyeaw3J3zUqI/NyoFQUHJdmcbCmnVZOBtE9FRz2GNny25Z9NepE34AhlpUupImQcqdOeB7MY+6KZoNfm6a/JVqRDZflMNPJcGQ4k9Rx1boxhkArsCjiG9tt20Ind0VWXdq+gTBcp0qHam7jnXUoSlI6CCogBI7s/wAY2Ic2VKKVY2fjb+EVlZ0643JSU4qyHluONBcu9LzqXWCD1pIyE+sxM6NKTr7k7N1ZlDYmVAplkr2ubSAOJG4nIz645VWUvROOsdnLM33AEqyQzdIAAFnlLgkqlWHadJTTU2uWQC8UuZ2M8B3xVHK/uCXpWl5pXOoE3UnkpQgnpFCfjH7468pm8DYjVJqFBLMvXzlDe7P93PxgodmQnjCnXzclwXRW1zlwTrs5NqOATwA6gkRbdHNHTUSRV2xgzsdpI8Etr6/Ua6HeuHN9TalHU7Mq20VtoHBRCSQfpjwIUU011aQEqfe2FbvyeOPpEeiSmOcYRLTiXELbHwLoSSU9x7vxjpMSzzAW08gbC1BaHEnKdrzx09V5Y6jlU5LyjYyltKUhPeeMfRy3JFunW/ISLCNhllhKEJ7BjPtj5wTBVz7U23u2SArtBEfR23KlL1C2ZCpNOhbDsulxK+0Y/wDSOeafhxjg4Xd35W8U8wS2s7iq/m/LBd37Iu/zGFH0L8r1seno9sNxNEK1fu1QOQbRcIPrMKPoX5XrY9PR7YtWjvwyHkltb79/NNXytfKJL+iJ9sU5Fw8rdxCNRJbaWlP90TxOO2Ka59n/ADm/rCINZ79y6vgQP4dDyWSCMfPs/wCc39YQc+z/AJzf1hEZNrHgrs93zk+/Nb/p0we75yffmt/06YpX3per36JSv+Sv+iD3per36JSv+Sv+iLb0bOC4h1yo+c95V1e75yffmt/06YnWiGqek923mKZZ9FMlUiypXOcyE9EcRkQrfvS9Xv0Slf8AJX/RFvck7QnUDTzU8Vu4peRRI+CrQVNPKUdo4xuKRAI2jMBYdVTOFnPJHMpV9bPKvcnpy/ZDeVRiZmL6oLUmkKmDY8uptJONohxk49YBHrhQ9bPKvcnpy/ZDlyYzqpbHdZLH8zUKdIHamGyu4DxC9UYvO0dqqnlOaqvqoH9iGaNN0qZnEJVNl8DoIxvQCkkHj1Z4QtrTkm28GtlTigQAp3ISPohsuWVbSJ+x5a5WWwZumvBsq6w2rJP8ohUZVbdUYclnkJTNISVtOAY2scUmIeibqd+HB0DdXM3zvmt2JB4nIebr1OPTCl+DTSw1kbTKkAbCh2bo6NLDiHVhONlslQz8RQIH3x42XFOU1Tbp3yzgUg9m8DEZ5tC2pUstIJemTtqA6k/+u4xZVAXRqbYdqjbr/QDrQQ4pI4E8TGxs2uVa26yJ6hT65SoMK6Kkq6LqfzSOB9fbGnp1KmJyfEqnCd2VrPBI7Y3hlqfKsFUtJNutp4zEw4U7R7hgx5exr2lrhcFZBINwrnkuU7dbUuiXnLVk35pIwXBt9I9u44+iIZqfqpd18SzcjVH0U+VdXhMhLHcrvUeOO7PXEGddVsBbEw+gYyW0ukgj/SfZHiS6oTUvMtS60MoXtFxe8qPaYV0+BYfTy9LHEA4b+HJSJKyaRuq52S4qiG1VdMu2QWWkhKBniIsfkz3Kbe1Nk5F+pOSMjNKUiZORsL6J2QrPDfjfFVmYWmeW6ppKyTvHH6OyNlMLp7im5xTTimVjYfTnBSrt/hE2spm1UD4H7HC3/q0xyGN4eNysDlM3ILi1PnJOVqa5+QlSluXIPQR0emBjj0s74rqlNoFUVKqVsMvJKFDjgfjGeXckEKdnksqDKBzbKOtSu3+Mavwp0zqHW2w2QoEJHtjNJTNpYGQs2NFv/fuiR5keXHerS001Vu6yGFyVNmEVGVaODITKjhHek8fVmJpN8p66XpVbEna0ozNLGErO3hPfvP8AGKH51Spp+ael3FNLVtJcQcFJ7RHqaeXslb8y+4DvDanSkAd6uMQanAsPqZelliBdxW6Osmjbqtdksl4V6sXHWFTlcqC5uoPq6alK6LafzR1AebsjXzU2wmquuNbw20UNqPaOBjbCWkJhkKmpJDbStwmJZwqCf93CNBUKY/KT5lThXWhY4KHbDRjGsaGtFgFHJJNytishtttWdsKbBSPzlE4yTHZl59DhlJVXO7PSdUsAoHdvjzyqXXJXmXcpelukkEcUdnq3mMDzik0xDLSsc+6VLOeO8gDzR6WF3eek3XVtbBbUo9JTOSk/TvhkOTLqpMf2fXZMxR5yqzMo2oyhYx004+IoqIA9eOMLlNLapTKJZhCVTSkhTrihnHcIbDkbW2mnWLM3E+0EzdSeKUr61NJwR95MVrSx9OzDi6ZutmLC9s1Pw0PdOAw2W4pzD7Go9yImt0wbPeU4nOdglaiE+oED1Qqehfletj09HthuJvywXdj5ou/zGFH0L8r1seno9sTsBdr4dC7iFprBad3NPfrjqZpZZ10NSF50Yzs+phK0r5oKwk8BviAe75yffmt/06Y68rjRC+9R7+latbUvJOSiJRLZU68pJ2hnO4JMUv70vV79EpX/ACV/0Q0MbTmQvLaqZos15A5lXV7vnJ9+a3/Tpg93zk+/Nb/p0xSvvS9Xv0Slf8lf9EHvS9Xv0Slf8lf9EHRs4LPXKj5z3la/30Wr/wAutfZq/qg99Fq/8utfZq/qilII9qOrr99Fq/8ALrX2av6ouTki606hX7qkKPcVVbmJHwVay2EEbxjHXCYQxXIB8tR9Cc9kCFU2tnlXuT05fshy5LyqWx+xDH8zUJprZ5V7k9OX7IcuS8qlsfsQx/M1CTSP4XNy8VKofzDOa9evEl4w0iuKX2do+CFad3WP/mEFpJKKk2ew74+hGrjiGdMrgccXspEivJ+iPnzTWlKfW4O8JJ4b+v1RXtAnHqko3a3gp+NAdK09i9lJlkvc+86oIYQ4VLUTuHYPpxGZU18KHWmGXWSrC1q3q7vNGKZcfLKESaElhk5KcjKz1kiOja2Xdh6Xb5lSlbDrY4dufui+JMtplEpKFD5IVNvEOKzv5pPH6cxYGlmjNZ1Fll1+qTvimiJB5la0520j83eMDv8APFavS66tXqdTELILwQ2CO1UMtyh6/O2pQbftS3JJ4SEklqYnuYSSA0CDsHHAEg588IsZrJ2PjpaUgPffM7gNp57gplJEx15JNgUZurk3ON0ZdSsq4W6mppJJlyNzpB34VnHDqxC/zC5unVJ2VeLrC21lDzStxSQcEEQy/JSuSo1C+q7I0tLq7eW34QQ9k8yslOdk+c4x2RX3LAp1Op+qzipJlDLj8shx5KOG2Ug59eSYhYViFVHiDsPqna/q6wdsPI9q21MEZiE0Ytnayqmo85JTCHJV0pbdSFpKd3HujO9MifpLzhSlEw3jb2RgLTkb/PHjqilKZk8johhIBju00uUcTlQLUw2cK6uv2xakuXoamBIUhlYSlUw4TsbQ3ITnj54wU/bnHluzTxUhpO2ra35xHVxtc4tRScNMNjJ6hjA/jHFLJDE5jgWSDAhd2nZyo1NqXaDrzjqw2y0jftEnASB54YG0eTW69SW6relfTTS4jaVLgf4eeAK84zw3YiK8j2nSE9qqlydaadXLy63GUr/O2VbwO0YzE85VNz1SRv2i06qpfRbqE+EJSySnn14I3nz7sdgiq4riFVLXtw+ldqZaxO08h2plTQxNi6aUXF7KD6qaM1jTphFwUqdFXoav8ZaU4LaTw2hk5GOuK+HNzcslppRK5N4JSQf/AMaj7MQxnJ8rs7dlDuC0LgkXkyM6lx+R59JxzOc7IJ4gZTgjsha5VlVIr9Rp7iuk1toPfiJmDVlQ90tLVEF8dsxvB2HnuK1VcLG6r4xYFdETnwpedl2W2Uq2ULA2VHt88YavLJZ5l5lQUwtYUhQO4794+mOHC0wlTz7YdUlWwy0eHbk/THdlcwWXG51KUsO7wnIBQeogcYfKEtdV1FdSeUcb1bvND/aGyKafpLbsuj9ECj5yTCCVRlSH0uEg8ASOs9vrj6E6UOpe01t9xOzhUknh5zFE09cRSxN3a3gnWCj/ACuPYopN+WC7v2Rd/mMKPoX5XrY9PR7Ybib8sF3fsi7/ADGFH0L8r1seno9sWHR34ZDyS+t/MP5ppeWFrJfmn+oMrS7ZqTcrKLlEuFBQTlRzk8RFIe+i1f8Al1r7NX9US3/tCPKtJego9sLPDpRVdfvotX/l1r7NX9UHvotX/l1r7NX9UUpBAhEEXh71jWD5Glftj/TB71jWD5Glftj/AEwIVHwxXIB8tR9Cc9kaX3rGsHyNK/bH+mLi5JGiOoVgaoCtXFTmGJHwZbZUl0k5OMbsQISva2eVe5PTl+yHLkiPdVtcE4KrJZA7+k1Caa2eVe5PTl+yHAmJV6a1NtbwZ0NTDdlMLaUeAO01x7sZhNpCAcMmBNslJozadvNc8p+pNU3RqrBa8KmymWbGcEqUDj+EJEwWENeCrf5lRGXFEfdDa8oqz9Q70t5pcozJpYkV7ZkGHitb5H5YOBv7u+FMeealppyUqFM2FoVsuJPRWk/RCjQuOKKhLWuBcTc2OzgpWKuc6a5FgvNMSr0piYYe5xo8HEH7jGaVWlcyHx0QUFSx1AjdmO5Q3KEOMuFyTf6OOw9h74wISGJSZzvyebT5jv8AZFwSxT/RazqxdtzCsU5lSpejpQ+7jiojeEDvODDa3+zRZmw7mqDKAt1ykOJccKd+Q2rA38N8aPkq0VqiaQyEwAA5PKM04vh0SAQD5smMV/f94krPyVlXU20pgiWq7JOUln8pQ39QJ390crxXEHYhiZBOqyM21s7WuNvMjJWKmgENPfaXDYqv5Gl0UaiSVxylUnWZVWx4SkubtsJ2Rsg+rhEOuel1TU6dvDUV91tilU8EtLcJytIyEIA8w+6LS1L0Osxi0Kcq3ypFTWtplr4TImlEjbIT2gbSvVGn15XKWLYlN0zkCymZm1bc2+2gAqaTuSFd5ChDumrKeetNTRk9JKQMx7LW21j9x++ShvjeyLUl9lv8nYlvDyX5cSy+iUEltXsjY0JMvOsO0qdcDW/badO/ZV2eaJReFgVG35CSFTpfgRn2w5IvBZWl3tQTgYVw3d8Qmm85LVINOM7RyUrbV190XWKVkrddhuOxK3NLTYr3V8y0jLN0uSWHBnaedH5auzzRri8hiWMujeVnLivZHM+HZiolpDWyc7KGxvx3RN7PsGo16mzyqdShPeL2ucnni4UBv/SDg5VuO7ugllZE3XkNh2rDWlxsFvrbpNV0wnrQ1FYdbmaVUQOccQT0EqOFpI7kn74mPLLuei1qWtyWps4zNKKPCFFvfsJUFbifXwjNoU7KX3YlT00nHGlzcivak3XEDotHAUE94CSY3emeiVmTVmzyrg23Ko2t1lwbewJYhRCCU9pGyrzGKXU1dPBW9ZrL9JESMhta72T9h+6aMje+LUj2O47iNqtCwWKLLWLatTcwhxmjNobcCd/SbTtDdx3iFL1osyr2lXxWZ5kplaslbzJI3pJ4oV3jdDJ6eoRp3LSEne11NOuPHwejtFWEpZ6iRnsCfNGXlVUPx5pHPOgjnJBQmUKxnojJVjz4hLhWIOw/E9UHWZIba2dtptbkTmplTAJqe+wtGxJZNr2JgzChtYQCnszwjBLyz02TMPvc22OLiz9wjs4kPy0qrPD4NW/s3+2M5Q3NEuvuczJM9FI/OPYO/jHUlXl1d8HW34Ml/nSlPwascT2GHc5MNTbqWjdJSlzbXKZl1jrBGD7YSVp9mafbk5GlBalnZQn4y1H6IbDk62XqNZNBdVNy8iWJ1W2mSfeKFtE/lndx4bu6KhpnHFLQhrnAOBuLm1+KZ4U9zJrgXG9SWZVnWK8BkHFpO8POYUjQvyvWx6ej2w1kpKOSurV4GYe56YdtN1bqhuGcncB2dUKnoX5XrY9PR7Yb6PgDDYQOCi1nv3c1cf8A2hHlWkvQUe2Fnh3eV/ovfmoV/StWtmQYmJREoltSlOEHaGc7sGKS96xrB8jSv2x/phwoyo+CLw96xrB8jSv2x/pg96xrB8jSv2x/pgQsHvntXvnAPqH8YPfPavfOAfUP4wxXuO8mn9Olv+U5+MHuO8mn9Olv+U5+Ma+lj+YKV1Gp+m7uKXX3z2r3zgH1D+MXLyRNaNQb71SFIuKriZkvBVrLeyeIxg8YkvuO8mn9Olv+U5+MTbRrT3Rm27uTUbJmWnKoGlIAS+tXROM7icRkSMJsCF5dSVDBrOYQORSD61+Ve5PTl+yHLkvKpbH7EMfzNQmmtnlXuT05fshy5LyqWx+xDH8zUJ9I/hc3LxXqi/MM5qwuMUHyotJJeuUeYu6gSeKtLJK5ptGAHWxvJx2jfF+CA7O/aSFDG9J3gjsMcaw3EJsPqGzxHMbuI4FW2op2zxljl8zpFSwXJRYICgdx/JUP/iMj6XVysuyEKU66o9EDeTnAizeU1YqbN1BVNySFIp9THhDOBuQokgp+kE+uJnyT9PZau1F686xLc/LSRDck2odFbg4q9WCI7TNjVPFh4r9rSMh2nd3qotpXum6HepgxfdAszSKgWlcFRmqRVH6a0h3EotZZSUgHOBx7orS4RQbLrbF8aZ3n4U2lxJmpF9YS6tJPSGDjIIyMYzFn6mztn2tOzdS1EoTlbn6nMO+BSzRPwTIO7JBG85HX1QvF3W6qt1VU7Z1m1qQkVjIZdaUQPMcn+MV/BYIZdaT1mh9y4nV1HE7RnnluTCre5lowb2tbiMkwDWvmmol01eVo0w5Xua3NJaXuWRv6WMY4xTlpzNwal63CrPNy8xOtqVNCWmN7ZbQQA3xG7BHX1RF7BpkpL35TaReCH6ZT33tmbU4goUE7Jx342sbxDT2/p1b9m6t0esWsEN0ydpj5eSpwrSAFN4WFEndjPX1x6qmUOBh7YQTI9hIJuRYbgfBaozNVEFxyB/pWk1/lZKoaAvVZ2WFPeE204iXUcmXdURtoSezcIVepOF6TCnyPCmCE7Y4rHEZ798XNyoNQpW5KwmzbdcS5TmJkuPupO554kA47hsjHnilK8FeGuKSrLZICe/AAJ+mG2jdNLBRXlFi4lwHAHZ5qPXPa+X1d2SzUxzmpJRY3zT5KdsjehPX/AAhqNBmJCk6BM1pqVNTX4S465LJODMOj4iCe7ePXCpW8CJ5C1H4PJSruyDvi6uTDqLKWzVV2dca9iQfmAthxR6LTwJ49xz90GklNLPRXiF9UhxHEDaEUL2tl9bfko3dj9e001oTV2Ey8vNvFM0Zdk4bShZILfHsB+mLmmNfNNTLmrTVGmUV0M/4SmlYKwNw2sYxnBjdXBp1bl5as1asXUG3aZJ01nmQHChOCteVlQI3Y7+qFYv2mSkxfdRpNnJmKpT2HcSym0FainAz34ByMmFNKyhx0MbMCJGNFyMhY/pJ8FIeZqUnV2E/0qxrc8QXpWX761KvQyaS4pUtJS6wp1Az0RgZwBwxiLKcv+hXlpPXbRt+cnKxU2Ke4homUcQXEbJwd44wvNp28qh1VE7eNn1qekU8WWmVAHznIhiNM5u0rsnZWq6d0R6hz1MmGfD5Z0/4rJVv6zwwfpjGNQQxgSHWIZYtI1dRttgyzz2FbaN7n3jJtfbxOSUtlLzcvMMqQpDrSt6SMEHODujpPKWS1KIGQgDcOtR3+2GE5WNgS1BqkvedGlA1LTqubnm0/FS5+djqzkCIZyZbFN4aiJnJxpS6dTTz7xO9K1ZGyn78+qH8ON08uHmv/AEgXI7Ru70vfSvbN0O9XHyX9I5eh0eWu6vygVVZpIclWnBnmWyMgkdp3ebEX9HAGOCQkdQG4COY4viWIzYhUOmlO3dwHAK3U1O2BgY1VbN+WC7v2Rd/mMKPoX5XrY9PR7Ybib8sF3fsi7/MYUfQvyvWx6ej2x2XR34ZDyVSrffv5po+WJrFflg6hStLtqqiVlFyiFlGznKjnJ4xSHvntXvnAPqH8YcXWmwtILnuRmdvuZZbqKWEpSFPKSdjq3AxBPcd5NP6dLf8AKc/GG5kYDYkLyykne0Oawkcil1989q984B9Q/jB757V75wD6h/GGK9x3k0/p0t/ynPxg9x3k0/p0t/ynPxjHSx/MF66jU/Td3FUJ4Ox/kt/VEHg7H+S39URlgiprt2sVi8HY/wAlv6oi2+Sc02jVVOy2kf3VZ3DzRVMWvyU1pTqw2lRwVSrmO/hEik983mleNEnD5v8AUpXNbPKvcnpy/ZDlSS0+6paw2h0rJZA7ztNQnWurK2NX7mZcSUqTPKyD5hDRz9XUzXdIrrRsGQnqWaS8sHgsbRG//wDniGWOwumw6Zjduqf2zXI6RwbO0nirlggwRuPVHMcHV2VU8qS1Tcmlsy8wwlycp6g+ycb8ZAUM+bMSXRaht2/pjQ6e0gJ2pZMwrdjpODbP80SerSSKlSpuQe3NzDSmiezIxn1ZiMW9OXBR6dL0Geojsw7LJDDE0yrLTjadyCo46JwBnPXDgVUs+HilBya69r8R28D/ACoLo2x1HSkbRZea/rRNdvG26mqSZnZaVmB4Uh1IUAnIwcHjwMbWUuluemKxJW9KNzYpSNnKVbKFPceaGO7H0xGtZrvmLMsAs+HpRXKh8DLrB+Io/GWO5O76Y1PJOEqNOppbTxdmF1FxUwonJ29lMTeqyHDOtTZtYdVo3HO5PgvJmDqgRN22zUB1bmJPVe6aXQWaIqmTNNJerM882EhlsA5SV8SMkDzkRCtR9VnXmzbFrPOIpsrLiSYdbGFONAAblcQDgHPXEz5XN8OCqqs+kLbQEIS7U1g/4h4pQru+KfOBFIab25X70uZul0Vpa5tw9N/8llHWSeriIv2DUsXUo6iobqsaLtBN7XzLiTx3DcEjq5D0zmR7T/bLy2vSZhyfSlMu7NTzp2JeVa3rUo/wia35pfMUDT+Uuar1CXTUJqZ5lmSZIISnv785i56KLC0cr9Mt6WqMk3X5rPh9RmUh0tHdhJGRsgnPE7ojGrdhWc9R6ndlAueVmJmXKXlSDMwlxCSVAKKQDu3En1xkY86epjABZGSLHVvrZ2+w7eHBeRSBrDfN3PZ5qA2Bpe/X7CmLipNRYVUmJksuSDxACxv3Dv3CIRdFJfRUnGyw7Lz7aiiZlXhhaFjj54vbSaxrTl6VTLruC6JaVnJhSnm5F6YS2g4JCCoE7+jviSVdFhax12qUF+qyKq/KgGQqUukNl078gDJ2wN3A78wfjzoKmQOBfGNpsRq52+47f5WephzAdjue3yVXaa6srlmf7M3W6tymTMsZF1xxOVttqBAyriQnaJz1RMtH5qW0ruqpUF+iKqUxVMO0WeYaCg82QMJ2+IHHPeIo7Ui267Zd0uUuspWiZa3odA6LyM4Ch9Bi8eSXfi1VZFn1gtuJW2pyluHi2c5UgHsPSPnjGM00QoZKmnbrMcLuANr22OBHDeN4WaSQiZrJNoP9CvWfugU+oUSmXFJNyxqzZG0VbTbb27DRz1npfRGtsC0TQryuWqplG5OVnH9mVZbSEjZBPSwOo5iM8rBmWc07lFuP8zMIqLZYUDg52VRttGbymr10/LfhifHlPPMzK+IWocFHuUc/RFAFNIMM6zFk151XbbDO4PgngmAqDE7btHktzrTRZevaY1yRmEbQEsp5JxvBb6Y/liO8l62EW5pXJOrZSicqBL7ygN5GTs7/APbiJHck3cFZpkxQJChuS70yjmZiafV8ChtQwspOOkSnOO+JPSJBumUiTp7Iy1LS6GUHtCUgZ9eIhuqZIMPNITk517X3AeJt3L01jZKjpbbBZeqCCBI2lBOcZ3QnU5VZMlPuxXhgnItJzPdvMKRoX5XrY9PR7YZGkVYzVy6w3i48nxbKUwU1hXDCyWwR9KjC56AsOTOs1qsNDK11BAA9RjvWCwuhw+FjtoaFSapwdM4jimi5XDLS9RZcqbQT4IjeU+eKb8HY/wAlv6oi5+Vqoe6OwnI2hJoyPpinYWVnv3LrWBEjDoeSxeDsf5Lf1RB4Ox/kt/VEZYIjJtrFEEEEC8oia6E1VNH1boUy4rZbfeEqru2yBn7ohUdmX35aYampVfNzDCw40o/kqHAx7jdqPDuC1VEInidEf1AjvWt5attuUHXSpzRT8FVUpnGzjdg5T/8A5iZaIur1C5P1VtFtaTXbVe8Z0pJPSKQrKv51CJ3ypqCnU/Quj6g0ZgvVCmISJltAysoyAQe5OSqFW0fvmpaeXxKXBIL6CFbEyyeDzR+Mkj7/AFRawQ9vYVxKWN0MhY7Ig2Ty6V3bL3pZUnWWzsTOyGpxoghTbyRhYIO8b8xKYo6tvKtSqN6v6etrqVlVoBysU5k7S5V1W9SgnqOSrcDiLftquUq46OxVqNONzUq8kKSpJ3juI6jHF9JMDkw2cuaP8bjkeHYVacPrWzs1SfWC2Uamu1JykOInXmn3pHYKHAygrUlecg7IBJGAeAjbQAkcDFejeGuu4XCnvBIsDZUHrBZNV1HanrrZRNS8vTZLNKlFjZW+4BlRUk7xnCd24xrOSb4bIUGoGkvmpOl/m5ynLdSnmFbsOpJxuzuIyfi7oYuaQ48w4226WnFpISvGdk9sKjNP3RYOqtUua0LZmXqYhXN1JDaQZd3rJbOc4wc8BvzF2wuskxOhloQAALFoOzLcTlt4jO6TVMQp5my7b7VWOspnHNSqwiedClmay4R27IwB3AReHJbFDoGlFx3NUJjwZLj2HXsgLSlO0NlPefZFF6x3FR7puyartIlZqSEyUqdl3wApDgSAes7t0aW2Jl2cmJa36lXHabRX3wqYKlK5tP8AqIHHiYvNXh767DGQuOpk3Wyzy2j9sknjmEU5cM9tvurCFBr+sl5TtVt232ZSmNYaQ46shCACd6lKV0lb9+D2RpNVtObksKYl5apPS+zNM84ky7pwsZO4jaPZDO2ve+kFkWUzRKdckmqSaSc7IVtvqIAKuHE4hbNb9RafeVaT4jkJmXkWAUoXMLK3FccneTgb+AhfhOIV1VWdG2IsgbkLjM8Mznf7LfUwxRx6xdd54Ly6VaeXHfs6/KU11hQlWQ4tUw4cIBxgAZHbG6mKBXNHrykqncNCamaa6S2txlZLa0kjJSpKspV2ZMa7RHUaQsysK8dSMxMSLwCXFS7hQ4OGDuIBHnMMhdd9aP3rY79FqFxSiJRxvcFJVtskDcobuIzGMWr66mrOjdEXwOsMgbjjmM7/AGRTwxPiuHWeFDOVEmi13Sa3Lopswl/Ye2W3iQVqSrZGyrzZP0xSGjwmUai0ZEm4UvCc+DPYdk5HmIzGhuOYdlpmYt+mVt2o0Vh4rlyFK2CN3SAPDhG+0euSjWrdMpXatKzM8ZQqWyywASpwpKRnJG7fDGkw91Dhr4WEvydYb89g/daHzCWcOOWxXjysvDJugyUxWZjxW43Mc1J05DiVl878vKxncCMDh8bfGz0bseracs066XEzMzLVSTHjaUSNpcu5jokJG8gEncMmIVIzFz3/AKqUq6butp9qnqVzdNQ8nEs3neC4eOMDsO+GuZS42hKHFhTiQApSRgE9sUfFat+G0MVAbEEEuA2cgeI23Od03pYRUSulvs2ea1lDqi6w4qdZZmGZENhCA+2UKWvO87JAIGO0dUbbMBJJ3nMEUmR4e64FgnTGkCxN1wYh+sl3y9k2LN1NSszbyFMSTYBKluqGBgDfuJBjd3XcVHtejvVWtTqJaWZTk5PSV3AdsUrSHl3bVHdX9RW1U6zaJlykU504VNOp3p3dZJ2eJx2xYtG8CfiNQHuH+Nu08exL8RrWwMLQfWKiesTjun3J+o9pqWhNbup41OrJ69gklPm3pTxjQciC3V1zXSnzRbUWqY2qbKsbgQUgD/zRXOrV7VLUG9py4J5Rw6rZl2RwabG5KQOA3AcIb/kpW2xpZobVb9rrPMztQbLiEqGFBAyEgf7hg+qOzEho7AqtGx0jwxuZKinKRqbdU1eqZZVtNyqEyxOeC0lW0PvEV1GWenZipVGaqc2czE48p5z/AHK3mMUVWV+u8u4rtlJB1eBkXygBEEEEa1vRBBBAhEcHMcwQLKtHk/X9LW1VX7bry+coNXy0tKhlLa1jZ+g7hFS8qrRab09uJdaozDj9sz6+cYeSMhpSt5Sfvx3YjOpIUMGLe0r1Rk0UhdkagMGp0GaHMtvObywD1K7h29W6GtDWBg6N+zcqZpJgDqgmqpx628ce0dvFLlohq7W9NqithKRUKFNHE7TnT8G6nrOOAPHqi+6FQm50OXtye60h9Dyg7ULZmDs7PWQlIJ3neAMdUQrXTk01KkomLq08WiuW658IhmWVzrrYO/CQn4w8wihKHWa/adZTOUmem6XUJc/GRlC0HsIMNpoI6iMxyNDmncVz5rnRuuMiE79m6v2/Vpo0Svk29cLK+aekZvo5X2JJ4/RFknOAeojI74U6ka52desgxSdYrVbnXkp5tusSY2Hmv9ZG8kxO7Xt64GWPDNG9UJCvU9CQpuh1B1PPBPE5yoHPq64oOJ6DNcS+jdbsPgfNOafGHNylF+1Xsk4WCSd0eChSSqXTE01JSqWZylrvSTkgj1mKyVrDP2685K6g2RW6Ipr4843LrcYPaQQn2xObZvi07kZC6TcEhMLIzzReSlz6hOYpVXhFfQgiWMgcdoy7Qm0dXBMbtcoxqFotZF2SUxsUtim1BzK0TUs2Ena/1AcYWS+9FL7oLvSork9JNZHhMmS5lPUpQwMeaHlwRjPXwiH6iW5Oz9An1U+u1iTyyo8xKup2Vk9WNknthtgWktZSPETn3aT+q5t99qjVuHxSDWaM+xIXQLemq3WWqPIpPhrjmwEObgntKj1RetzaO0rTzRys12qzAqFWeS2hkhI2GcrSDjtPHfFoUjTqmWlaUtUbHlJSdr0qUPvuOHbXNAb1I3HcTvx54pDW/Vqs31LsW6qiu0iXl5jM00reorHUewcIuTMUqcXqWMpDaJp9fccjw22O790pMEdNGTIPWOzgpBbmjtI1E0eo9fpD7dPq7SHG3eiAh7ZUR0uw7uO+KIuO3pyhV1yjT42ZxtzYKUdJJHUUnri1dEdW65Y0s/bzNGcqrExMnwVpO5YWSeHaOMXhWNO6fddoTc/fktKSlcmi4/LrQdlcrtb0oBzvI6/NGHYnVYPUvZVm8Tj6m85nhtsN/wCyBBHUxgx+0BnwS9WNonfdcf3UVyRk3cJMzOEt4T1qAwc7uqGa0/0Vse05OW26WxVJ9s7a5qZbCsq7gc4jbac23PSNAkTUK5WJzDYKZeZcGyjB3DGyDE16iQM44xTsd0lq6t5ia+zQf03F+Z2ptRYfHG3XcM+1eGtyKqlTvFx5tMs5hLoIzhA6kj6I9yjk5iNXNfln24wt2q3DINLRxZQ+lTn1QcxAzrLUbjcRK6fWPWqy47/hzjjC0sDsJynh64VUmD19cB0UZI47B3lSZKuCE3c7NXDkJBUSAlIJJPACKuvnWW36TNCi22P7RV91fNMykqdpO32Ejh9ERG57duSZaE9rLqbT6BT9kqcocg8kvKTvIwAonPq6ohFT1ws6y5J6maP2m3JPqRza6zODbfd/1AbsGLrhmgzGWfWOv2DZ9ylNRjLnZRC3apnW6AmTeRe/KErSGQj4WRtlhWSvrAKDjhuBGIovWnVqualT7TLjSafRZQbMlTWFfBtJHXjcCe/EQ6uVm4LtrZnKtOzlVqUwrG0vK1rPYAIYHQXkyVKsplrq1CV4loDfwi5aY+DddA39La+KO3Ii+xQxwMDIxZo3BJSXPdc5krQ8lHRGc1BuFqv1plyXtuQcDjjh3B9Sd4SD2ZwT5jFxco/UFmv1Bq0KA42KDTSAst8FuJGyEjuTvGI9WrOq1Pbo6bH07bEjSJdPMvTDYwFpH5KPx39cUqlKUjAhVXVocOjZ910DRvR90JFVUj1v0jh2nt4Lnu6oIIIUq6oggggWEQQQQIRBBBAhEcKAI2e2OYIFlSzTzUS5rJm0+LZsvSRPwkk8SppQ/iPURE4rNJ0T1o6VSljatyvJwXWxs7R6u1GM+uKbjjG/gNxyD15iXBWSQ5bQkuJYDSV/rOGq7iPHj/c159TeTJf9rqcnKOw3cNLTlSZiUWkkJ7wSCT5hFOIXW7fniELn6XNJO8AqaXu+iGVs7UO77UeCqXWJhbWcliYWXEHuG1nHqicO6m2HeLJltRbBk1OublTkm0kr85V0SPVDWLEYn+1kVSqzROtgzi9cdm3uVAWpyiNQ6OgS9TmpW4ZIJCRK1JhK048+M/fExlNQdDbyeKrhtWdtCqOpAcqNLcUEA9oSFH+ESupcnrSW8m1TOn17iQfxkScyraGe9SiSIqe+uTfqfbK1OMUcVmUGTz9PVziQO05AicHNeMs1XJYZYXasjSD25K6reodyNsCa0s1dkLikEoymRqagl5Xd0kpP3xtFan3lbCkS+oen09IpPRM3IYeax+ccKVuhMHGK3QJ4lbc7TZps4KhtNqSfPE+sjXfUa10iXTW3KpJE/CS1R/vCVp/NyvOBCit0fw+tzkjF+IyP7LbFWzRey5ORZd52hcsuHbfqsopxW9TX+G4D/tUAfoiqeVTYrPisXzSJZDc5JqSJ1CE7nkE42sdu/j3RD6VfukOokw2m5qW5p/Xt4aq1JVsMoJ/KUElP8DFiTdUuO2qQ7SL6eYuGy6iwpqXuKS6RbSoYHOjA3538TFYOjdThFQ2ronFwBzadtt/P+Uw6+ypj6KUWO4rV8laxWjTl31WZVK5ybUoSTa07mWwcbWO04498Wre172fbDAcuCqSiVg7mcc4vP+0AkeuK2l6xcl00lqg6fOpoVnU6XSzN3HO9ALSkAHm+O88cjEQKoXvo/p1NLVQKe5qHX8AOVSqK2mFntSCVfwjI0bqMWqXVda4taTk0bbbuSOvspo+jiFzvParLGqd7XU6tnTnTycm0JVs+F1DDTZH5ycqTujVXDQrocbVOapavU+3pBY6chTlBTyB2dFKj98URe+u+ot0IVLGsrpUiD8HLU4CXShP5uUYyIgLMtW6/Pjm2p2pTTpwFYU4pR88WejwDD6P3cQvxOZ/dL5a2eX2nK+5y/tDrMf2rbtWbu+qNA83Uao4otqPaU7QP3REbs5Q+oNYQZalzErbskRjwamsJQnHnxn749Fi8mrVC5lJcmKQmjSpwS9PqKAUnrGAYtqkcnbSWzcTeoN8JnnEjJkmVbAz2BSTk+uGxc1gzyWqKGSZ2rG0k9maVBaq5cM9lSp+qTSj17bqt/wBMXNpfyYL+upTc5WmkW9SzhRfmljaUnuAJIPnEXSnVGwrNaEppzYMpziOimcmmkpUR2hQyT64hN5al3pdhKalWnmZfOQxKnmgO4lONoeeIUuIxMyGZViotFK2exk9Rvbt7lPaRStE9EE7Mix/ai5Wx0XVjbIV9yB/GIHqRqRdN8TChUJxUrID/AA5GXOygec8T9OIhqUpByM5O8k8T547wqqK2SbLYFdcMwGkoLOaNZ3E+A3LqkAJAG4dkdoIIhp2iCCCBYRBBBAhEEEECEQQQQIRBBBAhEEEECERxHMECyui2m1kFSckcO6JZauot62wEIplfmVMIO5iYUVt47MZERaCPTXuZm02WqaGOZurI0OHaLq3Dq1bl0tmW1JsOm1RvGPCENhSge0Jwf4xo6poxolfgcNkXM5Qao4NpEpNkYz2BG7EV/HQpBORlKuopOD9IidFiUrPazVeq9FKGe5juw9mzuK0Gp/J81EsVp2dmKYahTUb/AAqU6YCe1QHxY1Wk2q9dsN5ci5/9VoEyCidpUyctOA7jgHcDjrxF02Nqfd1qOtstz3jCmJwFyM0AtBT2Drz5zG6vPTXT/WynzFWshTFvXY2Np6SdUEofPr/iN0NKetjmy2FUzFNHqrDxr+0ziPEbkv8Aqxq1XL4U3S5JsUW3JcBEpSZU7LSQOBIG4nvxG00u5PWol9NtTrFMNOpi95mproAp7Ug/Gi7bJ050/wBE6SzWLz8HuO7FjLUk0sLQyr1cMdp3Ro791Nuy73VsvTZp9L2vg5GV6CQnvI358xgqK2OHLaUYXo9VV41/ZZxPgN62dG0b0PsNIVelyquGptfHlZYjGewo35jco1ety1mjJaa2HIUxoDHhDjYSSe0pwM/TFQBIByck9pOT9MdoVyYlK72clc6TRShgsZLvPbs7gpdcmp1+XCVJn7gmGWVZ+ClSW04PURk5iH7KdtTh3rVvUo8THbEEQXPc83cbqwwwxQN1Ymho7BZcCOYII8raiCCCBYRBBBAhEEEECEQQRxmBZXMEEECwiCCCBCIIIIEIggggQiCCCBCIIIIEIggggQiOzDr0u+JiWfdl3gCA40soVjziOsECCLrlxbjrhcfedecPFbqytR9Z3xxBBAhEEEECEQQQQIRBBBAhEEEECEQQQQIRBBBAhcYgCcRzBAsr/9k=" alt="⚜" style="width:90px;height:90px;border-radius:50%;object-fit:cover;box-shadow:0 8px 40px rgba(124,107,255,.4),0 0 0 3px rgba(124,107,255,.2);animation:fadeUp .6s ease both">
    <div class="ld-name" style="font-size:38px">Перезажигал</div>
  </div>
  <div class="ld-bar-wrap"><div class="ld-bar"></div></div>
  <div class="ld-txt" id="ld-txt">Подключение...</div>
  <div class="ld-dots"><div class="ld-dot"></div><div class="ld-dot"></div><div class="ld-dot"></div></div>
</div>

<!-- AUTH -->
<div id="auth">
  <div class="auth-bg"></div>
  <div class="auth-grid"></div>
  <div class="auth-orbs"><div class="auth-orb"></div><div class="auth-orb"></div><div class="auth-orb"></div></div>
  <div class="auth-wrap">
    <div class="auth-card">
      <div style="text-align:center;margin-bottom:20px"><img src="data:image/png;base64,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" alt="⚜" style="width:72px;height:72px;border-radius:50%;object-fit:cover;box-shadow:0 8px 32px rgba(124,107,255,.45),0 0 0 3px rgba(124,107,255,.2);animation:fadeUp .5s ease both"></div></div>
      <div class="brand" style="display:none">
        <div class="brand-name" style="display:flex;align-items:center;gap:12px"><img src="data:image/png;base64,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" alt="⚜" style="width:44px;height:44px;border-radius:50%;object-fit:cover;flex-shrink:0;box-shadow:0 4px 18px rgba(124,107,255,.5)"> Перезажигал</div>
      </div>
      <div class="auth-title" id="a-title">С возвращением</div>
      <div class="auth-sub" id="a-sub">Войдите в свой аккаунт</div>
      <div class="tabs">
        <button class="tab-btn" onclick="setMode('login',this)">Войти</button>
        <button class="tab-btn on" onclick="setMode('reg',this)">Регистрация</button>
      </div>
      <div id="a-err" class="auth-err"></div>
      <div id="reg-extra">
        <div class="fld"><label>Имя</label><input class="inp" id="f-name" type="text" placeholder="Ваше имя" autocomplete="name"></div>
        <div class="fld"><label>Username</label><input class="inp" id="f-uname" type="text" placeholder="@username" autocomplete="username"></div>
      </div>
      <div class="fld"><label>Email</label><input class="inp" id="f-email" type="email" placeholder="email@example.com" autocomplete="email"></div>
      <div class="fld"><label>Пароль</label><input class="inp" id="f-pass" type="password" placeholder="Минимум 6 символов" autocomplete="current-password" onkeydown="if(event.key==='Enter')doAuth()"></div>
      <button class="btn-primary" id="a-btn" onclick="doAuth()">Зарегистрироваться →</button>
    </div>
  </div>
</div>

<!-- APP -->
<div id="app">
  <!-- SIDEBAR -->
  <div class="sidebar">
    <div class="sb-head">
      <div class="sb-brand" style="display:flex;align-items:center;gap:9px"><img src="data:image/png;base64,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" alt="⚜" style="width:30px;height:30px;border-radius:50%;object-fit:cover;flex-shrink:0;box-shadow:0 2px 10px rgba(0,0,0,.5)"> Перезажигал</div>
      <div class="sb-btns">
        <button class="ico-btn" onclick="openSearch()" title="Найти пользователя">
          <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        </button>
        <button class="ico-btn" id="adm-trigger-btn" onclick="openAdminPanel()" title="Панель администратора" style="color:#ff6b76">
          <svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z" stroke-width="1.8"/></svg>
        </button>
      </div>
    </div>
    <div class="sb-search">
      <div class="srch-wrap">
        <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        <input class="srch-inp" placeholder="Фильтр чатов..." oninput="filterChats(this.value)">
      </div>
    </div>
    <div class="filter-tabs">
      <button class="ftab on" onclick="filterTab('all',this)">Все</button>
      <button class="ftab" onclick="filterTab('unread',this)">Непрочитанные</button>
      <button class="ftab" onclick="filterTab('groups',this)">Группы</button>
    </div>
    <div class="chat-list" id="chat-list"></div>
    <div class="online-count" id="online-count">
  <div class="online-pill">
    <span class="online-pulse"></span>
    <span id="online-cnt">0</span>
    <span class="online-label">в сети</span>
  </div>
</div>
    <div class="new-chat-row" onclick="openSearch()">
      <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
      Найти собеседника
    </div>
    <!-- Footer с Discord-style статусом -->
    <div class="sb-footer">
      <div class="sb-footer-left" onclick="openProfile()">
        <div class="ava sm" id="my-ava" style="position:relative">
          <div class="presence-ring online" id="my-presence-ring"></div>
        </div>
        <div class="sb-fi">
          <div class="sb-fn" id="my-name">...</div>
          <div class="sb-ft">
            <div class="sb-status-dot online" id="my-status-dot"></div>
            <span id="my-status-txt">В сети</span>
          </div>
        </div>
      </div>
      <!-- Кнопка смены статуса -->
      <button class="ico-btn" onclick="toggleStatusMenu(event)" title="Сменить статус" id="status-menu-btn">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3" fill="currentColor"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/></svg>
      </button>
      <!-- Меню статусов -->
      <div class="status-menu" id="status-menu">
        <div class="status-opt online" onclick="setStatus('online')">
          <div class="status-opt-dot online"></div>
          <div>
            <div>В сети</div>
            <div class="status-opt-sub">Видимый и доступный</div>
          </div>
        </div>
        <div class="status-opt" onclick="setStatus('idle')">
          <div class="status-opt-dot idle"></div>
          <div>
            <div>Отсутствую</div>
            <div class="status-opt-sub">Я отошёл</div>
          </div>
        </div>
        <div class="status-opt" onclick="setStatus('dnd')">
          <div class="status-opt-dot dnd"></div>
          <div>
            <div>Не беспокоить</div>
            <div class="status-opt-sub">Уведомления отключены</div>
          </div>
        </div>
        <div class="status-opt" onclick="setStatus('invisible')">
          <div class="status-opt-dot invisible"></div>
          <div>
            <div>Невидимый</div>
            <div class="status-opt-sub">Выгляжу оффлайн</div>
          </div>
        </div>
      </div>      <button class="ico-btn" onclick="openProfile()" title="Настройки">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
      </button>
    </div>
  </div>

  <!-- MAIN -->
  <div class="main">
    <div class="empty" id="empty">
      <div class="empty-ico"><img src="data:image/png;base64,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" alt="⚜" style="width:100px;height:100px;border-radius:50%;object-fit:cover;flex-shrink:0;box-shadow:0 2px 8px rgba(0,0,0,.4)"></div>
      <h2>Добро пожаловать!</h2>
      <p style="max-width:300px;line-height:1.6;color:var(--text2)">Выберите чат слева или найдите собеседника по юзернейму</p>
      <div style="display:flex;gap:20px;margin-top:8px;opacity:.5">
        <div style="display:flex;flex-direction:column;align-items:center;gap:6px">
          <div style="width:36px;height:36px;border-radius:10px;background:rgba(124,107,255,.12);border:1px solid rgba(124,107,255,.2);display:flex;align-items:center;justify-content:center;font-size:16px">💬</div>
          <span style="font-size:11px;color:var(--text3)">Чаты</span>
        </div>
        <div style="display:flex;flex-direction:column;align-items:center;gap:6px">
          <div style="width:36px;height:36px;border-radius:10px;background:rgba(62,207,142,.08);border:1px solid rgba(62,207,142,.15);display:flex;align-items:center;justify-content:center;font-size:16px">📞</div>
          <span style="font-size:11px;color:var(--text3)">Звонки</span>
        </div>
        <div style="display:flex;flex-direction:column;align-items:center;gap:6px">
          <div style="width:36px;height:36px;border-radius:10px;background:rgba(79,195,247,.08);border:1px solid rgba(79,195,247,.15);display:flex;align-items:center;justify-content:center;font-size:16px">🔍</div>
          <span style="font-size:11px;color:var(--text3)">Поиск</span>
        </div>
      </div>
    </div>
    <div class="cv" id="cv">
      <div class="chat-hdr">
        <div class="ava" id="ch-ava" style="width:40px;height:40px;min-width:40px;font-size:15px;position:relative"></div>
        <div class="hdr-info" onclick="toggleRP()">
          <div class="hdr-name"><span class="hdr-name-txt" id="ch-name"></span><span id="ch-verified"></span></div>
          <div class="hdr-status">
            <div class="hdr-status-dot offline" id="ch-status-dot"></div>
            <span class="hdr-status-txt offline" id="ch-status-txt">Не в сети</span>
          </div>
        </div>
        <div class="hdr-acts" id="hdr-acts">
          <button class="ico-btn call-hdr-btn" onclick="startCall('audio')" title="Аудиозвонок" id="btn-call-audio"><svg viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07A19.5 19.5 0 013.07 10.6 19.79 19.79 0 01.22 2.18 2 2 0 012.22 0h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L6.09 7.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/></svg></button>
          <button class="ico-btn call-hdr-btn" onclick="startCall('video')" title="Видеозвонок" id="btn-call-video"><svg viewBox="0 0 24 24"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2"/></svg></button>
          <button class="ico-btn" onclick="toggleRP()" title="Профиль"><svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 10-16 0"/></svg></button>
          <button class="ico-btn" onclick="showChatMenu(event)" title="Ещё"><svg viewBox="0 0 24 24"><circle cx="12" cy="5" r="1" fill="currentColor"/><circle cx="12" cy="12" r="1" fill="currentColor"/><circle cx="12" cy="19" r="1" fill="currentColor"/></svg></button>
        </div>
      </div>
      <div class="pinned" id="pinned" style="display:none">
        <svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/></svg>
        <span><b>Закреплено:</b> <span id="pinned-txt">Добро пожаловать в Перезажигал!</span></span>
      </div>
      <div class="msgs" id="msgs"></div>
      <button class="scroll-btn" id="scroll-btn" onclick="scrollToBottom(true)" title="К последним сообщениям">
        <svg viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
      </button>
      <div class="typing" id="typing">
        <div class="ava xs" id="typing-ava" style="font-size:10px"></div>
        <div class="typing-dots"><div class="tdot"></div><div class="tdot"></div><div class="tdot"></div></div>
        <span class="typing-name"><span id="typing-name-txt"></span> печатает...</span>
      </div>
      <div class="ia">
        <div class="reply-bar" id="reply-bar">
          <svg viewBox="0 0 24 24" style="width:14px;height:14px;stroke:var(--accent2);fill:none;stroke-width:2;flex-shrink:0"><polyline points="9 14 4 9 9 4"/><path d="M20 20v-7a4 4 0 00-4-4H4"/></svg>
          <div class="rb2-info"><div class="rb2-who" id="rb-who"></div><div class="rb2-what" id="rb-what"></div></div>
          <button class="rb2-close" onclick="cancelReply()">×</button>
        </div>
        <div class="file-prev-bar" id="file-prev">
          <div class="fp-ico" id="fp-ico">📎</div>
          <div class="fp-info"><div class="fp-name" id="fp-name">file.pdf</div><div class="fp-size" id="fp-size">0 KB</div></div>
          <button class="fp-close" onclick="cancelFile()">×</button>
        </div>
        <div class="ir">
          <button class="att-btn" title="Прикрепить файл">
            <svg viewBox="0 0 24 24"><path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66l-9.2 9.19a2 2 0 01-2.83-2.83l8.49-8.48"/></svg>
            <input type="file" id="file-input" autocomplete="off" accept="image/*,video/*,audio/*,.pdf,.doc,.docx,.txt,.zip,.rar" onchange="onFileSelect(event)">
          </button>
          <div class="input-box">
            <textarea class="msg-ta" id="msg-inp" placeholder="Написать сообщение..." rows="1" onkeydown="msgKey(event)" oninput="autoH(this);onMsgInput(this)"></textarea>
            <span class="char-counter" id="char-counter"></span>
            <button class="emo-toggle" onclick="toggleEmo(event)" title="Эмодзи">🙂</button>
          </div>
          <button class="send-btn empty" id="send-btn" onclick="sendMsg()" title="Отправить">
            <svg viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
          </button>
        </div>
        <div class="emo-panel" id="emo-panel"></div>
      </div>
    </div>
  </div>

  <!-- RIGHT PANEL -->
  <div class="rp" id="rp">
    <!-- Фоновый меш-градиент -->
    <div class="rp-hero-bg"></div>

    <!-- ── ШАПКА ПРОФИЛЯ ── -->
    <div class="rp-head">
      <button class="rp-close-btn" onclick="hideRP()" title="Закрыть">✕</button>

      <!-- Аватар с орбитальным свечением -->
      <div class="rp-ava-wrap">
        <div class="rp-ava-glow"></div>
        <div class="rp-ava-orbit"></div>
        <div class="rp-ava" id="rp-ava">
          <div class="rp-presence-wrap" id="rp-presence-ring">
            <div class="rp-presence-dot offline" id="rp-pdot"></div>
          </div>
        </div>
      </div>

      <div class="rp-name" id="rp-name"></div>
      <div class="rp-tag" id="rp-tag"></div>
      <div class="rp-status" id="rp-status"></div>

      <div class="rp-blocked-badge" id="rp-blocked-badge">
        <svg viewBox="0 0 24 24" style="width:11px;height:11px;stroke:currentColor;fill:none;stroke-width:2.5"><circle cx="12" cy="12" r="10"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/></svg>
        Заблокирован
      </div>
    </div>

    <div class="rp-divider"></div>

    <!-- ── КНОПКИ ДЕЙСТВИЙ ── -->
    <div class="rp-acts" id="rp-acts">
      <button class="rp-act" id="rp-call-btn" onclick="startCall('audio')" title="Аудиозвонок">
        <div class="rp-act-icon">
          <svg viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07A19.5 19.5 0 013.07 10.6 19.79 19.79 0 01.22 2.18 2 2 0 012.22 0h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L6.09 7.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/></svg>
        </div>
        Звонок
      </button>
      <button class="rp-act" id="rp-video-btn" onclick="startCall('video')" title="Видеозвонок">
        <div class="rp-act-icon">
          <svg viewBox="0 0 24 24"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2"/></svg>
        </div>
        Видео
      </button>
      <button class="rp-act" id="mute-btn" onclick="toggleMute()" title="Уведомления">
        <div class="rp-act-icon">
          <svg viewBox="0 0 24 24" id="mute-icon"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"/></svg>
        </div>
        <span id="mute-lbl">Мут</span>
      </button>
    </div>

    <div class="rp-divider"></div>

    <!-- ── ИНФОРМАЦИЯ ── -->
    <div class="rp-sec">
      <div class="rp-sec-title">Информация</div>
      <div class="rp-info-card">
        <div class="rp-row">
          <div class="rp-row-icon">
            <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2M12 11a4 4 0 100-8 4 4 0 000 8z"/></svg>
          </div>
          <div class="rp-row-text">
            <span class="rp-row-label">О себе</span>
            <span class="rp-row-val" id="rp-bio">—</span>
          </div>
        </div>
        <div class="rp-row">
          <div class="rp-row-icon">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
          </div>
          <div class="rp-row-text">
            <span class="rp-row-label">Статус</span>
            <span class="rp-row-val" id="rp-seen">Не в сети</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ── МЕДИАФАЙЛЫ ── -->
    <div class="rp-sec" id="rp-media-sec">
      <div class="rp-sec-title">Медиафайлы</div>
      <div class="rp-media-empty" id="rp-media-empty">
        <svg viewBox="0 0 24 24" style="width:16px;height:16px;stroke:var(--text3);fill:none;stroke-width:2;flex-shrink:0"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
        Нет медиафайлов
      </div>
      <div class="media-grid" id="media-grid"></div>
    </div>

    <div class="rp-divider"></div>

    <!-- ── ДЕЙСТВИЯ ── -->
    <div class="rp-sec">
      <div class="rp-sec-title">Действия</div>
      <div class="rp-action-list">
        <button class="rp-action-btn danger safe" onclick="clearHistory()">
          <div class="rp-action-ico">
            <svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a1 1 0 011-1h4a1 1 0 011 1v2"/></svg>
          </div>
          Очистить историю
        </button>
        <button class="rp-action-btn danger" id="rp-block-row" onclick="showBlockModal()" style="display:none">
          <div class="rp-action-ico">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/></svg>
          </div>
          <span id="rp-block-label">Заблокировать</span>
        </button>
      </div>
    </div>

    <!-- padding bottom -->
    <div style="height:20px;flex-shrink:0"></div>
  </div>

  <!-- BLOCK CONFIRMATION MODAL -->
  <div class="block-modal" id="block-modal">
    <div class="block-modal-card">
      <div class="block-modal-ico" id="block-modal-ico">🚫</div>
      <div class="block-modal-title" id="block-modal-title">Заблокировать?</div>
      <div class="block-modal-sub" id="block-modal-sub">Этот пользователь не сможет отправлять вам сообщения и звонить.</div>
      <div class="block-modal-btns">
        <button class="block-modal-cancel" onclick="hideBlockModal()">Отмена</button>
        <button class="block-modal-confirm" id="block-modal-confirm" onclick="confirmBlock()">Заблокировать</button>
      </div>
    </div>
  </div>
</div>

<!-- CALL OVERLAY -->
<div class="overlay" id="call-overlay" style="padding:10px">
  <div class="call-modal" id="call-modal-inner">
    <!-- toolbar: свернуть/развернуть/демо экрана -->
    <div class="call-toolbar">
      <button class="ct-btn" id="ct-sharescreen" onclick="toggleScreenShare()" title="Демонстрация экрана">
        <svg viewBox="0 0 24 24"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/><path d="M9 8l3-3 3 3M12 5v8" stroke-width="1.8"/></svg>
      </button>
      <button class="ct-btn" id="ct-expand" onclick="toggleCallExpand()" title="Развернуть">
        <svg viewBox="0 0 24 24" id="expand-icon"><path d="M8 3H5a2 2 0 00-2 2v3M21 8V5a2 2 0 00-2-2h-3M3 16v3a2 2 0 002 2h3M16 21h3a2 2 0 002-2v-3"/></svg>
      </button>
    </div>
    <!-- screen share area -->
    <div class="screen-share-area" id="screen-share-area">
      <video id="screen-share-video" autoplay playsinline></video>
      <div class="screen-share-label">
        <svg viewBox="0 0 24 24" width="12" height="12" style="stroke:white;fill:none;stroke-width:2"><rect x="2" y="3" width="20" height="14" rx="2"/></svg>
        Демонстрация экрана
      </div>
    </div>
    <!-- remote video -->
    <div class="call-video-area" id="call-video-area">
      <video id="call-remote-video-el" autoplay playsinline></video>
    </div>
    <!-- local pip -->
    <div class="call-local-video" id="call-local-video">
      <video id="call-local-video-el" autoplay playsinline muted></video>
    </div>
    <div class="rtc-status" id="rtc-status">Подключение...</div>
    <div class="call-ava" id="call-ava"></div>
    <div class="call-name" id="call-name"></div>
    <div class="call-sub" id="call-sub">Вызов...</div>
    <div class="call-timer" id="call-timer">0:00</div>
    <div class="call-btns">
      <button class="call-btn mute" id="cbtn-mute" data-m="0" onclick="toggleCallMute()"><svg viewBox="0 0 24 24"><path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"/><path d="M19 10v2a7 7 0 01-14 0v-2M12 19v4M8 23h8"/></svg></button>
      <button class="call-btn share" id="cbtn-share2" onclick="toggleScreenShare()" title="Демо экрана">
        <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:white;fill:none;stroke-width:2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
      </button>
      <button class="call-btn end" onclick="endCall()"><svg viewBox="0 0 24 24"><path d="M10.68 13.31a16 16 0 003.41 2.6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7 2 2 0 011.72 2v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.42 19.42 0 01-3.33-2.67m-2.67-3.34a19.79 19.79 0 01-3.07-8.63A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91M23 1L1 23" stroke="white"/></svg></button>
      <button class="call-btn spk" id="cbtn-spk" data-off="0" onclick="toggleSpeaker()"><svg viewBox="0 0 24 24"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path id="spk-path" d="M19.07 4.93a10 10 0 010 14.14M15.54 8.46a5 5 0 010 7.07"/></svg></button>
      <button class="call-btn" id="cbtn-cam" data-off="0" onclick="toggleCamera()" style="background:var(--surface2)" title="Камера">
        <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:white;fill:none;stroke-width:2"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2"/></svg>
      </button>
    </div>
  </div>
</div>

<!-- INCOMING CALL -->
<div class="overlay" id="inc-overlay">
  <div class="inc-call-modal">
    <div class="call-ava" id="inc-ava" style="margin:0 auto 16px"></div>
    <div class="call-name" id="inc-name"></div>
    <div class="call-sub" id="inc-sub">Входящий звонок 📞</div>
    <div class="inc-btns">
      <button class="inc-btn accept" onclick="acceptCall()">📞</button>
      <button class="inc-btn decline" onclick="declineCall()">📵</button>
    </div>
  </div>
</div>

<!-- SEARCH -->
<div class="srch-overlay" id="srch-overlay" onclick="srchBg(event)">
  <div class="srch-modal">
    <div class="sm-top">
      <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input id="srch-inp" placeholder="Поиск по имени или @username..." oninput="doSearch(this.value)">
      <button style="background:none;border:none;color:var(--text3);cursor:pointer;font-size:18px" onclick="closeSearch()">×</button>
    </div>
    <div class="sm-results" id="sm-results"></div>
  </div>
</div>

<!-- PROFILE MODAL -->
<div class="pm-overlay" id="pm-overlay">
  <div class="pm-modal">
    <!-- Top bar -->
    <div class="pm-head">
      <h2 style="display:flex;align-items:center;gap:9px;font-size:16px;font-weight:800;font-family:'Syne',sans-serif">
        <span style="width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,rgba(124,107,255,.3),rgba(79,195,247,.15));display:inline-flex;align-items:center;justify-content:center;font-size:14px">⚙️</span>
        Настройки
      </h2>
      <button class="ico-btn" onclick="closeProfile()"><svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
    </div>

    <div class="pm-body">
      <!-- Tabs -->
      <div class="pm-tabs">
        <button class="pm-tab on" onclick="pmSwitchTab('profile',this)">
          <span class="pm-tab-ico">👤</span>Профиль
        </button>
        <button class="pm-tab" onclick="pmSwitchTab('looks',this)">
          <span class="pm-tab-ico">🎨</span>Вид
        </button>
        <button class="pm-tab" onclick="pmSwitchTab('effects',this)">
          <span class="pm-tab-ico">✨</span>Эффекты
        </button>
        <button class="pm-tab" onclick="pmSwitchTab('status',this)">
          <span class="pm-tab-ico">🟢</span>Статус
        </button>
        <button class="pm-tab" onclick="pmSwitchTab('privacy',this)">
          <span class="pm-tab-ico">🔒</span>Конф.
        </button>
      </div>

      <!-- ══════════ TAB: PROFILE ══════════ -->
      <div class="pm-pane on" id="pm-pane-profile">

        <!-- Live preview -->
        <div class="pm-preview" id="pm-preview">
          <div class="pm-preview-ava" id="pm-prev-ava"></div>
          <div>
            <div class="pm-preview-name" id="pm-prev-name">Имя</div>
            <div class="pm-preview-tag" id="pm-prev-tag">@username</div>
            <div class="pm-preview-badge" id="pm-prev-badge" style="display:none"></div>
          </div>
        </div>

        <!-- Avatar -->
        <div class="pm-sec-hdr">Аватар</div>
        <div class="pm-ava-row">
          <div class="pm-ava" id="pm-ava">
            <div class="pm-ava-over">📷<input type="file" accept="image/*" onchange="onAvaUpload(event)"></div>
          </div>
          <div class="pm-ava-ctrl">
            <div class="pm-ava-ctrl-title">Цвет фона</div>
            <div class="color-picks" id="color-picks"></div>
            <div class="pm-ava-ctrl-title" style="margin-top:8px">Эмодзи</div>
            <div class="emo-grid-sm" id="pm-emo-grid"></div>
            <div style="display:flex;gap:6px;margin-top:6px;flex-wrap:wrap">
              <button class="pm-clear-btn" onclick="clearEmoAva()">✕ Убрать</button>
              <button class="pm-upload-btn">📷 Фото<input type="file" accept="image/*" onchange="onAvaUpload(event)"></button>
            </div>
          </div>
        </div>

        <!-- Fields -->
        <div class="pm-sec-hdr" style="margin-top:4px">Данные</div>
        <div class="fld"><label>Имя</label><input class="inp" id="pm-name" type="text" oninput="pmUpdatePreview()"></div>
        <div class="fld">
          <label>Username <span id="uname-cd" style="font-size:10px;color:var(--yellow);font-weight:400;text-transform:none;letter-spacing:0"></span></label>
          <input class="inp" id="pm-uname" type="text" oninput="pmUpdatePreview()">
        </div>
        <div class="fld"><label>О себе</label><input class="inp" id="pm-bio" type="text" placeholder="Расскажите о себе..."></div>
        <div class="fld"><label>Email</label><input class="inp" id="pm-email" readonly style="opacity:.45;cursor:not-allowed"></div>
      </div>

      <!-- ══════════ TAB: LOOKS ══════════ -->
      <div class="pm-pane" id="pm-pane-looks">

        <!-- App Theme -->
        <div class="pm-sec-hdr">Тема приложения</div>
        <div class="theme-grid" id="app-theme-picks">
          <div class="theme-opt on" onclick="setAppTheme('',this)" data-theme="">
            <div class="theme-swatch" style="background:linear-gradient(135deg,#07080e,#161928,#7c6bff)"></div>
            <span>Midnight</span>
          </div>
          <div class="theme-opt" onclick="setAppTheme('nord',this)" data-theme="nord">
            <div class="theme-swatch" style="background:linear-gradient(135deg,#1a1e2e,#24283b,#7aa2f7)"></div>
            <span>Nord</span>
          </div>
          <div class="theme-opt" onclick="setAppTheme('dracula',this)" data-theme="dracula">
            <div class="theme-swatch" style="background:linear-gradient(135deg,#1a1625,#2a2640,#bd93f9)"></div>
            <span>Dracula</span>
          </div>
          <div class="theme-opt" onclick="setAppTheme('forest',this)" data-theme="forest">
            <div class="theme-swatch" style="background:linear-gradient(135deg,#0e1a12,#1a2b1e,#4ade80)"></div>
            <span>Forest</span>
          </div>
          <div class="theme-opt" onclick="setAppTheme('abyss',this)" data-theme="abyss">
            <div class="theme-swatch" style="background:linear-gradient(135deg,#000,#0a0a10,#7c6bff)"></div>
            <span>Abyss</span>
          </div>
          <div class="theme-opt" onclick="setAppTheme('sunset',this)" data-theme="sunset">
            <div class="theme-swatch" style="background:linear-gradient(135deg,#120c0e,#261420,#fb923c)"></div>
            <span>Sunset</span>
          </div>
          <div class="theme-opt" onclick="setAppTheme('matrix',this)" data-theme="matrix">
            <div class="theme-swatch" style="background:linear-gradient(135deg,#000,#001a0a,#00ff41)"></div>
            <span>Matrix</span>
          </div>
        </div>

        <!-- Font size -->
        <div class="pm-sec-hdr">Размер шрифта</div>
        <div style="display:flex;gap:8px;margin-bottom:18px" id="font-size-picks">
          <button onclick="setFontSize('sm',this)" class="fs-btn" data-fs="sm" style="flex:1;padding:9px;border-radius:10px;border:2px solid transparent;background:var(--surface2);color:var(--text3);font-size:11px;font-weight:700;cursor:pointer;transition:.18s;font-family:'Manrope',sans-serif">A<span style="font-size:8px">A</span> Мелкий</button>
          <button onclick="setFontSize('md',this)" class="fs-btn on" data-fs="md" style="flex:1;padding:9px;border-radius:10px;border:2px solid var(--accent);background:rgba(124,107,255,.12);color:var(--accent2);font-size:13px;font-weight:700;cursor:pointer;transition:.18s;font-family:'Manrope',sans-serif">A Обычный</button>
          <button onclick="setFontSize('lg',this)" class="fs-btn" data-fs="lg" style="flex:1;padding:9px;border-radius:10px;border:2px solid transparent;background:var(--surface2);color:var(--text3);font-size:14px;font-weight:700;cursor:pointer;transition:.18s;font-family:'Manrope',sans-serif">A Крупный</button>
          <button onclick="setFontSize('xl',this)" class="fs-btn" data-fs="xl" style="flex:1;padding:9px;border-radius:10px;border:2px solid transparent;background:var(--surface2);color:var(--text3);font-size:16px;font-weight:700;cursor:pointer;transition:.18s;font-family:'Manrope',sans-serif">A Огромный</button>
        </div>

        <!-- Accent color -->
        <div class="pm-sec-hdr">Акцентный цвет</div>
        <div style="display:grid;grid-template-columns:repeat(7,1fr);gap:7px;margin-bottom:18px" id="accent-picks">
          <button onclick="setAccent('#7c6bff',this)" class="accent-pick" style="aspect-ratio:1;border-radius:50%;background:#7c6bff;border:2.5px solid rgba(255,255,255,.35);cursor:pointer;transition:.2s" title="Фиолетовый"></button>
          <button onclick="setAccent('#4fc3f7',this)" class="accent-pick" style="aspect-ratio:1;border-radius:50%;background:#4fc3f7;border:2.5px solid transparent;cursor:pointer;transition:.2s" title="Голубой"></button>
          <button onclick="setAccent('#3ecf8e',this)" class="accent-pick" style="aspect-ratio:1;border-radius:50%;background:#3ecf8e;border:2.5px solid transparent;cursor:pointer;transition:.2s" title="Зелёный"></button>
          <button onclick="setAccent('#ff8c42',this)" class="accent-pick" style="aspect-ratio:1;border-radius:50%;background:#ff8c42;border:2.5px solid transparent;cursor:pointer;transition:.2s" title="Оранжевый"></button>
          <button onclick="setAccent('#ec4899',this)" class="accent-pick" style="aspect-ratio:1;border-radius:50%;background:#ec4899;border:2.5px solid transparent;cursor:pointer;transition:.2s" title="Розовый"></button>
          <button onclick="setAccent('#ffc948',this)" class="accent-pick" style="aspect-ratio:1;border-radius:50%;background:#ffc948;border:2.5px solid transparent;cursor:pointer;transition:.2s" title="Жёлтый"></button>
          <button onclick="setAccent('#ff6b76',this)" class="accent-pick" style="aspect-ratio:1;border-radius:50%;background:#ff6b76;border:2.5px solid transparent;cursor:pointer;transition:.2s" title="Красный"></button>
        </div>

        <!-- Avatar ring style -->
        <div class="pm-sec-hdr">Обводка аватара</div>
        <div class="ava-ring-grid" id="ava-ring-picks">
          <div class="ava-ring-opt on" onclick="setAvaRing('orbit',this)" data-ring="orbit">
            <div class="ava-ring-preview" style="box-shadow:none">
              <div class="arp-inner"></div>
              <div style="position:absolute;inset:-3px;border-radius:50%;border:1.5px dashed rgba(124,107,255,.6)"></div>
              <div style="position:absolute;top:-5px;left:50%;width:5px;height:5px;border-radius:50%;background:#7c6bff;transform:translateX(-50%)"></div>
            </div>
            <span>Орбита</span>
          </div>
          <div class="ava-ring-opt" onclick="setAvaRing('solid',this)" data-ring="solid">
            <div class="ava-ring-preview" style="box-shadow:none">
              <div class="arp-inner"></div>
              <div style="position:absolute;inset:-3px;border-radius:50%;border:2px solid rgba(124,107,255,.8)"></div>
            </div>
            <span>Линия</span>
          </div>
          <div class="ava-ring-opt" onclick="setAvaRing('gradient',this)" data-ring="gradient">
            <div class="ava-ring-preview" style="box-shadow:none">
              <div class="arp-inner"></div>
              <div style="position:absolute;inset:-3px;border-radius:50%;background:conic-gradient(#7c6bff,#4fc3f7,#7c6bff);padding:2px;-webkit-mask:linear-gradient(#fff 0 0) padding-box,linear-gradient(#fff 0 0);-webkit-mask-composite:destination-out;mask-composite:exclude"></div>
            </div>
            <span>Радуга</span>
          </div>
          <div class="ava-ring-opt" onclick="setAvaRing('neon',this)" data-ring="neon">
            <div class="ava-ring-preview" style="box-shadow:0 0 12px rgba(124,107,255,.6)">
              <div class="arp-inner"></div>
              <div style="position:absolute;inset:-3px;border-radius:50%;border:2px solid rgba(124,107,255,.9)"></div>
            </div>
            <span>Неон</span>
          </div>
          <div class="ava-ring-opt" onclick="setAvaRing('pulse',this)" data-ring="pulse">
            <div class="ava-ring-preview" style="box-shadow:none">
              <div class="arp-inner"></div>
              <div style="position:absolute;inset:-3px;border-radius:50%;border:2px solid rgba(124,107,255,.7);animation:neonPulse 1.5s ease-in-out infinite"></div>
            </div>
            <span>Пульс</span>
          </div>
          <div class="ava-ring-opt" onclick="setAvaRing('double',this)" data-ring="double">
            <div class="ava-ring-preview" style="box-shadow:none">
              <div class="arp-inner"></div>
              <div style="position:absolute;inset:-3px;border-radius:50%;border:1.5px solid rgba(124,107,255,.7)"></div>
              <div style="position:absolute;inset:-7px;border-radius:50%;border:1px solid rgba(124,107,255,.3)"></div>
            </div>
            <span>Двойная</span>
          </div>
          <div class="ava-ring-opt" onclick="setAvaRing('none',this)" data-ring="none">
            <div class="ava-ring-preview" style="box-shadow:none">
              <div class="arp-inner"></div>
            </div>
            <span>Нет</span>
          </div>
        </div>

        <!-- Name style -->
        <div class="pm-sec-hdr">Стиль имени</div>
        <div class="name-style-grid" id="name-style-picks">
          <div class="name-style-opt ns-white on" onclick="setNameStyle('white',this)" data-ns="white">Обычный</div>
          <div class="name-style-opt ns-accent" onclick="setNameStyle('accent',this)" data-ns="accent">Акцент</div>
          <div class="name-style-opt ns-gold" onclick="setNameStyle('gold',this)" data-ns="gold">Золото</div>
          <div class="name-style-opt ns-fire" onclick="setNameStyle('fire',this)" data-ns="fire">Огонь</div>
          <div class="name-style-opt ns-ice" onclick="setNameStyle('ice',this)" data-ns="ice">Лёд</div>
          <div class="name-style-opt ns-neon" onclick="setNameStyle('neon',this)" data-ns="neon">Неон</div>
        </div>

        <!-- Bubble theme -->
        <div class="pm-sec-hdr">Пузыри сообщений</div>
        <div class="bubble-theme-grid" id="bubble-theme-picks">
          <div class="bubble-theme-opt on" onclick="setBubbleTheme('default',this)">
            <div class="bt-preview" style="background:linear-gradient(135deg,#7c6bff,#a695ff)"></div>
            <span>Дефолт</span>
          </div>
          <div class="bubble-theme-opt" onclick="setBubbleTheme('emerald',this)">
            <div class="bt-preview" style="background:linear-gradient(135deg,#10b981,#34d399)"></div>
            <span>Изумруд</span>
          </div>
          <div class="bubble-theme-opt" onclick="setBubbleTheme('sunset',this)">
            <div class="bt-preview" style="background:linear-gradient(135deg,#f59e0b,#ef4444)"></div>
            <span>Закат</span>
          </div>
          <div class="bubble-theme-opt" onclick="setBubbleTheme('ocean',this)">
            <div class="bt-preview" style="background:linear-gradient(135deg,#0ea5e9,#6366f1)"></div>
            <span>Океан</span>
          </div>
          <div class="bubble-theme-opt" onclick="setBubbleTheme('rose',this)">
            <div class="bt-preview" style="background:linear-gradient(135deg,#ec4899,#f43f5e)"></div>
            <span>Роза</span>
          </div>
          <div class="bubble-theme-opt" onclick="setBubbleTheme('mono',this)">
            <div class="bt-preview" style="background:linear-gradient(135deg,#334155,#475569)"></div>
            <span>Моно</span>
          </div>
          <div class="bubble-theme-opt" onclick="setBubbleTheme('gold',this)">
            <div class="bt-preview" style="background:linear-gradient(135deg,#d97706,#f59e0b)"></div>
            <span>Золото</span>
          </div>
          <div class="bubble-theme-opt" onclick="setBubbleTheme('cyber',this)">
            <div class="bt-preview" style="background:linear-gradient(135deg,#06b6d4,#10b981)"></div>
            <span>Кибер</span>
          </div>
        </div>

        <!-- Chat background -->
        <div class="pm-sec-hdr">Фон чата</div>
        <div class="chat-bg-grid" id="chat-bg-picks">
          <div class="chat-bg-opt on" onclick="setChatBg('default',this)" style="background:#07080e"></div>
          <div class="chat-bg-opt" onclick="setChatBg('dots',this)" style="background:#07080e;background-image:radial-gradient(rgba(255,255,255,.06) 1px,transparent 1px);background-size:20px 20px"></div>
          <div class="chat-bg-opt" onclick="setChatBg('grid',this)" style="background:#07080e;background-image:linear-gradient(rgba(255,255,255,.04) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.04) 1px,transparent 1px);background-size:24px 24px"></div>
          <div class="chat-bg-opt" onclick="setChatBg('diagonal',this)" style="background:repeating-linear-gradient(45deg,#07080e,#07080e 10px,#0c0e18 10px,#0c0e18 20px)"></div>
          <div class="chat-bg-opt" onclick="setChatBg('purple',this)" style="background:radial-gradient(ellipse at 30% 70%,rgba(124,107,255,.12) 0%,#07080e 60%)"></div>
          <div class="chat-bg-opt" onclick="setChatBg('teal',this)" style="background:radial-gradient(ellipse at 70% 30%,rgba(79,195,247,.1) 0%,#07080e 60%)"></div>
          <div class="chat-bg-opt" onclick="setChatBg('midnight',this)" style="background:linear-gradient(180deg,#0a0a1a,#070810)"></div>
          <div class="chat-bg-opt" onclick="setChatBg('void',this)" style="background:#000"></div>
        </div>

        <!-- Compact mode -->
        <div class="pm-sec-hdr">Интерфейс</div>
        <div class="pm-setting-row">
          <div class="pm-setting-left">
            <div class="pm-setting-ico">📐</div>
            <div class="pm-setting-info">
              <div class="pm-setting-name">Компактный режим</div>
              <div class="pm-setting-desc">Уменьшает отступы и размеры</div>
            </div>
          </div>
          <label class="pm-toggle"><input type="checkbox" id="compact-mode" onchange="toggleCompact(this.checked)"><span class="pm-toggle-track"></span></label>
        </div>
      </div>

      <!-- ══════════ TAB: EFFECTS ══════════ -->
      <div class="pm-pane" id="pm-pane-effects">
        <div class="pm-sec-hdr">Визуальные эффекты</div>
        <div class="fx-grid" id="fx-picks">
          <div class="fx-opt on" onclick="setEffect('none',this)" data-fx="none">
            <div class="fx-ico">🚫</div><span>Нет</span>
          </div>
          <div class="fx-opt" onclick="setEffect('snow',this)" data-fx="snow">
            <div class="fx-ico">❄️</div><span>Снег</span>
          </div>
          <div class="fx-opt" onclick="setEffect('stars',this)" data-fx="stars">
            <div class="fx-ico">✨</div><span>Звёзды</span>
          </div>
          <div class="fx-opt" onclick="setEffect('bubbles',this)" data-fx="bubbles">
            <div class="fx-ico">🫧</div><span>Пузыри</span>
          </div>
          <div class="fx-opt" onclick="setEffect('fire',this)" data-fx="fire">
            <div class="fx-ico">🔥</div><span>Огонь</span>
          </div>
          <div class="fx-opt" onclick="setEffect('rain',this)" data-fx="rain">
            <div class="fx-ico">🌧️</div><span>Дождь</span>
          </div>
          <div class="fx-opt" onclick="setEffect('aurora',this)" data-fx="aurora">
            <div class="fx-ico">🌌</div><span>Аврора</span>
          </div>
          <div class="fx-opt" onclick="setEffect('hearts',this)" data-fx="hearts">
            <div class="fx-ico">💜</div><span>Сердечки</span>
          </div>
        </div>

        <div class="pm-sec-hdr">Интенсивность</div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:18px">
          <span style="font-size:12px;color:var(--text3)">Слабо</span>
          <input type="range" id="fx-intensity" min="20" max="100" value="60" oninput="setFxIntensity(this.value)" style="flex:1;accent-color:var(--accent)">
          <span style="font-size:12px;color:var(--text3)">Ярко</span>
        </div>

        <div class="pm-sec-hdr">Звук печатания</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px" id="type-sound-picks">
          <button onclick="setTypeSound('none',this)" class="type-snd-btn on" data-ts="none" style="padding:8px 14px;border-radius:10px;border:2px solid var(--accent);background:rgba(124,107,255,.12);color:var(--accent2);font-size:12px;font-weight:700;cursor:pointer;transition:.18s;font-family:'Manrope',sans-serif">🔇 Нет</button>
          <button onclick="setTypeSound('soft',this)" class="type-snd-btn" data-ts="soft" style="padding:8px 14px;border-radius:10px;border:2px solid transparent;background:var(--surface2);color:var(--text3);font-size:12px;font-weight:700;cursor:pointer;transition:.18s;font-family:'Manrope',sans-serif">🎹 Мягкий</button>
          <button onclick="setTypeSound('click',this)" class="type-snd-btn" data-ts="click" style="padding:8px 14px;border-radius:10px;border:2px solid transparent;background:var(--surface2);color:var(--text3);font-size:12px;font-weight:700;cursor:pointer;transition:.18s;font-family:'Manrope',sans-serif">⌨️ Клик</button>
          <button onclick="setTypeSound('pop',this)" class="type-snd-btn" data-ts="pop" style="padding:8px 14px;border-radius:10px;border:2px solid transparent;background:var(--surface2);color:var(--text3);font-size:12px;font-weight:700;cursor:pointer;transition:.18s;font-family:'Manrope',sans-serif">🫧 Поп</button>
        </div>

        <div class="pm-sec-hdr">Конфетти при отправке</div>
        <div class="pm-setting-row">
          <div class="pm-setting-left">
            <div class="pm-setting-ico">🎉</div>
            <div class="pm-setting-info">
              <div class="pm-setting-name">Конфетти на отправку</div>
              <div class="pm-setting-desc">Мини-взрыв при отправке сообщения</div>
            </div>
          </div>
          <label class="pm-toggle"><input type="checkbox" id="confetti-send" onchange="COSM.confettiOnSend=this.checked;localStorage.setItem('pz_confetti',this.checked?'1':'0')"><span class="pm-toggle-track"></span></label>
        </div>
      </div>

      <!-- ══════════ TAB: STATUS ══════════ -->
      <div class="pm-pane" id="pm-pane-status">
        <div class="pm-sec-hdr">Статус присутствия</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:20px">
          <button onclick="setStatusQuick('online')" class="status-pick-btn" style="padding:12px 14px;border-radius:12px;border:1px solid rgba(62,207,142,.25);background:rgba(62,207,142,.08);color:var(--text);font-size:12.5px;font-weight:700;cursor:pointer;display:flex;align-items:center;gap:10px;transition:.2s;font-family:'Manrope',sans-serif">
            <span style="width:10px;height:10px;border-radius:50%;background:#3ecf8e;box-shadow:0 0 8px #3ecf8e;flex-shrink:0"></span> В сети
          </button>
          <button onclick="setStatusQuick('idle')" style="padding:12px 14px;border-radius:12px;border:1px solid rgba(255,201,72,.2);background:rgba(255,201,72,.07);color:var(--text);font-size:12.5px;font-weight:700;cursor:pointer;display:flex;align-items:center;gap:10px;transition:.2s;font-family:'Manrope',sans-serif">
            <span style="font-size:14px">🌙</span> Отошёл
          </button>
          <button onclick="setStatusQuick('dnd')" style="padding:12px 14px;border-radius:12px;border:1px solid rgba(255,107,118,.2);background:rgba(255,107,118,.07);color:var(--text);font-size:12.5px;font-weight:700;cursor:pointer;display:flex;align-items:center;gap:10px;transition:.2s;font-family:'Manrope',sans-serif">
            <span style="width:10px;height:4px;border-radius:3px;background:#ff6b76;display:inline-block;flex-shrink:0"></span> Не беспокоить
          </button>
          <button onclick="setStatusQuick('invisible')" style="padding:12px 14px;border-radius:12px;border:1px solid rgba(68,77,110,.35);background:rgba(68,77,110,.12);color:var(--text);font-size:12.5px;font-weight:700;cursor:pointer;display:flex;align-items:center;gap:10px;transition:.2s;font-family:'Manrope',sans-serif">
            <span style="width:10px;height:10px;border-radius:50%;border:2px solid #444d6e;display:inline-block;flex-shrink:0"></span> Невидимка
          </button>
        </div>

        <div class="pm-sec-hdr">Пользовательский статус</div>
        <div style="margin-bottom:8px">
          <input class="status-badge-inp" id="pm-custom-status" placeholder="🎮 Играю в игры..." maxlength="60">
        </div>
        <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:18px" id="status-presets">
          <button onclick="setCustomStatusPreset('🎮 Играю')" style="padding:5px 10px;border-radius:20px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.04);color:var(--text2);font-size:11px;cursor:pointer;transition:.15s;font-family:'Manrope',sans-serif">🎮 Играю</button>
          <button onclick="setCustomStatusPreset('🎧 Слушаю музыку')" style="padding:5px 10px;border-radius:20px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.04);color:var(--text2);font-size:11px;cursor:pointer;transition:.15s;font-family:'Manrope',sans-serif">🎧 Музыка</button>
          <button onclick="setCustomStatusPreset('💻 Работаю')" style="padding:5px 10px;border-radius:20px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.04);color:var(--text2);font-size:11px;cursor:pointer;transition:.15s;font-family:'Manrope',sans-serif">💻 Работаю</button>
          <button onclick="setCustomStatusPreset('😴 Сплю')" style="padding:5px 10px;border-radius:20px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.04);color:var(--text2);font-size:11px;cursor:pointer;transition:.15s;font-family:'Manrope',sans-serif">😴 Сплю</button>
          <button onclick="setCustomStatusPreset('')" style="padding:5px 10px;border-radius:20px;border:1px solid rgba(255,107,118,.2);background:rgba(255,107,118,.06);color:var(--red);font-size:11px;cursor:pointer;transition:.15s;font-family:'Manrope',sans-serif">✕ Убрать</button>
        </div>

        <div class="pm-sec-hdr">Уведомления</div>
        <div class="pm-setting-row">
          <div class="pm-setting-left">
            <div class="pm-setting-ico">🔊</div>
            <div class="pm-setting-info">
              <div class="pm-setting-name">Звук сообщений</div>
              <div class="pm-setting-desc">Звук при получении сообщения</div>
            </div>
          </div>
          <label class="pm-toggle"><input type="checkbox" id="snd-msg" checked><span class="pm-toggle-track"></span></label>
        </div>
        <div class="pm-setting-row">
          <div class="pm-setting-left">
            <div class="pm-setting-ico">📞</div>
            <div class="pm-setting-info">
              <div class="pm-setting-name">Звук звонков</div>
              <div class="pm-setting-desc">Рингтон при входящем звонке</div>
            </div>
          </div>
          <label class="pm-toggle"><input type="checkbox" id="snd-call" checked><span class="pm-toggle-track"></span></label>
        </div>
        <div class="pm-setting-row">
          <div class="pm-setting-left">
            <div class="pm-setting-ico">🌐</div>
            <div class="pm-setting-info">
              <div class="pm-setting-name">Push-уведомления</div>
              <div class="pm-setting-desc">Уведомления браузера</div>
            </div>
          </div>
          <label class="pm-toggle"><input type="checkbox" id="notif-browser" onchange="toggleBrowserNotifs(this.checked)"><span class="pm-toggle-track"></span></label>
        </div>
      </div>

      <!-- ══════════ TAB: PRIVACY ══════════ -->
      <div class="pm-pane" id="pm-pane-privacy">
        <div class="pm-sec-hdr">Приватность</div>
        <div class="pm-setting-row">
          <div class="pm-setting-left">
            <div class="pm-setting-ico">✅</div>
            <div class="pm-setting-info">
              <div class="pm-setting-name">Квитанции о прочтении</div>
              <div class="pm-setting-desc">Собеседник видит, что вы прочли</div>
            </div>
          </div>
          <label class="pm-toggle"><input type="checkbox" id="read-receipts" checked><span class="pm-toggle-track"></span></label>
        </div>
        <div class="pm-setting-row">
          <div class="pm-setting-left">
            <div class="pm-setting-ico">⌨️</div>
            <div class="pm-setting-info">
              <div class="pm-setting-name">Статус печати</div>
              <div class="pm-setting-desc">Показывать «печатает...»</div>
            </div>
          </div>
          <label class="pm-toggle"><input type="checkbox" id="typing-status" checked><span class="pm-toggle-track"></span></label>
        </div>
        <div class="pm-setting-row">
          <div class="pm-setting-left">
            <div class="pm-setting-ico">👁️</div>
            <div class="pm-setting-info">
              <div class="pm-setting-name">Показывать онлайн</div>
              <div class="pm-setting-desc">Виден ли ваш статус другим</div>
            </div>
          </div>
          <label class="pm-toggle"><input type="checkbox" id="show-online" checked><span class="pm-toggle-track"></span></label>
        </div>

        <div class="pm-sec-hdr" style="margin-top:16px">Безопасность</div>
        <div style="padding:14px;background:rgba(255,107,118,.05);border:1px solid rgba(255,107,118,.12);border-radius:12px;margin-bottom:8px">
          <div style="font-size:12.5px;color:var(--text2);margin-bottom:10px">Аккаунт: <span style="color:var(--text);font-weight:600" id="pm-acct-name">—</span></div>
          <div style="display:flex;gap:8px">
            <button onclick="doLogout()" style="flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,107,118,.3);background:rgba(255,107,118,.08);color:var(--red);font-size:12px;font-weight:700;cursor:pointer;font-family:'Manrope',sans-serif;transition:.15s">🚪 Выйти из аккаунта</button>
          </div>
        </div>
      </div>
    </div>

    <div class="pm-foot">
      <button class="btn-ghost" onclick="closeProfile()">Закрыть</button>
      <button class="btn-save" onclick="saveProfile()">💾 Сохранить</button>
    </div>
  </div>
</div>

<!-- ═══════════ BAN SCREEN ═══════════ -->
<div id="ban-screen">
  <div class="bs-particles" id="bs-particles"></div>
  <div class="bs-grid"></div>
  <div class="bs-glow"></div>
  <div class="bs-card">
    <div class="bs-shield">🚫</div>
    <div class="bs-title">Аккаунт заблокирован</div>
    <div class="bs-subtitle">Вы получили бан на платформе</div>
    <div class="bs-divider"></div>
    <div class="bs-reason-card">
      <div class="bs-reason-label">Причина блокировки</div>
      <div class="bs-reason-text" id="bs-reason-text">Нарушение правил платформы</div>
    </div>
    <div class="bs-until" id="bs-until-wrap">Навсегда</div>
    <div class="bs-id" id="bs-id-wrap"></div>
    <div id="bs-countdown" style="display:none">0<span>с до перенаправления</span></div>
    <button class="bs-btn" onclick="location.reload()">↩ Вернуться на главную</button>
    <div style="margin-top:12px;font-size:10px;color:rgba(255,255,255,.1)">perezazhigal.ru · Служба поддержки: @boss</div>
  </div>
</div>

<!-- ═══════════ KICK SCREEN ═══════════ -->
<div id="kick-screen">
  <div class="ks-card">
    <div class="ks-icon">👢</div>
    <div class="ks-title">Вас кикнул администратор</div>
    <div class="ks-reason" id="ks-reason-text">Нарушение правил</div>
    <button class="ks-btn" onclick="location.reload()">↩ Войти снова</button>
  </div>
</div>

<!-- CTX MENU -->
<div class="ctx" id="ctx">
  <div class="ctx-item" onclick="ctxDo('reply')"><svg viewBox="0 0 24 24"><polyline points="9 14 4 9 9 4"/><path d="M20 20v-7a4 4 0 00-4-4H4"/></svg>Ответить</div>
  <div class="ctx-item" onclick="ctxDo('copy')"><svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>Копировать</div>
  <div class="ctx-item" id="ctx-pin-btn" onclick="ctxDo('pin')"><svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/></svg>Закрепить</div>
  <div class="ctx-sep"></div>
  <div class="ctx-item red" onclick="ctxDo('delete')"><svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a1 1 0 011-1h4a1 1 0 011 1v2"/></svg>Удалить</div>
</div>

<!-- GLOBAL TOOLTIP -->
<div id="g-tooltip"></div>

<script>
// ── ГЛОБАЛЬНЫЙ ТУЛТИП ──
const gTip = document.getElementById('g-tooltip');
let tipTimer = null;

document.addEventListener('mouseover', e => {
  const vb = e.target.closest('.verified-badge');
  const db = e.target.closest('.dev-badge');
  if (vb) showGTip(vb, 'Верифицированный аккаунт', 'verified'); 
  else if (db) showGTip(db, db.dataset.tip || '★  Разработчик', 'dev');
  else hideGTip();
});
document.addEventListener('mouseout', e => {
  const vb = e.target.closest('.verified-badge');
  const db = e.target.closest('.dev-badge');
  if (vb || db) hideGTip();
});
document.addEventListener('scroll', hideGTip, true);

function showGTip(anchor, text, type) {
  clearTimeout(tipTimer);
  gTip.textContent = text;
  gTip.className = 'type-' + type;
  // Position below the anchor
  const r = anchor.getBoundingClientRect();
  gTip.style.left = '0px'; gTip.style.top = '0px';
  document.body.appendChild(gTip);
  const tw = gTip.offsetWidth;
  let left = r.left + r.width/2 - tw/2;
  let top  = r.bottom + 8;
  // Keep inside viewport
  left = Math.max(8, Math.min(left, window.innerWidth - tw - 8));
  if (top + gTip.offsetHeight > window.innerHeight - 8) top = r.top - gTip.offsetHeight - 8;
  gTip.style.left = left + 'px';
  gTip.style.top  = top  + 'px';
  gTip.classList.add('show');
}
function hideGTip() {
  gTip.classList.remove('show');
}
</script>
<div class="lightbox" id="lightbox" onclick="this.classList.remove('on')">
  <img id="lightbox-img" src="" alt="">
</div>

<script>
// ═══════════════ CONSTANTS ═══════════════
const SYS_ID = 'sys_pz';
const EMPIRE_IMG = 'data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCAEAAQADASIAAhEBAxEB/8QAHQAAAgICAwEAAAAAAAAAAAAAAAgGBwMFAQIECf/EAFUQAAECBQEDBgcLCQcBBwUBAAECAwAEBQYRBxIhMQgTIkFRYRQVN3F0gcEXGCMyVVaRkpOh0UJSVFd2lbGy0hYkM1NicpSkCSdkouHw8SU2Q4KDwv/EABsBAAICAwEAAAAAAAAAAAAAAAAFBAYBAwcC/8QAOxEAAQMCAgYGCAYCAwEAAAAAAQACAwQRBSEGEjFBUXETFGGRwdEWIjIzNVJTgRU0QqGx8CNyYqLhkv/aAAwDAQACEQMRAD8Aq/EGIIIp67ujEGIIIEIxBiCCBCMQYgggQjEGIIIEIxBiCCBCMQYgggQjEGIIIEIxBiCCBCMQYgzBAhGIMQQQIRiDEEECEYgxBBAhGIMQQQIRiDEEECEYgxBBAhEEEECwiJfpDZ7V8XeKG9OOSiC0pznEJCju7jEQi2eSj5Vk+ir9kbqdofK1p2KBikz4aOSRhsQMls5zSrTOWm3ZaZ1MQ0+0rZcQpABSeyMXuYaW/rRa+qIUvWnyqXHkYPhy/ZGgRQqytCVopk2pKhkENHeIf9Rg+Vcz9I8S+qe4eSdP3MNLf1ot/VEHuYaW/rRa+qIS7xBW/kqb+yMHiCt/JU39kYOowfKj0jxL6p7h5J0fcw0t/Wi19UQe5hpb+tFr6ohLvEFb+Spv7IweIK38lTf2Rg6jB8qPSPEvqnuHknR9zDS39aLX1RB7mGlv60WvqiEu8QVv5Km/sjB4grfyVN/ZGDqMHyo9I8S+qe4eSdH3MNLf1otfVEHuY6W/rRa+qIS7xBW/kqb+yMHiCt/JU39kYOowfKs+keJfVPcPJOj7mGlv60W/qiD3MNLf1ot/VEJd4grfyVN/ZGDxBW/kqb+yMHUYPlWPSPEvqnuHknR9zHS39aDX1BB7mGlv60W/qiEu8QVv5Km/sjB4grfyVN/ZGDqMHyo9I8S+qe4eSdH3MNLf1otfVEHuYaW/rRb+qIS7xBW/kqb+yMHiCt/JU39kYOowfKj0jxL6p7h5J0fcw0t/Wi19UQe5hpb+tFv6ohLvEFb+Spv7IweIK38lTf2Rg6jB8qPSPEvqnuHknR9zDS39aLX1RB7mGlv60WvqiEu8QVv5Km/sjB4grfyVN/ZGDqMHyo9I8S+qe4eSdEaY6W/rRa+qIPcx0tx5UGvqCEu8QVv5Km/sjB4grfyVN/ZGDqMHyo9I8S+qe4eSdH3MNLf1otfVEZpLSnTSbmmpSW1MQ6+8oJbQlAyo9ghJnKHWG0KWumTSUpGSS2cARI9DQFau2yCMjw9Htg6jB8qPSPEvqnuHkmB1nsqWsW6GqTKzjk2hbCXCtaQCCerdEHi4+Vr5RJf0RHtinIQ1LQyVzRsXSsImfPRRySG5IzRBBBGhMUQQQQIRFs8lHyrJ9FX7IqaLZ5KPlWT6Kv2RIpPfN5pZjXw+b/UpXNZ/K3cXp6vZDiV2fu1y4bXta1KhSqVLm2WJ11b0nzm0cITjd174TvWfyuXCf/Hq9kOXLH/vZtsdYspnI/8A2ahpjVTJS0Es0Rs4DJcjpYxJM1rthK48S6t/PS3f3Wr8YPEurfz0t391q/GLC4cYOvEcr9MMW+oP/keSs34VTcFXviXVv56W7+61fjB4l1b+elu/utX4xYUEHphi31B3DyR+FU3BV74l1b+elu/utX4weJdW/npbv7rV+MTubnJWUSDMzDbWfihR3nzDjGVpaHUBbagtJ4EHdGfS7F7X6T/qPJY/DKW9rfuq/wDEurfz0t391q/GMU3TdVpVrnX72t5KM4z4qWfbE8qU6mSbSrwd+YUo4CGgM+ffGrrlxUxuzKlXkPIclpVhxS8/kqTuKTnrBjdFpTjMhFn5E29keS8Pw6laDko2mjatLSFIva3FJIyCmmKIP3xz4l1b+elu/utX4wcnm6VXZpjJTbja0PyqjKuFX5ZTjpD6YsKPVZpPjFLO+F8mbSR7I8kQ4dSyMDw3aq98S6t/PS3f3Wr8Y4XR9WUIK13vbaEpGSpVMUAB3nMWHFccoq6lWlplOzLTSlvzhEq2RwQVg9L1Ygo9J8Yqp2QskF3ED2R5Imw6liYXkbFxJ0/VWba51i9reUjOMmlLHtjN4l1b+elu/utX4xI6HcFMcsym1t15tqXmWWyjH5SlbgkY6yd0bSnTiZxCz4O/LqQcFDoGfPujzLpTjMZN35A29keSGYdSuAyUI8S6t/PS3f3Wr8YPEurfz0t391q/GLAcWhtJU4pKEgZJJwBGKUm5WbQpcs+26EnCgk70+ccY1el2L2vr/wDUeS2fhdLe1v3UE8S6t/PS3f3Wr8YPEurfz0t391q/GLCgjz6YYt9Qdw8kfhVNwVe+JdW/npbv7rV+MHiXVv56W7+61fjFhQRn0wxb6n/UeSPwqm4Kq6RVrtFw3baN1ztLqjDduuzTS2JTm8K3jrhSdC/K9bHp6PbDcTflgu79kXf5jCj6F+V62PT0e2OqYPUyVVDFNKbuIzVZqWCOVzW7Amr5WvlEl/RE+2Kci4+Vr5RJf0RPtinIV1nv3c11rAvh0PJEEEERk1RBBBAhEWzyUfKsn0Vfsipotnko+VZPoq/ZEik983mlmNfD5v8AUpXNaVbOrVxHsn1H+EOXLKCtWLaWBjNksH/zNQmWtnlXuT05fshzJEZ1Ttnfwshj+ZqJukfwubkuTUX5hnNWEo5JMRTVK4k21bLc4qY8GTMTrEqt3rbQ4vZUoeYHOYleIXjlsXBLs2xS7cSsc/MPl5wA70pGCk4798chwOk65XxQ2yJz5BWmtl6KBzlfdKlWWpZtyXmX30LbBC3HivaGM53x6/NCX6Z61XXYxZo0+pFVpqQC005uWlOPyVHh9EW81ym7K5vE1SqnLvgb2vjZPn2Ya4holiUEhDG644jxCjwYpA5vrGxWn11vu5rf1cbkqBT5SeeEm0GGphoOELXncgEHecRZOkN5P1tpVIrNORS6w00Hly6dwUD2DAA4HcIWG+tV52papt6hUOWEo7KBtEuy70xsJJ+Pw47ocKkBi5abRrkmZIys4GudQFjC2toYUD3EfxhhjtG2iw+Bk0QBLbawOYcNxG8LRRTdJLIWm/Dkt6DsK2ycAbzCW6halz7bt4WZKS6BTajVnFhzaxhIUvbx/uKgfVEz141eq87VqtQ7YrjNMpsg2EPOtnacmVlQBCSDuAzg8eBhbXw48+UBSnFLVlK1bsnr+mHGiujj4I+nqgPWsQOFjcEqJiVcJHajNybDQC4ZKiaZyLUpPszD0uh6dqLYVhLKFJTsJV/qJSoDzRekpVJGYal1CZbSqYSFIST2jOI+fNsXDPWzWZOoy5YU2FAqQ+0VoCh+UUgjJHEQ4FjXDK3RasuaKxUlSZeRMT1Unmi2lSkqBwjIG1nATuPCFelOB9FL04zDibnnnn4bzsW7Dq06upwVjv1OSbamFpmELLAO2kHgQOEULygK/KVvTqdbnZ1liYebZnae2o5Q8gJUVpT/AKhlOfPE4vS4Ja1LUmnaszUkSYfcmZGpyLZcCVLJV08A7ONop3nfCdXJcM9dFXm6lOlgAkkIl2ihBWr8oJJOCeuM6K4J0kvWNgaRY8bcPHeNiziNb6uorC081Lm1m0LKnGguQp9URlzjkFSNgdwSoZh0V4Ks5zneD2x8zJXnG3RhS2FoWFFYG9PZmGW0J1ZrUpV6TRLnrbNTps8gtsvrOHJdYJCQo54HGBw4iGmlWjrp2CemAGrrEjebm5IWjDa4Ru1JN6trV683aO2mh0WnIqladbLqZde9KQOGRg5zngYrbQe+7muDVpyRrkhKyLhlHEvtsNhslSBuCwBxGYu2upZtqlVy45SRVOVAtc6sITlbmzuSkdwB+6FAsbVSbpOqDt/VuUVOuzZcTMNI6A2VfmceG+E+B0ja3D544YgSG2Dicy47rbgpdZN0U0bnG3HkneMeSqMMrlnHn5h5lttslSkOlASO04imHuU3ZqWiZSkVSYfIyGz0cespioNStaLsvkzFGk3G6VS1py8y1vUpPYpQOFdXUIXYdoliU8oD26g4nwC3T4pA1uRuU1WmNxIuW2XJtqYEy3Lzr0ol7P8AiJbVgK789sSiF45FNxS0xbNTtwqCZiXf59tJO9SVZKj6t0MOBnhvhXjlH1OvkhAyBy5KTQzdLA1yq2b8sF3fsi7/ADGFH0L8r1seno9sNzOeWG7v2Rd/mMKNoX5XrY9PR7Y69o78Mh5KrVv5h/NNXytfKJL+iJ9sU5Fx8rXyiS/oifbFORCrPfu5rq+BfDoeSIIIIjJqiCCCBCItnko+VZPoq/ZFTRbPJR8qyfRV+yJFJ75vNLMa+Hzf6lK1rZ5V7k9OX7IcbnFNakW86hKlLRYrSkgdZBahOdbPKvcnpy/ZDlyYB1UtfOd1ksfzNRO0iNsMm5eK5NRC87ea8t0ar2taFnonpud8PqK2woyKchwuEZII/JAPbiE/vC4aje91zNy3E+G0OK3N9SEjghI44/GGK5Wem8rOURy+qUw2zOyYAnEITgOt/n4HWMevMKrstraQ++0pTZ6O0Fk7J74U6IUlEKY1UOb3ZG+0dn92qTick2v0b9gXql3zP1tU4vCJdtJ48EgJwB/77Y7MoROSwLh2VrWrmFde7O7zRwWKeWxLLm3pcfGAUgbKvWDvjmeJkEtutNLcCRhtw7kjzARcEsVoclay13beXjKqtc9SaWQtxtaOi45+SD2jccxafKWdv62FP3Hb1UXL0OYlUyky00AS0cnBAI3A7QGREm5KlMZpuj8g82OnOOKfdWeJyAQPVvjPe89VKfepFYk35m1ZuX5p5HMJdQpW/t3g7xvEcuqsUkqMbcbBzWXGqd4G23/I7lZaaivS2Bs45pd9JrUpExQZ69bwVMqbpju0zILaUgTqlYIKlEbxlWdxHCPFqhczF1S0oinNNPzji8tS0nK7PMAbsDAyeI7YZaVt9m/ngidpr0hakmyW5SVUObW8vGNs46gCcb+oRBrP0Kq1l6mC4pKtyjVClCVIUtvnH9kkHZ2VJI9ecw1jx6ldM+WodaRou1pOQ4NuBtvty7L5LDqd9PD0UbQdbJxte3LzStT9PfllutTodYmm962nUFJHqIhlORvPytQlp6iVBqZmJhtQmWDzh5ptG4cAeOQeMeflgUe33q/SajKvNJqE8hTL+wNytnGwTjdklRzEc5GroZ1OmZZc6tn+6qSGkpyHyCdx7McfVDLEaluJYC+osWm17cCD/CVwR9DVhm3NSflkVSUkUSdCpzczLTDhMw+Q4eaWjfkYPXkjhC4U+QmJksokOdfm3VdBlpBUo47gIunlkrQ9qaxLpmlOnwZIKFjAZyBuHbnjEg5IdJoMtcFWnZl1pU/JNpaZKx8UqztkZ8wjGHVLcNwFlRYuIF+ZKzPH09YWXtmq/wBL7llrUYmUVFtqXnkLHOSs5KlRfB3YORkD6I9erVrUmXosjetniYS1U3cvU9ttSkyawCSpKgNwynO8njFpXloVVb01MVcE9XZRyhTRC1Lbb2H9kEkJACQPXnMTiZoTNhzgbk6Q9ULWnGA1NMp6amFgY2sE8CBv38TC6XHqVszJad15HC7m3y/1uRt4d29MxTyVEPRSNA1fZNrE81DuTSNQLmXKXPcdVU9RJWVXKSzbgwXjlOSR142cZPbFY8qqyXbUvFNTpaOapdUJWhtKOi25+UB2DeIv+xp6rT98gUeVdYtOVleaZbUwllKFbtwx8Y7uJjzcqqltVLSGedWQl2SdQ+0rHDGSR68CFVJiskGNtdYNa+w1RlYE5X7Qdv3RU0NqWxNyM7pNnkplJchC8lC08+rrPA480dX5jwCtJnEdOWcSOHBScbx/77I5kf78HXVsLbCtzjg3pO7sPsgDFOCTKtTUxMD4xAQNlPrzujqKra29nXFULHuuVuW23QtttWS2T8dB4oUOyG/tHVi2L0tFyelp4SNSQgkyRPwgdAyAkflAnszCOrCEoL8q2pttJxtFZ6UNTyStNJSRobd8VWWbdnJwHwNDidoNo/PGes7/ADYin6X0tD1cVU9w8ZC2/sP9yTPDJZuk6NmwqXBa3NVLnccGFrs1alDrBOYUzQvyvWx6ej2w3E2P++C7tw/+0Xf5jCj6F+V62PT0e2G+j1vwyG3BRaz37uaavla+USX9ET7YpyLj5WvlEl/RE+2KciDWe/dzXWMC+HQ8kQQQRGTVEEY+fZ/zm/rCDn2f85v6wgWbHgskWzyUfKsn0VfsioufZ/zm/rCLb5JziF6rJ2FpV/dV8DnsiRSe+bzSzGgRh83+pSua2eVe5PTl+yHLkvKpbH7EMfzNQmmtZzqvch/8cv2Q5UqoJ1StgqIAFkM5JOMdJqJukfwubl4rktF+YZzUxueRaqduVGnTCQpmYl1IUD1jEfOiQJ8MmZJX+GsLGyeojODH0WuWoytOtmeqkw6lMszLqcUs8MYj5yy5KJl+aPAlQR3k8Iq+gGvqTg7Lt787+CZY3bXYh1e1TmNpIUtl4tp708cfSY2LacVN2TQn+7LZC3EdSSUgk/THjlZZ5/m2mUDZQrbcWo4Rtecx3qEzsIXKyiHFrc3OulJ6fcO6OhpGm+5IdxytW0wRSUuI8MprpS42D0tg42Tj1GLRmrjkabW2qXPTTUq5Mo2mFKc+Pjt7I+fFjXJcFq15ueoE67JzSdyscCOsKHZDY8mW7/7dtVmpVtcu9XtvYcSBvEvgYAB6s7Ucv0k0c6vJLW7WHOw2gk/xfNWGgr9drYTtV2OOpKkbS87e5G/juzujWTYfqTHP0t7pMOqbcQsdBeCQQfWIwVqTnZd6Sm6Mwl3wdR25ZSwnbSQeBO4HJ+6IXeU+pcnPVA2U8hTbRMw7MziWmBjrUTja9R3xUqSk6Vw1T/GWdswSP5TKaUsFiFRnKFrCJ+96dRWJqUcRT1qdfalGglto7spyD0lDHYOqOvI+cdVqtPKYnmJdtUurbbWjKnhk4Cd+4jjFY3DW36pMzlbnktIfmlFlpDYIS2gfmg78b4uXkRSTprtXnRIIeZEuEKmTuLSsjd6/bHV8ThFDgUkXBtt20qtwP6Wra7tWq5YCnk6pSrrsyxMNpYQEpQnewMDoq7zxjtyeaw3J3zUqI/NyoFQUHJdmcbCmnVZOBtE9FRz2GNny25Z9NepE34AhlpUupImQcqdOeB7MY+6KZoNfm6a/JVqRDZflMNPJcGQ4k9Rx1boxhkArsCjiG9tt20Ind0VWXdq+gTBcp0qHam7jnXUoSlI6CCogBI7s/wAY2Ic2VKKVY2fjb+EVlZ0643JSU4qyHluONBcu9LzqXWCD1pIyE+sxM6NKTr7k7N1ZlDYmVAplkr2ubSAOJG4nIz645VWUvROOsdnLM33AEqyQzdIAAFnlLgkqlWHadJTTU2uWQC8UuZ2M8B3xVHK/uCXpWl5pXOoE3UnkpQgnpFCfjH7468pm8DYjVJqFBLMvXzlDe7P93PxgodmQnjCnXzclwXRW1zlwTrs5NqOATwA6gkRbdHNHTUSRV2xgzsdpI8Etr6/Ua6HeuHN9TalHU7Mq20VtoHBRCSQfpjwIUU011aQEqfe2FbvyeOPpEeiSmOcYRLTiXELbHwLoSSU9x7vxjpMSzzAW08gbC1BaHEnKdrzx09V5Y6jlU5LyjYyltKUhPeeMfRy3JFunW/ISLCNhllhKEJ7BjPtj5wTBVz7U23u2SArtBEfR23KlL1C2ZCpNOhbDsulxK+0Y/wDSOeafhxjg4Xd35W8U8wS2s7iq/m/LBd37Iu/zGFH0L8r1seno9sNxNEK1fu1QOQbRcIPrMKPoX5XrY9PR7YtWjvwyHkltb79/NNXytfKJL+iJ9sU5Fw8rdxCNRJbaWlP90TxOO2Ka59n/ADm/rCINZ79y6vgQP4dDyWSCMfPs/wCc39YQc+z/AJzf1hEZNrHgrs93zk+/Nb/p0we75yffmt/06YpX3per36JSv+Sv+iD3per36JSv+Sv+iLb0bOC4h1yo+c95V1e75yffmt/06YnWiGqek923mKZZ9FMlUiypXOcyE9EcRkQrfvS9Xv0Slf8AJX/RFvck7QnUDTzU8Vu4peRRI+CrQVNPKUdo4xuKRAI2jMBYdVTOFnPJHMpV9bPKvcnpy/ZDeVRiZmL6oLUmkKmDY8uptJONohxk49YBHrhQ9bPKvcnpy/ZDlyYzqpbHdZLH8zUKdIHamGyu4DxC9UYvO0dqqnlOaqvqoH9iGaNN0qZnEJVNl8DoIxvQCkkHj1Z4QtrTkm28GtlTigQAp3ISPohsuWVbSJ+x5a5WWwZumvBsq6w2rJP8ohUZVbdUYclnkJTNISVtOAY2scUmIeibqd+HB0DdXM3zvmt2JB4nIebr1OPTCl+DTSw1kbTKkAbCh2bo6NLDiHVhONlslQz8RQIH3x42XFOU1Tbp3yzgUg9m8DEZ5tC2pUstIJemTtqA6k/+u4xZVAXRqbYdqjbr/QDrQQ4pI4E8TGxs2uVa26yJ6hT65SoMK6Kkq6LqfzSOB9fbGnp1KmJyfEqnCd2VrPBI7Y3hlqfKsFUtJNutp4zEw4U7R7hgx5exr2lrhcFZBINwrnkuU7dbUuiXnLVk35pIwXBt9I9u44+iIZqfqpd18SzcjVH0U+VdXhMhLHcrvUeOO7PXEGddVsBbEw+gYyW0ukgj/SfZHiS6oTUvMtS60MoXtFxe8qPaYV0+BYfTy9LHEA4b+HJSJKyaRuq52S4qiG1VdMu2QWWkhKBniIsfkz3Kbe1Nk5F+pOSMjNKUiZORsL6J2QrPDfjfFVmYWmeW6ppKyTvHH6OyNlMLp7im5xTTimVjYfTnBSrt/hE2spm1UD4H7HC3/q0xyGN4eNysDlM3ILi1PnJOVqa5+QlSluXIPQR0emBjj0s74rqlNoFUVKqVsMvJKFDjgfjGeXckEKdnksqDKBzbKOtSu3+Mavwp0zqHW2w2QoEJHtjNJTNpYGQs2NFv/fuiR5keXHerS001Vu6yGFyVNmEVGVaODITKjhHek8fVmJpN8p66XpVbEna0ozNLGErO3hPfvP8AGKH51Spp+ael3FNLVtJcQcFJ7RHqaeXslb8y+4DvDanSkAd6uMQanAsPqZelliBdxW6Osmjbqtdksl4V6sXHWFTlcqC5uoPq6alK6LafzR1AebsjXzU2wmquuNbw20UNqPaOBjbCWkJhkKmpJDbStwmJZwqCf93CNBUKY/KT5lThXWhY4KHbDRjGsaGtFgFHJJNytishtttWdsKbBSPzlE4yTHZl59DhlJVXO7PSdUsAoHdvjzyqXXJXmXcpelukkEcUdnq3mMDzik0xDLSsc+6VLOeO8gDzR6WF3eek3XVtbBbUo9JTOSk/TvhkOTLqpMf2fXZMxR5yqzMo2oyhYx004+IoqIA9eOMLlNLapTKJZhCVTSkhTrihnHcIbDkbW2mnWLM3E+0EzdSeKUr61NJwR95MVrSx9OzDi6ZutmLC9s1Pw0PdOAw2W4pzD7Go9yImt0wbPeU4nOdglaiE+oED1Qqehfletj09HthuJvywXdj5ou/zGFH0L8r1seno9sTsBdr4dC7iFprBad3NPfrjqZpZZ10NSF50Yzs+phK0r5oKwk8BviAe75yffmt/06Y68rjRC+9R7+latbUvJOSiJRLZU68pJ2hnO4JMUv70vV79EpX/ACV/0Q0MbTmQvLaqZos15A5lXV7vnJ9+a3/Tpg93zk+/Nb/p0xSvvS9Xv0Slf8lf9EHvS9Xv0Slf8lf9EHRs4LPXKj5z3la/30Wr/wAutfZq/qg99Fq/8utfZq/qilII9qOrr99Fq/8ALrX2av6ouTki606hX7qkKPcVVbmJHwVay2EEbxjHXCYQxXIB8tR9Cc9kCFU2tnlXuT05fshy5LyqWx+xDH8zUJprZ5V7k9OX7IcuS8qlsfsQx/M1CTSP4XNy8VKofzDOa9evEl4w0iuKX2do+CFad3WP/mEFpJKKk2ew74+hGrjiGdMrgccXspEivJ+iPnzTWlKfW4O8JJ4b+v1RXtAnHqko3a3gp+NAdK09i9lJlkvc+86oIYQ4VLUTuHYPpxGZU18KHWmGXWSrC1q3q7vNGKZcfLKESaElhk5KcjKz1kiOja2Xdh6Xb5lSlbDrY4dufui+JMtplEpKFD5IVNvEOKzv5pPH6cxYGlmjNZ1Fll1+qTvimiJB5la0520j83eMDv8APFavS66tXqdTELILwQ2CO1UMtyh6/O2pQbftS3JJ4SEklqYnuYSSA0CDsHHAEg588IsZrJ2PjpaUgPffM7gNp57gplJEx15JNgUZurk3ON0ZdSsq4W6mppJJlyNzpB34VnHDqxC/zC5unVJ2VeLrC21lDzStxSQcEEQy/JSuSo1C+q7I0tLq7eW34QQ9k8yslOdk+c4x2RX3LAp1Op+qzipJlDLj8shx5KOG2Ug59eSYhYViFVHiDsPqna/q6wdsPI9q21MEZiE0Ytnayqmo85JTCHJV0pbdSFpKd3HujO9MifpLzhSlEw3jb2RgLTkb/PHjqilKZk8johhIBju00uUcTlQLUw2cK6uv2xakuXoamBIUhlYSlUw4TsbQ3ITnj54wU/bnHluzTxUhpO2ra35xHVxtc4tRScNMNjJ6hjA/jHFLJDE5jgWSDAhd2nZyo1NqXaDrzjqw2y0jftEnASB54YG0eTW69SW6relfTTS4jaVLgf4eeAK84zw3YiK8j2nSE9qqlydaadXLy63GUr/O2VbwO0YzE85VNz1SRv2i06qpfRbqE+EJSySnn14I3nz7sdgiq4riFVLXtw+ldqZaxO08h2plTQxNi6aUXF7KD6qaM1jTphFwUqdFXoav8ZaU4LaTw2hk5GOuK+HNzcslppRK5N4JSQf/AMaj7MQxnJ8rs7dlDuC0LgkXkyM6lx+R59JxzOc7IJ4gZTgjsha5VlVIr9Rp7iuk1toPfiJmDVlQ90tLVEF8dsxvB2HnuK1VcLG6r4xYFdETnwpedl2W2Uq2ULA2VHt88YavLJZ5l5lQUwtYUhQO4794+mOHC0wlTz7YdUlWwy0eHbk/THdlcwWXG51KUsO7wnIBQeogcYfKEtdV1FdSeUcb1bvND/aGyKafpLbsuj9ECj5yTCCVRlSH0uEg8ASOs9vrj6E6UOpe01t9xOzhUknh5zFE09cRSxN3a3gnWCj/ACuPYopN+WC7v2Rd/mMKPoX5XrY9PR7Ybib8sF3fsi7/ADGFH0L8r1seno9sWHR34ZDyS+t/MP5ppeWFrJfmn+oMrS7ZqTcrKLlEuFBQTlRzk8RFIe+i1f8Al1r7NX9US3/tCPKtJego9sLPDpRVdfvotX/l1r7NX9UHvotX/l1r7NX9UUpBAhEEXh71jWD5Glftj/TB71jWD5Glftj/AEwIVHwxXIB8tR9Cc9kaX3rGsHyNK/bH+mLi5JGiOoVgaoCtXFTmGJHwZbZUl0k5OMbsQISva2eVe5PTl+yHLkiPdVtcE4KrJZA7+k1Caa2eVe5PTl+yHAmJV6a1NtbwZ0NTDdlMLaUeAO01x7sZhNpCAcMmBNslJozadvNc8p+pNU3RqrBa8KmymWbGcEqUDj+EJEwWENeCrf5lRGXFEfdDa8oqz9Q70t5pcozJpYkV7ZkGHitb5H5YOBv7u+FMeealppyUqFM2FoVsuJPRWk/RCjQuOKKhLWuBcTc2OzgpWKuc6a5FgvNMSr0piYYe5xo8HEH7jGaVWlcyHx0QUFSx1AjdmO5Q3KEOMuFyTf6OOw9h74wISGJSZzvyebT5jv8AZFwSxT/RazqxdtzCsU5lSpejpQ+7jiojeEDvODDa3+zRZmw7mqDKAt1ykOJccKd+Q2rA38N8aPkq0VqiaQyEwAA5PKM04vh0SAQD5smMV/f94krPyVlXU20pgiWq7JOUln8pQ39QJ390crxXEHYhiZBOqyM21s7WuNvMjJWKmgENPfaXDYqv5Gl0UaiSVxylUnWZVWx4SkubtsJ2Rsg+rhEOuel1TU6dvDUV91tilU8EtLcJytIyEIA8w+6LS1L0Osxi0Kcq3ypFTWtplr4TImlEjbIT2gbSvVGn15XKWLYlN0zkCymZm1bc2+2gAqaTuSFd5ChDumrKeetNTRk9JKQMx7LW21j9x++ShvjeyLUl9lv8nYlvDyX5cSy+iUEltXsjY0JMvOsO0qdcDW/badO/ZV2eaJReFgVG35CSFTpfgRn2w5IvBZWl3tQTgYVw3d8Qmm85LVINOM7RyUrbV190XWKVkrddhuOxK3NLTYr3V8y0jLN0uSWHBnaedH5auzzRri8hiWMujeVnLivZHM+HZiolpDWyc7KGxvx3RN7PsGo16mzyqdShPeL2ucnni4UBv/SDg5VuO7ugllZE3XkNh2rDWlxsFvrbpNV0wnrQ1FYdbmaVUQOccQT0EqOFpI7kn74mPLLuei1qWtyWps4zNKKPCFFvfsJUFbifXwjNoU7KX3YlT00nHGlzcivak3XEDotHAUE94CSY3emeiVmTVmzyrg23Ko2t1lwbewJYhRCCU9pGyrzGKXU1dPBW9ZrL9JESMhta72T9h+6aMje+LUj2O47iNqtCwWKLLWLatTcwhxmjNobcCd/SbTtDdx3iFL1osyr2lXxWZ5kplaslbzJI3pJ4oV3jdDJ6eoRp3LSEne11NOuPHwejtFWEpZ6iRnsCfNGXlVUPx5pHPOgjnJBQmUKxnojJVjz4hLhWIOw/E9UHWZIba2dtptbkTmplTAJqe+wtGxJZNr2JgzChtYQCnszwjBLyz02TMPvc22OLiz9wjs4kPy0qrPD4NW/s3+2M5Q3NEuvuczJM9FI/OPYO/jHUlXl1d8HW34Ml/nSlPwascT2GHc5MNTbqWjdJSlzbXKZl1jrBGD7YSVp9mafbk5GlBalnZQn4y1H6IbDk62XqNZNBdVNy8iWJ1W2mSfeKFtE/lndx4bu6KhpnHFLQhrnAOBuLm1+KZ4U9zJrgXG9SWZVnWK8BkHFpO8POYUjQvyvWx6ej2w1kpKOSurV4GYe56YdtN1bqhuGcncB2dUKnoX5XrY9PR7Yb6PgDDYQOCi1nv3c1cf8A2hHlWkvQUe2Fnh3eV/ovfmoV/StWtmQYmJREoltSlOEHaGc7sGKS96xrB8jSv2x/phwoyo+CLw96xrB8jSv2x/pg96xrB8jSv2x/pgQsHvntXvnAPqH8YPfPavfOAfUP4wxXuO8mn9Olv+U5+MHuO8mn9Olv+U5+Ma+lj+YKV1Gp+m7uKXX3z2r3zgH1D+MXLyRNaNQb71SFIuKriZkvBVrLeyeIxg8YkvuO8mn9Olv+U5+MTbRrT3Rm27uTUbJmWnKoGlIAS+tXROM7icRkSMJsCF5dSVDBrOYQORSD61+Ve5PTl+yHLkvKpbH7EMfzNQmmtnlXuT05fshy5LyqWx+xDH8zUJ9I/hc3LxXqi/MM5qwuMUHyotJJeuUeYu6gSeKtLJK5ptGAHWxvJx2jfF+CA7O/aSFDG9J3gjsMcaw3EJsPqGzxHMbuI4FW2op2zxljl8zpFSwXJRYICgdx/JUP/iMj6XVysuyEKU66o9EDeTnAizeU1YqbN1BVNySFIp9THhDOBuQokgp+kE+uJnyT9PZau1F686xLc/LSRDck2odFbg4q9WCI7TNjVPFh4r9rSMh2nd3qotpXum6HepgxfdAszSKgWlcFRmqRVH6a0h3EotZZSUgHOBx7orS4RQbLrbF8aZ3n4U2lxJmpF9YS6tJPSGDjIIyMYzFn6mztn2tOzdS1EoTlbn6nMO+BSzRPwTIO7JBG85HX1QvF3W6qt1VU7Z1m1qQkVjIZdaUQPMcn+MV/BYIZdaT1mh9y4nV1HE7RnnluTCre5lowb2tbiMkwDWvmmol01eVo0w5Xua3NJaXuWRv6WMY4xTlpzNwal63CrPNy8xOtqVNCWmN7ZbQQA3xG7BHX1RF7BpkpL35TaReCH6ZT33tmbU4goUE7Jx342sbxDT2/p1b9m6t0esWsEN0ydpj5eSpwrSAFN4WFEndjPX1x6qmUOBh7YQTI9hIJuRYbgfBaozNVEFxyB/pWk1/lZKoaAvVZ2WFPeE204iXUcmXdURtoSezcIVepOF6TCnyPCmCE7Y4rHEZ798XNyoNQpW5KwmzbdcS5TmJkuPupO554kA47hsjHnilK8FeGuKSrLZICe/AAJ+mG2jdNLBRXlFi4lwHAHZ5qPXPa+X1d2SzUxzmpJRY3zT5KdsjehPX/AAhqNBmJCk6BM1pqVNTX4S465LJODMOj4iCe7ePXCpW8CJ5C1H4PJSruyDvi6uTDqLKWzVV2dca9iQfmAthxR6LTwJ49xz90GklNLPRXiF9UhxHEDaEUL2tl9bfko3dj9e001oTV2Ey8vNvFM0Zdk4bShZILfHsB+mLmmNfNNTLmrTVGmUV0M/4SmlYKwNw2sYxnBjdXBp1bl5as1asXUG3aZJ01nmQHChOCteVlQI3Y7+qFYv2mSkxfdRpNnJmKpT2HcSym0FainAz34ByMmFNKyhx0MbMCJGNFyMhY/pJ8FIeZqUnV2E/0qxrc8QXpWX761KvQyaS4pUtJS6wp1Az0RgZwBwxiLKcv+hXlpPXbRt+cnKxU2Ke4homUcQXEbJwd44wvNp28qh1VE7eNn1qekU8WWmVAHznIhiNM5u0rsnZWq6d0R6hz1MmGfD5Z0/4rJVv6zwwfpjGNQQxgSHWIZYtI1dRttgyzz2FbaN7n3jJtfbxOSUtlLzcvMMqQpDrSt6SMEHODujpPKWS1KIGQgDcOtR3+2GE5WNgS1BqkvedGlA1LTqubnm0/FS5+djqzkCIZyZbFN4aiJnJxpS6dTTz7xO9K1ZGyn78+qH8ON08uHmv/AEgXI7Ru70vfSvbN0O9XHyX9I5eh0eWu6vygVVZpIclWnBnmWyMgkdp3ebEX9HAGOCQkdQG4COY4viWIzYhUOmlO3dwHAK3U1O2BgY1VbN+WC7v2Rd/mMKPoX5XrY9PR7Ybib8sF3fsi7/MYUfQvyvWx6ej2x2XR34ZDyVSrffv5po+WJrFflg6hStLtqqiVlFyiFlGznKjnJ4xSHvntXvnAPqH8YcXWmwtILnuRmdvuZZbqKWEpSFPKSdjq3AxBPcd5NP6dLf8AKc/GG5kYDYkLyykne0Oawkcil1989q984B9Q/jB757V75wD6h/GGK9x3k0/p0t/ynPxg9x3k0/p0t/ynPxjHSx/MF66jU/Td3FUJ4Ox/kt/VEHg7H+S39URlgiprt2sVi8HY/wAlv6oi2+Sc02jVVOy2kf3VZ3DzRVMWvyU1pTqw2lRwVSrmO/hEik983mleNEnD5v8AUpXNbPKvcnpy/ZDlSS0+6paw2h0rJZA7ztNQnWurK2NX7mZcSUqTPKyD5hDRz9XUzXdIrrRsGQnqWaS8sHgsbRG//wDniGWOwumw6Zjduqf2zXI6RwbO0nirlggwRuPVHMcHV2VU8qS1Tcmlsy8wwlycp6g+ycb8ZAUM+bMSXRaht2/pjQ6e0gJ2pZMwrdjpODbP80SerSSKlSpuQe3NzDSmiezIxn1ZiMW9OXBR6dL0Geojsw7LJDDE0yrLTjadyCo46JwBnPXDgVUs+HilBya69r8R28D/ACoLo2x1HSkbRZea/rRNdvG26mqSZnZaVmB4Uh1IUAnIwcHjwMbWUuluemKxJW9KNzYpSNnKVbKFPceaGO7H0xGtZrvmLMsAs+HpRXKh8DLrB+Io/GWO5O76Y1PJOEqNOppbTxdmF1FxUwonJ29lMTeqyHDOtTZtYdVo3HO5PgvJmDqgRN22zUB1bmJPVe6aXQWaIqmTNNJerM882EhlsA5SV8SMkDzkRCtR9VnXmzbFrPOIpsrLiSYdbGFONAAblcQDgHPXEz5XN8OCqqs+kLbQEIS7U1g/4h4pQru+KfOBFIab25X70uZul0Vpa5tw9N/8llHWSeriIv2DUsXUo6iobqsaLtBN7XzLiTx3DcEjq5D0zmR7T/bLy2vSZhyfSlMu7NTzp2JeVa3rUo/wia35pfMUDT+Uuar1CXTUJqZ5lmSZIISnv785i56KLC0cr9Mt6WqMk3X5rPh9RmUh0tHdhJGRsgnPE7ojGrdhWc9R6ndlAueVmJmXKXlSDMwlxCSVAKKQDu3En1xkY86epjABZGSLHVvrZ2+w7eHBeRSBrDfN3PZ5qA2Bpe/X7CmLipNRYVUmJksuSDxACxv3Dv3CIRdFJfRUnGyw7Lz7aiiZlXhhaFjj54vbSaxrTl6VTLruC6JaVnJhSnm5F6YS2g4JCCoE7+jviSVdFhax12qUF+qyKq/KgGQqUukNl078gDJ2wN3A78wfjzoKmQOBfGNpsRq52+47f5WephzAdjue3yVXaa6srlmf7M3W6tymTMsZF1xxOVttqBAyriQnaJz1RMtH5qW0ruqpUF+iKqUxVMO0WeYaCg82QMJ2+IHHPeIo7Ui267Zd0uUuspWiZa3odA6LyM4Ch9Bi8eSXfi1VZFn1gtuJW2pyluHi2c5UgHsPSPnjGM00QoZKmnbrMcLuANr22OBHDeN4WaSQiZrJNoP9CvWfugU+oUSmXFJNyxqzZG0VbTbb27DRz1npfRGtsC0TQryuWqplG5OVnH9mVZbSEjZBPSwOo5iM8rBmWc07lFuP8zMIqLZYUDg52VRttGbymr10/LfhifHlPPMzK+IWocFHuUc/RFAFNIMM6zFk151XbbDO4PgngmAqDE7btHktzrTRZevaY1yRmEbQEsp5JxvBb6Y/liO8l62EW5pXJOrZSicqBL7ygN5GTs7/APbiJHck3cFZpkxQJChuS70yjmZiafV8ChtQwspOOkSnOO+JPSJBumUiTp7Iy1LS6GUHtCUgZ9eIhuqZIMPNITk517X3AeJt3L01jZKjpbbBZeqCCBI2lBOcZ3QnU5VZMlPuxXhgnItJzPdvMKRoX5XrY9PR7YZGkVYzVy6w3i48nxbKUwU1hXDCyWwR9KjC56AsOTOs1qsNDK11BAA9RjvWCwuhw+FjtoaFSapwdM4jimi5XDLS9RZcqbQT4IjeU+eKb8HY/wAlv6oi5+Vqoe6OwnI2hJoyPpinYWVnv3LrWBEjDoeSxeDsf5Lf1RB4Ox/kt/VEZYIjJtrFEEEEC8oia6E1VNH1boUy4rZbfeEqru2yBn7ohUdmX35aYampVfNzDCw40o/kqHAx7jdqPDuC1VEInidEf1AjvWt5attuUHXSpzRT8FVUpnGzjdg5T/8A5iZaIur1C5P1VtFtaTXbVe8Z0pJPSKQrKv51CJ3ypqCnU/Quj6g0ZgvVCmISJltAysoyAQe5OSqFW0fvmpaeXxKXBIL6CFbEyyeDzR+Mkj7/AFRawQ9vYVxKWN0MhY7Ig2Ty6V3bL3pZUnWWzsTOyGpxoghTbyRhYIO8b8xKYo6tvKtSqN6v6etrqVlVoBysU5k7S5V1W9SgnqOSrcDiLftquUq46OxVqNONzUq8kKSpJ3juI6jHF9JMDkw2cuaP8bjkeHYVacPrWzs1SfWC2Uamu1JykOInXmn3pHYKHAygrUlecg7IBJGAeAjbQAkcDFejeGuu4XCnvBIsDZUHrBZNV1HanrrZRNS8vTZLNKlFjZW+4BlRUk7xnCd24xrOSb4bIUGoGkvmpOl/m5ynLdSnmFbsOpJxuzuIyfi7oYuaQ48w4226WnFpISvGdk9sKjNP3RYOqtUua0LZmXqYhXN1JDaQZd3rJbOc4wc8BvzF2wuskxOhloQAALFoOzLcTlt4jO6TVMQp5my7b7VWOspnHNSqwiedClmay4R27IwB3AReHJbFDoGlFx3NUJjwZLj2HXsgLSlO0NlPefZFF6x3FR7puyartIlZqSEyUqdl3wApDgSAes7t0aW2Jl2cmJa36lXHabRX3wqYKlK5tP8AqIHHiYvNXh767DGQuOpk3Wyzy2j9sknjmEU5cM9tvurCFBr+sl5TtVt232ZSmNYaQ46shCACd6lKV0lb9+D2RpNVtObksKYl5apPS+zNM84ky7pwsZO4jaPZDO2ve+kFkWUzRKdckmqSaSc7IVtvqIAKuHE4hbNb9RafeVaT4jkJmXkWAUoXMLK3FccneTgb+AhfhOIV1VWdG2IsgbkLjM8Mznf7LfUwxRx6xdd54Ly6VaeXHfs6/KU11hQlWQ4tUw4cIBxgAZHbG6mKBXNHrykqncNCamaa6S2txlZLa0kjJSpKspV2ZMa7RHUaQsysK8dSMxMSLwCXFS7hQ4OGDuIBHnMMhdd9aP3rY79FqFxSiJRxvcFJVtskDcobuIzGMWr66mrOjdEXwOsMgbjjmM7/AGRTwxPiuHWeFDOVEmi13Sa3Lopswl/Ye2W3iQVqSrZGyrzZP0xSGjwmUai0ZEm4UvCc+DPYdk5HmIzGhuOYdlpmYt+mVt2o0Vh4rlyFK2CN3SAPDhG+0euSjWrdMpXatKzM8ZQqWyywASpwpKRnJG7fDGkw91Dhr4WEvydYb89g/daHzCWcOOWxXjysvDJugyUxWZjxW43Mc1J05DiVl878vKxncCMDh8bfGz0bseracs066XEzMzLVSTHjaUSNpcu5jokJG8gEncMmIVIzFz3/AKqUq6butp9qnqVzdNQ8nEs3neC4eOMDsO+GuZS42hKHFhTiQApSRgE9sUfFat+G0MVAbEEEuA2cgeI23Od03pYRUSulvs2ea1lDqi6w4qdZZmGZENhCA+2UKWvO87JAIGO0dUbbMBJJ3nMEUmR4e64FgnTGkCxN1wYh+sl3y9k2LN1NSszbyFMSTYBKluqGBgDfuJBjd3XcVHtejvVWtTqJaWZTk5PSV3AdsUrSHl3bVHdX9RW1U6zaJlykU504VNOp3p3dZJ2eJx2xYtG8CfiNQHuH+Nu08exL8RrWwMLQfWKiesTjun3J+o9pqWhNbup41OrJ69gklPm3pTxjQciC3V1zXSnzRbUWqY2qbKsbgQUgD/zRXOrV7VLUG9py4J5Rw6rZl2RwabG5KQOA3AcIb/kpW2xpZobVb9rrPMztQbLiEqGFBAyEgf7hg+qOzEho7AqtGx0jwxuZKinKRqbdU1eqZZVtNyqEyxOeC0lW0PvEV1GWenZipVGaqc2czE48p5z/AHK3mMUVWV+u8u4rtlJB1eBkXygBEEEEa1vRBBBAhEcHMcwQLKtHk/X9LW1VX7bry+coNXy0tKhlLa1jZ+g7hFS8qrRab09uJdaozDj9sz6+cYeSMhpSt5Sfvx3YjOpIUMGLe0r1Rk0UhdkagMGp0GaHMtvObywD1K7h29W6GtDWBg6N+zcqZpJgDqgmqpx628ce0dvFLlohq7W9NqithKRUKFNHE7TnT8G6nrOOAPHqi+6FQm50OXtye60h9Dyg7ULZmDs7PWQlIJ3neAMdUQrXTk01KkomLq08WiuW658IhmWVzrrYO/CQn4w8wihKHWa/adZTOUmem6XUJc/GRlC0HsIMNpoI6iMxyNDmncVz5rnRuuMiE79m6v2/Vpo0Svk29cLK+aekZvo5X2JJ4/RFknOAeojI74U6ka52desgxSdYrVbnXkp5tusSY2Hmv9ZG8kxO7Xt64GWPDNG9UJCvU9CQpuh1B1PPBPE5yoHPq64oOJ6DNcS+jdbsPgfNOafGHNylF+1Xsk4WCSd0eChSSqXTE01JSqWZylrvSTkgj1mKyVrDP2685K6g2RW6Ipr4843LrcYPaQQn2xObZvi07kZC6TcEhMLIzzReSlz6hOYpVXhFfQgiWMgcdoy7Qm0dXBMbtcoxqFotZF2SUxsUtim1BzK0TUs2Ena/1AcYWS+9FL7oLvSork9JNZHhMmS5lPUpQwMeaHlwRjPXwiH6iW5Oz9An1U+u1iTyyo8xKup2Vk9WNknthtgWktZSPETn3aT+q5t99qjVuHxSDWaM+xIXQLemq3WWqPIpPhrjmwEObgntKj1RetzaO0rTzRys12qzAqFWeS2hkhI2GcrSDjtPHfFoUjTqmWlaUtUbHlJSdr0qUPvuOHbXNAb1I3HcTvx54pDW/Vqs31LsW6qiu0iXl5jM00reorHUewcIuTMUqcXqWMpDaJp9fccjw22O790pMEdNGTIPWOzgpBbmjtI1E0eo9fpD7dPq7SHG3eiAh7ZUR0uw7uO+KIuO3pyhV1yjT42ZxtzYKUdJJHUUnri1dEdW65Y0s/bzNGcqrExMnwVpO5YWSeHaOMXhWNO6fddoTc/fktKSlcmi4/LrQdlcrtb0oBzvI6/NGHYnVYPUvZVm8Tj6m85nhtsN/wCyBBHUxgx+0BnwS9WNonfdcf3UVyRk3cJMzOEt4T1qAwc7uqGa0/0Vse05OW26WxVJ9s7a5qZbCsq7gc4jbac23PSNAkTUK5WJzDYKZeZcGyjB3DGyDE16iQM44xTsd0lq6t5ia+zQf03F+Z2ptRYfHG3XcM+1eGtyKqlTvFx5tMs5hLoIzhA6kj6I9yjk5iNXNfln24wt2q3DINLRxZQ+lTn1QcxAzrLUbjcRK6fWPWqy47/hzjjC0sDsJynh64VUmD19cB0UZI47B3lSZKuCE3c7NXDkJBUSAlIJJPACKuvnWW36TNCi22P7RV91fNMykqdpO32Ejh9ERG57duSZaE9rLqbT6BT9kqcocg8kvKTvIwAonPq6ohFT1ws6y5J6maP2m3JPqRza6zODbfd/1AbsGLrhmgzGWfWOv2DZ9ylNRjLnZRC3apnW6AmTeRe/KErSGQj4WRtlhWSvrAKDjhuBGIovWnVqualT7TLjSafRZQbMlTWFfBtJHXjcCe/EQ6uVm4LtrZnKtOzlVqUwrG0vK1rPYAIYHQXkyVKsplrq1CV4loDfwi5aY+DddA39La+KO3Ii+xQxwMDIxZo3BJSXPdc5krQ8lHRGc1BuFqv1plyXtuQcDjjh3B9Sd4SD2ZwT5jFxco/UFmv1Bq0KA42KDTSAst8FuJGyEjuTvGI9WrOq1Pbo6bH07bEjSJdPMvTDYwFpH5KPx39cUqlKUjAhVXVocOjZ910DRvR90JFVUj1v0jh2nt4Lnu6oIIIUq6oggggWEQQQQIRBBBAhEcKAI2e2OYIFlSzTzUS5rJm0+LZsvSRPwkk8SppQ/iPURE4rNJ0T1o6VSljatyvJwXWxs7R6u1GM+uKbjjG/gNxyD15iXBWSQ5bQkuJYDSV/rOGq7iPHj/c159TeTJf9rqcnKOw3cNLTlSZiUWkkJ7wSCT5hFOIXW7fniELn6XNJO8AqaXu+iGVs7UO77UeCqXWJhbWcliYWXEHuG1nHqicO6m2HeLJltRbBk1OublTkm0kr85V0SPVDWLEYn+1kVSqzROtgzi9cdm3uVAWpyiNQ6OgS9TmpW4ZIJCRK1JhK048+M/fExlNQdDbyeKrhtWdtCqOpAcqNLcUEA9oSFH+ESupcnrSW8m1TOn17iQfxkScyraGe9SiSIqe+uTfqfbK1OMUcVmUGTz9PVziQO05AicHNeMs1XJYZYXasjSD25K6reodyNsCa0s1dkLikEoymRqagl5Xd0kpP3xtFan3lbCkS+oen09IpPRM3IYeax+ccKVuhMHGK3QJ4lbc7TZps4KhtNqSfPE+sjXfUa10iXTW3KpJE/CS1R/vCVp/NyvOBCit0fw+tzkjF+IyP7LbFWzRey5ORZd52hcsuHbfqsopxW9TX+G4D/tUAfoiqeVTYrPisXzSJZDc5JqSJ1CE7nkE42sdu/j3RD6VfukOokw2m5qW5p/Xt4aq1JVsMoJ/KUElP8DFiTdUuO2qQ7SL6eYuGy6iwpqXuKS6RbSoYHOjA3538TFYOjdThFQ2ronFwBzadtt/P+Uw6+ypj6KUWO4rV8laxWjTl31WZVK5ybUoSTa07mWwcbWO04498Wre172fbDAcuCqSiVg7mcc4vP+0AkeuK2l6xcl00lqg6fOpoVnU6XSzN3HO9ALSkAHm+O88cjEQKoXvo/p1NLVQKe5qHX8AOVSqK2mFntSCVfwjI0bqMWqXVda4taTk0bbbuSOvspo+jiFzvParLGqd7XU6tnTnTycm0JVs+F1DDTZH5ycqTujVXDQrocbVOapavU+3pBY6chTlBTyB2dFKj98URe+u+ot0IVLGsrpUiD8HLU4CXShP5uUYyIgLMtW6/Pjm2p2pTTpwFYU4pR88WejwDD6P3cQvxOZ/dL5a2eX2nK+5y/tDrMf2rbtWbu+qNA83Uao4otqPaU7QP3REbs5Q+oNYQZalzErbskRjwamsJQnHnxn749Fi8mrVC5lJcmKQmjSpwS9PqKAUnrGAYtqkcnbSWzcTeoN8JnnEjJkmVbAz2BSTk+uGxc1gzyWqKGSZ2rG0k9maVBaq5cM9lSp+qTSj17bqt/wBMXNpfyYL+upTc5WmkW9SzhRfmljaUnuAJIPnEXSnVGwrNaEppzYMpziOimcmmkpUR2hQyT64hN5al3pdhKalWnmZfOQxKnmgO4lONoeeIUuIxMyGZViotFK2exk9Rvbt7lPaRStE9EE7Mix/ai5Wx0XVjbIV9yB/GIHqRqRdN8TChUJxUrID/AA5GXOygec8T9OIhqUpByM5O8k8T547wqqK2SbLYFdcMwGkoLOaNZ3E+A3LqkAJAG4dkdoIIhp2iCCCBYRBBBAhEEEECEQQQQIRBBBAhEEEECERxHMECyui2m1kFSckcO6JZauot62wEIplfmVMIO5iYUVt47MZERaCPTXuZm02WqaGOZurI0OHaLq3Dq1bl0tmW1JsOm1RvGPCENhSge0Jwf4xo6poxolfgcNkXM5Qao4NpEpNkYz2BG7EV/HQpBORlKuopOD9IidFiUrPazVeq9FKGe5juw9mzuK0Gp/J81EsVp2dmKYahTUb/AAqU6YCe1QHxY1Wk2q9dsN5ci5/9VoEyCidpUyctOA7jgHcDjrxF02Nqfd1qOtstz3jCmJwFyM0AtBT2Drz5zG6vPTXT/WynzFWshTFvXY2Np6SdUEofPr/iN0NKetjmy2FUzFNHqrDxr+0ziPEbkv8Aqxq1XL4U3S5JsUW3JcBEpSZU7LSQOBIG4nvxG00u5PWol9NtTrFMNOpi95mproAp7Ug/Gi7bJ050/wBE6SzWLz8HuO7FjLUk0sLQyr1cMdp3Ro791Nuy73VsvTZp9L2vg5GV6CQnvI358xgqK2OHLaUYXo9VV41/ZZxPgN62dG0b0PsNIVelyquGptfHlZYjGewo35jco1ety1mjJaa2HIUxoDHhDjYSSe0pwM/TFQBIByck9pOT9MdoVyYlK72clc6TRShgsZLvPbs7gpdcmp1+XCVJn7gmGWVZ+ClSW04PURk5iH7KdtTh3rVvUo8THbEEQXPc83cbqwwwxQN1Ymho7BZcCOYII8raiCCCBYRBBBAhEEEECEQQRxmBZXMEEECwiCCCBCIIIIEIggggQiCCCBCIIIIEIggggQiOzDr0u+JiWfdl3gCA40soVjziOsECCLrlxbjrhcfedecPFbqytR9Z3xxBBAhEEEECEQQQQIRBBBAhEEEECEQQQQIRBBBAhcYgCcRzBAsr/9k=';

const GRADS = ['linear-gradient(135deg,#7c6bff,#a695ff)','linear-gradient(135deg,#0ea5e9,#38bdf8)','linear-gradient(135deg,#10b981,#34d399)','linear-gradient(135deg,#f59e0b,#fbbf24)','linear-gradient(135deg,#ef4444,#f87171)','linear-gradient(135deg,#ec4899,#f472b6)','linear-gradient(135deg,#8b5cf6,#c084fc)','linear-gradient(135deg,#06b6d4,#22d3ee)'];
const DOT_COLORS = ['#7c6bff','#0ea5e9','#10b981','#f59e0b','#ef4444','#ec4899','#8b5cf6','#06b6d4'];
const AVA_EMOJIS = ['😀','😎','🥳','😈','👻','🤖','👽','🦊','🐺','🐻','🦁','🐯','🐸','🐧','🦉','🦋','🌟','🔥','⚡','💎','🌈','🎭','🎨','🎯','🏆','💪','🚀','🌙','☀️','❄️','🍀','✨','🎃','🎆','🎇','💫','🌸','🌺','🌻','🍉','🍕','🍦','🦄','🐲','🦅','🐬','🎸','🎮','⚽','🏀','🌍','🏔️','🌊','🌋','🎱','🃏','🎪','🏝️'];
const EMO_CATS = [
  {l:'😀',n:'Смайлы',e:['😀','😃','😄','😁','😆','😅','😂','🤣','😊','😇','🙂','🙃','😉','😌','😍','🥰','😘','😋','😛','😝','😜','🤪','🤨','🧐','🤓','😎','🤩','🥳','😏','😒','😞','😔','😟','😕','🙁','😣','😖','😫','😩','🥺','😢','😭','😤','😠','😡','🤬','🤯','😳','🥵','🥶','😱','😨','😰','😥','😓','🤗','🤔','🤭','🤫','🤥','😶','😐','😑','😬','🙄','😯','😦','😮','😲','🥱','😴','😵','🤐','🥴','🤢','🤮','🤧','😷','🤒','🤕']},
  {l:'👍',n:'Жесты',e:['👍','👎','👊','✊','🤛','🤜','🤞','✌️','🤟','🤘','👌','🤌','🤏','👈','👉','👆','👇','☝️','👋','🤚','🖐️','✋','🖖','💪','🦾','🙏','🤝','🫶','💅','🤳','🤙','🫵','👏','🙌']},
  {l:'❤️',n:'Символы',e:['❤️','🧡','💛','💚','💙','💜','🖤','🤍','🤎','💔','❣️','💕','💞','💓','💗','💖','💘','💝','❤️‍🔥','❤️‍🩹','💌','💋','💯','✨','🔥','⚡','🌟','💫','🎉','🎊','🎈','🪄','🏆','🥇','🎖️','🎗️','☮️','☯️','♾️']},
  {l:'🌍',n:'Природа',e:['🌍','🌎','🌏','🌋','🏔️','⛰️','🌄','🌅','🌆','🌇','🌉','🌌','🌠','🌤️','⛅','☁️','🌧️','⛈️','🌩️','🌨️','❄️','☃️','⛄','💨','💧','💦','🌊','🌈','☀️','🌙','⭐','🌟','🌸','🌺','🌻','🌹','🍀','🌿','🌱','🌲','🌳','🍁','🍂']},
  {l:'🍕',n:'Еда',e:['🍕','🍔','🌮','🌯','🥙','🧆','🥚','🍳','🥞','🧇','🥓','🥩','🍗','🍖','🌭','🍟','🍿','🥫','🍱','🍜','🍝','🍛','🍲','🥣','🥗','🍣','🦞','🦀','🦐','🦑','🍦','🧁','🍰','🎂','🍮','🍭','🍬','🍫','☕','🍵','🧃','🍺','🍻','🥂','🍾']},
  {l:'⚽',n:'Спорт',e:['⚽','🏀','🏈','⚾','🥎','🎾','🏐','🏉','🥏','🎱','🪀','🏓','🏸','🏒','🥍','🏏','🪃','🥅','⛳','🪁','🎣','🤿','🎽','🎿','🛷','🥋','🎯','🎳','🎮','🎲','♟️','🏋️','⛷️','🏊','🧘','🏄','🚴','🤸','🏇']},
  {l:'🚀',n:'Транспорт',e:['🚀','✈️','🛸','🚁','🛩️','🚂','🚄','🚅','🚇','🚌','🚗','🚙','🛻','🚕','🏎️','🏍️','🛵','🚲','🛴','🛹','⛽','🚨','🚥','🚦','🗺️','🗽','🗼','🏰','🏯','⛩️','⛪','🏟️','🏛️']},
  {l:'💡',n:'Объекты',e:['💡','🔦','🕯️','💻','🖥️','📱','☎️','📺','📻','🎙️','🧭','⏱️','⏰','📡','🔋','🔌','📔','📕','📖','📚','📝','✏️','🖊️','✂️','🗑️','🔒','🔓','🗝️','🔨','🪓','🔧','🔩','🪛','🧲','🪜','🧸','🎁','🎀','🎊','🪆']},
];

const STATUS_LABELS = {
  online: 'В сети',
  idle: 'Отсутствую',
  dnd: 'Не беспокоить',
  invisible: 'Невидимый',
  offline: 'Не в сети'
};

// ═══════════════ DEVELOPERS ═══════════════
const DEV_USERNAMES = ['@boss', '@vyyxek'];
function isDeveloper(user) {
  if (!user) return false;
  return DEV_USERNAMES.includes((user.username || '').toLowerCase());
}
function devBadgeHtml() {
  // 5-pointed star SVG path
  return `<div class="dev-badge"><svg viewBox="0 0 24 24"><polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/></svg></div>`;
}

// ═══════════════ VERIFIED USERS ═══════════════
let VERIFIED_USERS = new Set(); // UIDs с галочкой верификации
const VERIFIED_USERNAMES = ['@imgoodandsmart']; // Юзернеймы верифицированных по умолчанию

async function loadVerifiedUsers() {
  try {
    const d = await api('GET', '/admin/verified-list');
    if (d && d.verified) {
      VERIFIED_USERS = new Set(d.verified);
    }
  } catch {}
}

function isVerified(user) {
  if (!user) return false;
  const uid = user.id || user.uid;
  const uname = (user.username || '').toLowerCase();
  return VERIFIED_USERS.has(uid) || user.verified === true || VERIFIED_USERNAMES.includes(uname);
}

function verifiedBadgeHtml(size) {
  const s = size || 16;
  return `<div class="verified-badge" style="width:${s}px;height:${s}px"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>`;
}



// ═══════════════ API CLIENT ═══════════════
// Токен в памяти + sessionStorage (не localStorage — меньше риска XSS persistence)
let TOKEN = sessionStorage.getItem('pz_token') || localStorage.getItem('pz_token');

async function api(method, path, body) {
  const opts = { method, headers: {'Content-Type':'application/json'} };
  if (TOKEN) opts.headers['Authorization'] = 'Bearer ' + TOKEN;
  if (body !== undefined) opts.body = JSON.stringify(body);
  const r = await fetch(path, opts);
  const data = await r.json();
  if (!r.ok) throw new Error(data.error || 'Ошибка сервера');
  return data;
}

// ═══════════════ STATE ═══════════════
let ME = null, CONTACTS = [], MESSAGES = {}, CUR = null, REPLY = null, CTX_ID = null;
let BLOCKED_USERS = new Set(); // UID'ы которых я заблокировал
let BLOCKED_BY = new Set();    // UID'ы которые заблокировали меня
let PINNED = (() => { try { return JSON.parse(localStorage.getItem('pz_pinned')||'{}'); } catch{return {};} })(); // uid -> {text, type, id}
let CALL_TMR = null, CALL_SEC = 0, MUTED = new Set();
let authMode = 'reg', RP_ON = false;
let pendingFile = null;
let sseConn = null;
// Хранит статусы: uid -> 'online'|'idle'|'dnd'|'offline'
let PRESENCES = {};
let MY_STATUS = 'online'; // Свой настоящий статус

// ═══════════════ AUDIO ═══════════════
let audioCtx = null;
let ringtoneNodes = [], ringtoneInterval = null, ringtoneActive = false;

function getAudioCtx() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  return audioCtx;
}

function playRingtone() {
  if (!ringtoneActive) return; // Guard: don't play if stopped
  stopRingtoneNodes();
  const ctx = getAudioCtx();
  if (ctx.state === 'suspended') ctx.resume();

  // Красивый современный рингтон — два мелодичных аккорда
  const melody = [
    {freq: 880,  start: 0,    dur: 0.18, vol: 0.13},
    {freq: 1108, start: 0.02, dur: 0.18, vol: 0.10},
    {freq: 1320, start: 0.04, dur: 0.22, vol: 0.08},
    {freq: 880,  start: 0.32, dur: 0.18, vol: 0.13},
    {freq: 987,  start: 0.34, dur: 0.18, vol: 0.10},
    {freq: 1174, start: 0.36, dur: 0.22, vol: 0.08},
  ];

  ringtoneNodes = [];
  const base = ctx.currentTime + 0.05;

  melody.forEach(({freq, start, dur, vol}) => {
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    const filter = ctx.createBiquadFilter();

    osc.type = 'sine';
    osc.frequency.setValueAtTime(freq, base + start);
    osc.frequency.exponentialRampToValueAtTime(freq * 0.995, base + start + dur);

    filter.type = 'lowpass';
    filter.frequency.value = 3000;

    gain.gain.setValueAtTime(0, base + start);
    gain.gain.linearRampToValueAtTime(vol, base + start + 0.03);
    gain.gain.exponentialRampToValueAtTime(0.001, base + start + dur + 0.08);

    osc.connect(filter);
    filter.connect(gain);
    gain.connect(ctx.destination);
    osc.start(base + start);
    osc.stop(base + start + dur + 0.12);
    ringtoneNodes.push({o: osc, g: gain});
  });

  if (ringtoneInterval) { clearInterval(ringtoneInterval); ringtoneInterval = null; }
  ringtoneInterval = setInterval(playRingtone, 1800);
}

function stopRingtoneNodes() {
  ringtoneNodes.forEach(n => { try { n.o.stop(0); } catch {} });
  ringtoneNodes = [];
}

function startRingtone() {
  ringtoneActive = true;
  playRingtone();
}

function stopRingtone() {
  ringtoneActive = false;
  clearInterval(ringtoneInterval);
  ringtoneInterval = null;
  stopRingtoneNodes();
}

function playCallEnd() {
  const ctx = getAudioCtx();
  const o = ctx.createOscillator(), g = ctx.createGain();
  o.connect(g); g.connect(ctx.destination);
  o.frequency.value = 340; o.type = 'sine';
  g.gain.setValueAtTime(0.1, ctx.currentTime);
  g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime+0.8);
  o.start(ctx.currentTime); o.stop(ctx.currentTime+0.8);
}

function playMsgSound() {
  try {
    const ctx = getAudioCtx();
    const o = ctx.createOscillator(), g = ctx.createGain();
    o.connect(g); g.connect(ctx.destination);
    o.frequency.setValueAtTime(800, ctx.currentTime);
    o.frequency.linearRampToValueAtTime(1200, ctx.currentTime+0.05);
    o.type = 'sine';
    g.gain.setValueAtTime(0.06, ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime+0.15);
    o.start(ctx.currentTime); o.stop(ctx.currentTime+0.15);
  } catch {}
}

// ═══════════════ UTILS ═══════════════
function escH(s) { if (!s) return ''; return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }
function nowT() { return new Date().toLocaleTimeString('ru',{hour:'2-digit',minute:'2-digit'}); }
function todayStr() { return new Date().toLocaleDateString('ru',{day:'numeric',month:'long'}); }
function fmtSize(b) { if (b<1024) return b+'B'; if (b<1048576) return (b/1024).toFixed(1)+'KB'; return (b/1048576).toFixed(1)+'MB'; }
function fileEmo(type) { if(!type)return'📎';if(type.startsWith('image'))return'🖼️';if(type.startsWith('video'))return'🎬';if(type.startsWith('audio'))return'🎵';if(type.includes('pdf'))return'📄';if(type.includes('zip')||type.includes('rar'))return'🗜️';if(type.includes('word')||type.includes('doc'))return'📝';return'📎'; }

function setAvaEl(el, user) {
  if (!el) return;
  // Убираем только содержимое, не presence-ring
  Array.from(el.childNodes).forEach(n => {
    if (!n.classList || !n.classList.contains('presence-ring')) n.remove();
  });
  if (user.avaImg) {
    const img = document.createElement('img');
    img.src = user.avaImg; img.alt = '';
    el.insertBefore(img, el.firstChild);
    el.style.background = 'var(--surface2)';
  } else if (user.avaEmo) {
    const span = document.createElement('span');
    span.textContent = user.avaEmo;
    el.insertBefore(span, el.firstChild);
    el.style.background = 'var(--surface2)';
    el.style.fontSize = 'inherit';
  } else {
    const span = document.createElement('span');
    span.textContent = (user.name||'?')[0].toUpperCase();
    el.insertBefore(span, el.firstChild);
    el.style.background = GRADS[user.color||0];
  }
}

// Обновить CSS-класс индикатора присутствия
function applyPresenceRing(ringEl, status) {
  if (!ringEl) return;
  ringEl.className = 'presence-ring ' + (status||'offline');
}

// Получить эффективный статус пользователя
function getPresence(uid) {
  if (!uid) return 'offline';
  return PRESENCES[uid] || 'offline';
}

// ═══════════════ AUTH ═══════════════
function setMode(m, btn) {
  authMode = m;
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('on'));
  btn.classList.add('on');
  const r = m === 'reg';
  document.getElementById('reg-extra').classList.toggle('hidden', !r);
  document.getElementById('a-title').textContent = r ? 'Создать аккаунт' : 'С возвращением';
  document.getElementById('a-sub').textContent = r ? 'Регистрация бесплатна' : 'Войдите в свой аккаунт';
  document.getElementById('a-btn').textContent = r ? 'Зарегистрироваться →' : 'Войти →';
  document.getElementById('a-err').classList.remove('on');
}

function showErr(m) { const e = document.getElementById('a-err'); e.textContent = m; e.classList.add('on'); }

async function doAuth() {
  document.getElementById('a-err').classList.remove('on');
  const email = document.getElementById('f-email').value.trim();
  const pass = document.getElementById('f-pass').value;
  if (!email||!pass) { showErr('Заполните все поля'); return; }
  if (!email.includes('@')) { showErr('Некорректный email'); return; }
  if (pass.length < 6) { showErr('Пароль минимум 6 символов'); return; }
  try {
    let res;
    if (authMode === 'reg') {
      const name = document.getElementById('f-name').value.trim();
      const uname = document.getElementById('f-uname').value.trim().replace(/^@/,'');
      if (!name) { showErr('Введите имя'); return; }
      if (!uname || uname.length < 3) { showErr('Username минимум 3 символа'); return; }
      if (/\s/.test(uname)) { showErr('Username без пробелов'); return; }
      res = await api('POST','/auth/register',{email,password:pass,name,username:uname});
    } else {
      res = await api('POST','/auth/login',{email,password:pass});
    }
    // Check if banned
    if (res.banned || (res.user && res.user.banned)) {
      showBanScreen(res.banReason || res.user?.banReason || 'Нарушение правил', res.banUntil || res.user?.banUntil);
      return;
    }
    TOKEN = res.token;
    sessionStorage.setItem('pz_token', TOKEN);
    localStorage.setItem('pz_token', TOKEN);
    ME = res.user;
    MY_STATUS = ME.status || 'online';
    startApp();
  } catch(e) {
    // Check if the error indicates a ban
    if (e.message && (e.message.toLowerCase().includes('заблок') || e.message.toLowerCase().includes('бан') || e.message.toLowerCase().includes('banned'))) {
      showBanScreen(e.message, 0);
      return;
    }
    showErr(e.message);
  }
}

async function doLogout() {
  try { await api('POST','/auth/logout'); } catch {}
  TOKEN = null;
  sessionStorage.removeItem('pz_token');
  localStorage.removeItem('pz_token');
  if (sseConn) { sseConn.close(); sseConn = null; }
  ME = null; CUR = null; CONTACTS = []; MESSAGES = {}; PRESENCES = {};
  document.getElementById('app').classList.remove('on');
  document.getElementById('auth').style.display = 'flex';
  closeProfile();
}

// ═══════════════ STATUS SYSTEM ═══════════════
function toggleStatusMenu(e) {
  e.stopPropagation();
  document.getElementById('status-menu').classList.toggle('on');
}

async function setStatus(status) {
  document.getElementById('status-menu').classList.remove('on');
  try {
    await api('PATCH', '/me/status', {status});
    MY_STATUS = status;
    updateMyStatusUI(status);
  } catch(e) {
    showNotif(null,'⚠️ Ошибка', e.message);
  }
}

function updateMyStatusUI(status) {
  MY_STATUS = status;
  const dot = document.getElementById('my-status-dot');
  const txt = document.getElementById('my-status-txt');
  const ring = document.getElementById('my-presence-ring');
  if (dot) { dot.className = 'sb-status-dot ' + status; }
  if (txt) { txt.textContent = STATUS_LABELS[status] || status; }
  applyPresenceRing(ring, status);
  // Подсветить активный пункт меню
  document.querySelectorAll('.status-opt').forEach(el => el.classList.remove('active'));
  document.querySelectorAll('.status-opt').forEach(el => {
    const dot2 = el.querySelector('.status-opt-dot');
    if (dot2 && dot2.classList.contains(status)) el.classList.add('active');
  });
}

// ═══════════════ SYSTEM CONTACT ═══════════════
function getSysContact() {
  return {id:SYS_ID,name:'Перезажигал',username:'@perezazhigal',avaImg:EMPIRE_IMG,avaEmo:null,color:0,online:true,bio:'Официальный канал',isSystem:true};
}

function ensureSystem() {
  CONTACTS = CONTACTS.filter(c=>c.id!==SYS_ID);
  CONTACTS.unshift(getSysContact());
  if (!MESSAGES[SYS_ID]) {
    MESSAGES[SYS_ID] = [
      {id:'sys1', from:'them', fromUid:SYS_ID, toUid:ME?.uid, text:'⚜️ Добро пожаловать в Империю Перезажигал!', time:'12:00', timestamp:0, read:true, type:'text'},
      {id:'sys2', from:'them', fromUid:SYS_ID, toUid:ME?.uid, text:'Здесь ты можешь общаться с друзьями, звонить и делиться файлами.', time:'12:00', timestamp:1, read:true, type:'text'},
      {id:'sys3', from:'them', fromUid:SYS_ID, toUid:ME?.uid, text:'Найди собеседника через кнопку 🔍 или кнопку «Найти собеседника» внизу.', time:'12:01', timestamp:2, read:true, type:'text'},
    ];
  }
}

// ═══════════════ START APP ═══════════════
async function startApp() {
  document.getElementById('auth').style.display = 'none';
  document.getElementById('app').classList.add('on');
  await loadContacts();
  await loadBlockLists();
  loadVerifiedUsers(); // load verified badges (non-blocking)
  ensureSystem();
  // Apply saved cosmetics
  setTimeout(()=>{ 
    applyCosmetics();
    if (COSM.effect && COSM.effect !== 'none') startEffect(COSM.effect);
  }, 100);
  buildEmoPanel();
  renderSidebar();
  connectSSE();
  updateMyStatusUI(MY_STATUS);
  setTimeout(updateOnlineCount, 800);
  setTimeout(updateOnlineCount, 500);
  initScrollBtn();
  showNotif(EMPIRE_IMG,'Перезажигал',`Добро пожаловать, ${ME.name}!`,true);
  updateAdminTrigger();
}

function skeletonChatList(n=5) {
  return Array.from({length:n}, () => `
    <div class="sk-item">
      <div class="sk-ava skeleton"></div>
      <div class="sk-lines">
        <div class="sk-name skeleton"></div>
        <div class="sk-prev skeleton"></div>
      </div>
    </div>`).join('');
}

async function loadContacts() {
  const el = document.getElementById('chat-list');
  if (el) el.innerHTML = skeletonChatList(5);
  try {
    const convs = await api('GET','/conversations');
    CONTACTS = CONTACTS.filter(c=>c.isSystem);
    convs.forEach(c => {
      const u = c.user || c;
      if (!u || !u.uid) return;
      if (!CONTACTS.find(x=>x.id===u.uid)) {
        CONTACTS.push({
          id:u.uid, name:u.name, username:u.username||'',
          avaEmo:u.avaEmo, avaImg:u.avaImg, color:u.color||0,
          bio:u.bio||'', isSystem:false, verified:u.verified||false
        });
      }
      // Обновляем presence
      if (c.status) PRESENCES[u.uid] = c.status;
      else if (c.online) PRESENCES[u.uid] = 'online';
    });
  } catch(e) {
    console.warn('loadContacts error', e);
  }
}

// ═══════════════ LOAD MESSAGES (БАГ ИСПРАВЛЕН) ═══════════════
async function loadMessages(uid) {
  if (uid === SYS_ID) return;
  try {
    const msgs = await api('GET', `/messages/${uid}`);
    // Сервер теперь возвращает from=UID, to=UID
    // Правильно определяем 'me'/'them' по from === ME.uid
    MESSAGES[uid] = msgs.map(m => ({
      id: m.id,
      from: m.from === ME.uid ? 'me' : 'them',  // ← БАГ ИСПРАВЛЕН
      fromUid: m.from,
      toUid: m.to,
      text: m.text || '',
      type: m.type || 'text',
      dataUrl: m.dataUrl || null,
      fileName: m.fileName || null,
      fileSize: m.fileSize || null,
      fileType: m.fileType || null,
      reply: m.reply || null,
      time: m.time || '',             // ← поле time (не timeStr), сервер вернёт его
      timestamp: m.timestamp || 0,
      read: !!m.read
    }));
  } catch(e) {
    console.warn('loadMessages error', e);
    if (!MESSAGES[uid]) MESSAGES[uid] = [];
  }
}

// ═══════════════ SSE ═══════════════
function connectSSE() {
  if (sseConn) sseConn.close();
  sseConn = new EventSource(`/events?token=${TOKEN}`);

  sseConn.onopen = () => {
    console.log('SSE connected');
    api('GET','/online').then(data=>{
      const presences = data.presences || {};
      Object.assign(PRESENCES, presences);
      // Свой настоящий статус
      if (ME && presences[ME.uid]) MY_STATUS = presences[ME.uid];
      renderSidebar();
      updateMyStatusUI(MY_STATUS);
      updateOnlineCount();
    }).catch(()=>{});
  };

  // Новое сообщение
  sseConn.addEventListener('message', e=>{
    try {
      const msg = JSON.parse(e.data);
      handleNewMessage(msg);
    } catch(err) { console.warn('SSE message parse error', err); }
  });

  // Presence update (Discord-style: online/idle/dnd/offline)
  sseConn.addEventListener('user_presence', e=>{
    try {
      const {uid, status} = JSON.parse(e.data);
      PRESENCES[uid] = status;
      updatePresenceUI(uid, status);
    } catch {}
  });

  // Свой статус (invisible → мы сами видим 'invisible', другие видят 'offline')
  sseConn.addEventListener('my_status', e=>{
    try {
      const {status} = JSON.parse(e.data);
      MY_STATUS = status;
      updateMyStatusUI(status);
    } catch {}
  });

  // Read receipt
  sseConn.addEventListener('messages_read', e=>{
    try {
      const {by} = JSON.parse(e.data);
      const msgs = MESSAGES[by] || [];
      msgs.forEach(m=>{ if (m.from==='me') m.read = true; });
      if (CUR && CUR.id===by) renderMsgs(by);
    } catch {}
  });

  // Message deleted
  sseConn.addEventListener('message_deleted', e=>{
    try {
      const {msgId} = JSON.parse(e.data);
      Object.keys(MESSAGES).forEach(uid=>{
        MESSAGES[uid] = MESSAGES[uid].filter(m=>m.id!==msgId);
      });
      if (CUR) renderMsgs(CUR.id);
    } catch {}
  });

  // WebRTC signal
  sseConn.addEventListener('rtc_signal', e=>{
    try {
      const data = JSON.parse(e.data);
      const sig = {...data.signal, fromUid: data.from};
      handleRTCSignal(sig);
    } catch {}
  });

  sseConn.addEventListener('blocked_by', e=>{
    try {
      const data = JSON.parse(e.data);
      BLOCKED_BY.add(data.uid);
      if (CUR && CUR.id === data.uid) { updateBlockUI(); updateChatBlockedState(); }
      showNotif(null,'🚫 Блокировка','Пользователь заблокировал вас');
    } catch {}
  });

  sseConn.addEventListener('unblocked_by', e=>{
    try {
      const data = JSON.parse(e.data);
      BLOCKED_BY.delete(data.uid);
      if (CUR && CUR.id === data.uid) { updateBlockUI(); updateChatBlockedState(); }
    } catch {}
  });

  // Typing indicator
  sseConn.addEventListener('typing', e=>{
    try {
      const {uid, active} = JSON.parse(e.data);
      if (!CUR || CUR.id !== uid) return;
      const typingEl = document.getElementById('typing');
      const typingNameEl = document.getElementById('typing-name-txt');
      if (!typingEl) return;
      if (active) {
        if (typingNameEl) typingNameEl.textContent = CUR.name || '';
        typingEl.classList.add('on');
      } else {
        typingEl.classList.remove('on');
      }
    } catch {}
  });

  // ═══ ADMIN SSE EVENTS ═══

  // Системная рассылка всем
  sseConn.addEventListener('system_broadcast', e=>{
    try {
      const {text, type, from} = JSON.parse(e.data);
      const icons = {info:'📢', warning:'⚠️', danger:'🚨'};
      const icon = icons[type] || '📢';
      showNotif(null, `${icon} Сообщение от администрации`, text);
      // Добавляем в системный чат — просто сам текст без префикса
      const sysMsg = {
        id: 'bcast_' + Date.now(),
        from: 'them', fromUid: SYS_ID, toUid: ME?.uid,
        text: text,
        time: new Date().toLocaleTimeString('ru',{hour:'2-digit',minute:'2-digit'}),
        timestamp: Date.now(), read: true, type: 'text'
      };
      if (!MESSAGES[SYS_ID]) MESSAGES[SYS_ID] = [];
      MESSAGES[SYS_ID].push(sysMsg);
      if (CUR && CUR.id === SYS_ID) renderMsgs(SYS_ID);
      if (Notification.permission === 'granted') {
        new Notification(`${icon} Перезажигал`, {body: text, icon: EMPIRE_IMG});
      }
    } catch(err) { console.warn('system_broadcast error', err); }
  });

  // Личное уведомление от админа
  sseConn.addEventListener('admin_message', e=>{
    try {
      const {text, type, from} = JSON.parse(e.data);
      const icons = {info:'💬', warning:'⚠️', danger:'🚨'};
      const icon = icons[type] || '💬';
      showNotif(null, `${icon} Сообщение от администратора`, text);
      // Добавляем в системный чат
      const sysMsg = {
        id: 'admmsg_' + Date.now(),
        from: 'them', fromUid: SYS_ID, toUid: ME?.uid,
        text: `${icon} <b>Адм. ${from}:</b> ${text}`,
        time: new Date().toLocaleTimeString('ru',{hour:'2-digit',minute:'2-digit'}),
        timestamp: Date.now(), read: true, type: 'text'
      };
      if (!MESSAGES[SYS_ID]) MESSAGES[SYS_ID] = [];
      MESSAGES[SYS_ID].push(sysMsg);
      if (CUR && CUR.id === SYS_ID) renderMsgs(SYS_ID);
    } catch(err) { console.warn('admin_message error', err); }
  });

  // Принудительный выход (бан/кик/удаление аккаунта)
  sseConn.addEventListener('force_logout', e=>{
    try {
      const data = JSON.parse(e.data || '{}');
      const reason = data.reason || 'Выход по решению администратора';
      const isKick = data.kick === true;
      if (sseConn) { sseConn.close(); sseConn = null; }
      TOKEN = null;
      localStorage.removeItem('pz_token');
      sessionStorage.removeItem('pz_token');
      ME = null;
      if (isKick) {
        showKickScreen(reason);
      } else {
        showBanScreen(reason, data.banUntil);
      }
    } catch(err) { console.warn('force_logout error', err); location.reload(); }
  });

  // Различные события от администратора
  sseConn.addEventListener('admin_event', e=>{
    try {
      const {type, ...data} = JSON.parse(e.data);

      if (type === 'user_deleted') {
        // Удалили какого-то пользователя — убираем из контактов
        const uid = data.uid;
        CONTACTS = CONTACTS.filter(c => c.id !== uid);
        if (CUR && CUR.id === uid) {
          CUR = null;
          document.getElementById('chat-area').style.display = 'none';
          document.getElementById('empty-state').style.display = '';
        }
        renderSidebar();
      }

      else if (type === 'profile_updated') {
        // Обновили профиль пользователя
        const {uid, fields} = data;
        const contact = CONTACTS.find(c => c.id === uid);
        if (contact) {
          Object.assign(contact, fields);
          renderSidebar();
          if (CUR && CUR.id === uid) {
            Object.assign(CUR, fields);
            renderChatHeader();
          }
        }
      }

      else if (type === 'messages_cleared') {
        // Очистили сообщения конкретного пользователя
        const uid = data.uid;
        if (MESSAGES[uid]) MESSAGES[uid] = [];
        if (CUR && CUR.id === uid) renderMsgs(uid);
      }

      else if (type === 'all_messages_cleared') {
        // Очистили все сообщения
        Object.keys(MESSAGES).forEach(k => { MESSAGES[k] = []; });
        if (CUR) renderMsgs(CUR.id);
        showNotif(null, '🗑️ Все сообщения удалены', 'Администратор очистил историю');
      }

      else if (type === 'muted') {
        const until = data.muteUntil === 0 ? 'бессрочно' :
          new Date(data.muteUntil).toLocaleString('ru');
        showNotif(null, '🔇 Вы замьючены', `Причина: ${data.reason || 'Нарушение правил'}\nДо: ${until}`);
        const sysMsg = {
          id: 'mute_' + Date.now(),
          from: 'them', fromUid: SYS_ID, toUid: ME?.uid,
          text: `🔇 <b>Вы замьючены.</b> Причина: ${data.reason || 'Нарушение правил'}. До: ${until}`,
          time: new Date().toLocaleTimeString('ru',{hour:'2-digit',minute:'2-digit'}),
          timestamp: Date.now(), read: true, type: 'text'
        };
        if (!MESSAGES[SYS_ID]) MESSAGES[SYS_ID] = [];
        MESSAGES[SYS_ID].push(sysMsg);
        if (CUR && CUR.id === SYS_ID) renderMsgs(SYS_ID);
      }

      else if (type === 'unmuted') {
        showNotif(null, '🔊 Мьют снят', 'Вы снова можете отправлять сообщения');
      }

      else if (type === 'warning') {
        const count = data.count || 1;
        showNotif(null, `⚠️ Предупреждение (${count}/3)`,
          `Причина: ${data.reason || 'Нарушение правил'}${count >= 3 ? '\n⛔ Следующее — автобан!' : ''}`);
        const sysMsg = {
          id: 'warn_' + Date.now(),
          from: 'them', fromUid: SYS_ID, toUid: ME?.uid,
          text: `⚠️ <b>Предупреждение ${count}/3.</b> Причина: ${data.reason || 'Нарушение правил'}`,
          time: new Date().toLocaleTimeString('ru',{hour:'2-digit',minute:'2-digit'}),
          timestamp: Date.now(), read: true, type: 'text'
        };
        if (!MESSAGES[SYS_ID]) MESSAGES[SYS_ID] = [];
        MESSAGES[SYS_ID].push(sysMsg);
        if (CUR && CUR.id === SYS_ID) renderMsgs(SYS_ID);
      }
    } catch(err) { console.warn('admin_event error', err); }
  });

  sseConn.onerror = ()=>{
    setTimeout(()=>{ if (TOKEN) connectSSE(); }, 3000);
  };
}

function handleNewMessage(msg) {
  // msg.from = UID отправителя, msg.to = UID получателя
  const fromUid = msg.from || msg.fromUid;
  const toUid   = msg.to   || msg.toUid;
  if (!fromUid) return;

  const cid = fromUid === ME.uid ? toUid : fromUid;
  if (!MESSAGES[cid]) MESSAGES[cid] = [];

  // Если это наше сообщение — сервер подтверждает. Только обновляем данные у оптимистичной записи.
  if (fromUid === ME.uid) {
    const opt = MESSAGES[cid].find(m => m._optimistic && m.type === (msg.type||'text') && Math.abs(m.timestamp - (msg.timestamp||0)) < 10000);
    if (opt) {
      // Обновляем id и данные без перерисова
      const oldId = opt.id;
      opt.id = msg.id; opt.time = msg.time || opt.time; opt.timestamp = msg.timestamp || opt.timestamp;
      delete opt._optimistic;
      // Обновляем data-id в DOM
      const row = document.querySelector(`[data-id="${oldId}"]`);
      if (row) row.setAttribute('data-id', msg.id);
    } else if (!MESSAGES[cid].find(x=>x.id===msg.id)) {
      // Запасной вариант — добавляем если не нашли оптимистичный
      const mapped = mapMsg(msg, fromUid);
      MESSAGES[cid].push(mapped);
      if (CUR && CUR.id === cid) appendSingleMsg(cid, mapped);
    }
    renderSidebar();
    return;
  }

  // Входящее сообщение
  const mapped = mapMsg(msg, fromUid);
  if (MESSAGES[cid].find(x=>x.id===msg.id)) return; // дедупликация
  MESSAGES[cid].push(mapped);

  if (CUR && CUR.id === cid) {
    mapped.read = true;
    appendSingleMsg(cid, mapped);
    api('PATCH',`/messages/${cid}/read`).catch(()=>{});
    maybeShowScrollBadge();
  }

  // Добавляем контакт если его нет
  if (!CONTACTS.find(c=>c.id===cid) && fromUid !== ME.uid) {
    api('GET',`/users/${fromUid}`).then(u=>{
      CONTACTS.push({id:u.uid, name:u.name, username:u.username||'', avaEmo:u.avaEmo, avaImg:u.avaImg, color:u.color||0, online:true, bio:u.bio||'', verified:u.verified||false});
      renderSidebar();
    }).catch(()=>{});
  }
  renderSidebar();
}

function mapMsg(msg, fromUid) {
  return {
    id: msg.id,
    from: fromUid === ME.uid ? 'me' : 'them',
    fromUid: fromUid,
    toUid: msg.to || msg.toUid,
    text: msg.text || '',
    type: msg.type || 'text',
    dataUrl: msg.dataUrl || null,
    fileName: msg.fileName || null,
    fileSize: msg.fileSize || null,
    fileType: msg.fileType || null,
    reply: msg.reply || null,
    time: msg.time || '',
    timestamp: msg.timestamp || 0,
    read: !!msg.read
  };
}

function updatePresenceUI(uid, status) {
  const c = CONTACTS.find(x=>x.id===uid);
  if (c) c.online = (status !== 'offline');
  if (CUR && CUR.id === uid) {
    setHeaderStatus(status);
    updateRightPanel();
  }
  renderSidebar();
}

function setHeaderStatus(status) {
  const dot = document.getElementById('ch-status-dot');
  const txt = document.getElementById('ch-status-txt');
  if (dot) dot.className = 'hdr-status-dot ' + status;
  if (txt) {
    txt.className = 'hdr-status-txt ' + status;
    txt.textContent = STATUS_LABELS[status] || 'Не в сети';
  }
}

// ═══════════════ SIDEBAR ═══════════════
function renderSidebar() {
  const myAva = document.getElementById('my-ava');
  setAvaEl(myAva, ME);
  document.getElementById('my-name').textContent = ME.name;
  renderChatList(CONTACTS);
}

function renderChatList(list) {
  const el = document.getElementById('chat-list');
  if (!list.length) {
    el.innerHTML = '<div style="padding:28px 18px;text-align:center;color:var(--text3);font-size:13px;line-height:1.7">Нет чатов.<br>Нажмите «Найти собеседника».</div>';
    return;
  }
  el.innerHTML = list.map(c => {
    const msgs = MESSAGES[c.id] || [];
    const last = msgs[msgs.length-1];
    const unread = msgs.filter(m=>m.from!=='me'&&!m.read).length;
    let prev = 'Нет сообщений';
    if (last) {
      if (last.type==='img') prev = '📷 Фото';
      else if (last.type==='file') prev = `📎 ${last.fileName||'Файл'}`;
      else if (last.type==='audio') prev = '🎵 Аудио';
      else prev = last.text || '';
    }
    const active = CUR?.id === c.id;
    let avaHtml = '';
    if (c.avaImg)  avaHtml = `<img src="${c.avaImg}" alt="" style="width:100%;height:100%;object-fit:cover;border-radius:50%">`;
    else if (c.avaEmo) avaHtml = c.avaEmo;
    else avaHtml = (c.name||'?')[0].toUpperCase();
    const bg = c.avaImg||c.avaEmo ? 'background:var(--surface2)' : 'background:'+GRADS[c.color||0];
    const verEl = (c.isSystem || isVerified(c)) ? `<div class="verified-badge"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>` : '';
    const devEl = (!c.isSystem && isDeveloper(c)) ? devBadgeHtml() : '';
    const presence = c.isSystem ? 'online' : (getPresence(c.id));
    const timeStr = last?.time || '';
    return `<div class="ci${active?' on':''}" id="ci-${c.id}" onclick="openChat('${c.id}')">
      <div class="ava" style="${bg};${c.avaImg||c.avaEmo?'font-size:22px':''}">
        ${avaHtml}
        <div class="presence-ring ${presence}"></div>
      </div>
      <div class="ci-meta">
        <div class="ci-name"><span class="ci-name-txt">${escH(c.name)}</span>${verEl}${devEl||''}</div>
        <div class="ci-prev">${escH(prev)}</div>
      </div>
      <div class="ci-right">
        <div class="ci-time">${escH(timeStr)}</div>
        ${unread ? `<div class="badge">${unread}</div>` : `<div class="ci-checks"><svg width="16" height="10" viewBox="0 0 18 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 5.5L4.5 9L11 2" stroke="var(--accent3)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path d="M6 9L12.5 2" stroke="var(--accent3)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.5 9L16 2" stroke="var(--accent3)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg></div>`}
      </div>
    </div>`;
  }).join('');
}

function filterChats(q) {
  q = q.toLowerCase();
  renderChatList(q ? CONTACTS.filter(c =>
    (c.name||'').toLowerCase().includes(q) || (c.username||'').toLowerCase().includes(q)
  ) : CONTACTS);
}

function filterTab(t, btn) {
  document.querySelectorAll('.ftab').forEach(b=>b.classList.remove('on'));
  btn.classList.add('on');
  if (t==='unread') renderChatList(CONTACTS.filter(c=>(MESSAGES[c.id]||[]).some(m=>m.from!=='me'&&!m.read)));
  else if (t==='groups') renderChatList(CONTACTS.filter(c=>c.isGroup));
  else renderChatList(CONTACTS);
}

// ═══════════════ OPEN CHAT ═══════════════
async function openChat(id) {
  CUR = CONTACTS.find(c=>c.id===id);
  if (!CUR) return;

  if (id !== SYS_ID) await loadMessages(id);

  // Mark read
  const msgs = MESSAGES[id] || [];
  msgs.forEach(m=>{ if (m.from!=='me') m.read = true; });
  if (id !== SYS_ID) api('PATCH',`/messages/${id}/read`).catch(()=>{});

  document.getElementById('empty').style.display = 'none';
  document.getElementById('cv').classList.add('on');
  applyChatBg(COSM.chatBg);
  document.querySelectorAll('.ci').forEach(el=>el.classList.remove('on'));
  document.getElementById('ci-'+id)?.classList.add('on');

  const chAva = document.getElementById('ch-ava');
  // Убираем старый presence-ring из header ava
  chAva.querySelectorAll('.presence-ring').forEach(r=>r.remove());
  setAvaEl(chAva, CUR);

  document.getElementById('ch-name').textContent = CUR.name;
  const verEl = document.getElementById('ch-verified');
  if (CUR.isSystem) {
    verEl.innerHTML = `<div class="verified-badge" style="width:16px;height:16px"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>`;
  } else if (isVerified(CUR)) {
    verEl.innerHTML = `<div class="verified-badge" style="width:16px;height:16px"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>`;
  } else if (isDeveloper(CUR)) {
    verEl.innerHTML = devBadgeHtml();
  } else {
    verEl.innerHTML = '';
  }

  const presence = CUR.isSystem ? 'online' : getPresence(id);
  setHeaderStatus(presence);

  document.getElementById('btn-call-audio').style.display = CUR.isSystem ? 'none' : '';
  document.getElementById('btn-call-video').style.display = CUR.isSystem ? 'none' : '';
  // Grey out call buttons in header if blocked
  const _canCall = !hasBlocked(CUR.id) && !isBlockedBy(CUR.id);
  ['btn-call-audio','btn-call-video'].forEach(id=>{
    const b = document.getElementById(id);
    if (b) { b.style.opacity = _canCall ? '' : '.3'; b.title = _canCall ? '' : 'Недоступно при блокировке'; }
  });

  const ta = document.getElementById('typing-ava');
  ta.querySelectorAll('.presence-ring').forEach(r=>r.remove());
  setAvaEl(ta, CUR);

  updateRightPanel();
  if (CUR.isSystem) hideRP(); else { if (RP_ON) showRP(); }
  renderMsgs(id);
  renderSidebar();
  // Обновить pinned bar
  const pb = document.getElementById('pinned');
  const pt = document.getElementById('pinned-txt');
  if (pb && pt) {
    if (PINNED[id]) {
      pt.textContent = PINNED[id].text;
      pb.style.display = 'flex';
      pb.onclick = () => { const el = document.querySelector(`[data-id="${PINNED[id].id}"]`); if(el) el.scrollIntoView({behavior:'smooth',block:'center'}); };
    } else {
      pb.style.display = 'none';
    }
  }
}

function updateRightPanel() {
  if (!CUR) return;
  const rpAva = document.getElementById('rp-ava');

  // Rebuild avatar — keep only the presence-wrap
  const presenceWrap = document.getElementById('rp-presence-ring');
  Array.from(rpAva.childNodes).forEach(n => {
    if (n !== presenceWrap && n.id !== 'rp-presence-ring') n.remove();
  });
  // Insert ava content before presence wrap
  if (CUR.avaImg) {
    const img = document.createElement('img');
    img.src = CUR.avaImg; img.alt = '';
    rpAva.insertBefore(img, presenceWrap);
  } else if (CUR.avaEmo) {
    const span = document.createElement('span');
    span.textContent = CUR.avaEmo;
    rpAva.insertBefore(span, presenceWrap);
  } else {
    const letter = document.createElement('span');
    letter.textContent = (CUR.name || '?')[0].toUpperCase();
    rpAva.insertBefore(letter, presenceWrap);
  }
  // Apply color if no image
  if (!CUR.avaImg) rpAva.style.background = GRADS[CUR.color || 0];
  else rpAva.style.background = 'var(--surface)';

  // Update presence dot
  const presence = CUR.isSystem ? 'online' : getPresence(CUR.id);
  const pdot = document.getElementById('rp-pdot');
  if (pdot) {
    pdot.className = 'rp-presence-dot ' + (presence || 'offline');
  }

  // Name
  const rpNameEl = document.getElementById('rp-name');
  rpNameEl.innerHTML = '';
  const rpNameSpan = document.createElement('span');
  rpNameSpan.textContent = CUR.name;
  rpNameEl.appendChild(rpNameSpan);
  if (CUR.isSystem) {
    rpNameEl.insertAdjacentHTML('beforeend', ' <div class="verified-badge" style="width:14px;height:14px;display:inline-flex;vertical-align:middle"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>');
  } else if (isVerified(CUR)) {
    rpNameEl.insertAdjacentHTML('beforeend', ' <div class="verified-badge" style="width:14px;height:14px;display:inline-flex;vertical-align:middle"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>');
  } else if (isDeveloper(CUR)) {
    rpNameEl.insertAdjacentHTML('beforeend', ' ' + devBadgeHtml());
  }

  // Tag
  const tagEl = document.getElementById('rp-tag');
  // username may already have '@' prefix (e.g. '@boss'), don't double it
  tagEl.textContent = CUR.username ? (CUR.username.startsWith('@') ? CUR.username : '@' + CUR.username) : '';

  // Apply name style cosmetic
  const rpNameForStyle = document.getElementById('rp-name');
  if (rpNameForStyle && typeof applyNameStyleEl === 'function') applyNameStyleEl(rpNameForStyle);

  // Status pill
  const presenceColor = {online:'var(--s-online)',idle:'var(--s-idle)',dnd:'var(--s-dnd)',offline:'var(--text3)',invisible:'var(--text3)'};
  const rsEl = document.getElementById('rp-status');
  rsEl.innerHTML = `<div style="width:7px;height:7px;border-radius:50%;background:${presenceColor[presence]||'var(--text3)'};flex-shrink:0"></div><span>${STATUS_LABELS[presence]||'Не в сети'}</span>`;

  // Bio & seen
  const bioEl = document.getElementById('rp-bio');
  if (bioEl) bioEl.textContent = CUR.bio || '—';
  const seenEl = document.getElementById('rp-seen');
  if (seenEl) seenEl.textContent = presence !== 'offline' && presence !== 'invisible' ? STATUS_LABELS[presence] : 'Не в сети';

  // Show/hide acts and block row
  const rpActs = document.getElementById('rp-acts');
  if (rpActs) rpActs.style.display = CUR.isSystem ? 'none' : '';
  const blockRow = document.getElementById('rp-block-row');
  if (blockRow) blockRow.style.display = CUR.isSystem ? 'none' : '';

  // Apply ring style
  const rpWrap = document.querySelector('.rp-ava-wrap');
  if (rpWrap) {
    rpWrap.className = CUR.isSystem ? 'rp-ava-wrap ring-none' : 'rp-ava-wrap ring-' + (COSM.avaRing || 'orbit');
  }

  renderMedia(CUR.id);
  updateBlockUI();
  updateChatBlockedState();
}

// ═══════════════ MESSAGES ═══════════════
function renderMsgs(id) {
  const msgs = MESSAGES[id] || [];
  const el = document.getElementById('msgs');
  let html = `<div class="date-sep"><span>${todayStr()}</span></div>`;
  let prevFrom = null;
  msgs.forEach(m => {
    const mine = m.from === 'me';
    const showAva = !mine && prevFrom !== m.from;
    let ava = '';
    if (!mine && CUR) {
      let avaHtml = '', avaBg = '';
      if (CUR.avaImg)      { avaHtml = `<img src="${CUR.avaImg}" alt="">`; avaBg = 'background:var(--surface2)'; }
      else if (CUR.avaEmo) { avaHtml = CUR.avaEmo; avaBg = 'background:var(--surface2)'; }
      else                 { avaHtml = (CUR.name||'?')[0].toUpperCase(); avaBg = 'background:'+GRADS[CUR.color||0]; }
      ava = `<div class="ava sm${showAva?'':' hidden'}" style="${avaBg}">${avaHtml}</div>`;
    }

    const safeTime = m.time || '';  // ← никогда не будет undefined
    const replyHtml = m.reply ? `<div class="rb" onclick="scrollToMsg('${m.reply.id||''}');event.stopPropagation()">
        <div class="rb-n">${escH(m.reply.name || (m.reply.from==='me' ? (ME?.name||'Я') : (CUR?.name||'')))}</div>
        <div class="rb-t">${escH(m.reply.text||'')}</div>
      </div>` : '';

    let content = '';
    if (m.type === 'img') {
      content = `<div class="bubble${mine?' out':' in'}" style="padding:4px" oncontextmenu="showCtx(event,'${m.id}')">
        ${replyHtml}<div class="img-bbl" onclick="showLightbox('${m.dataUrl||''}')" style="margin:0">
        ${m.dataUrl ? `<img src="${m.dataUrl}" alt="" oncontextmenu="event.stopPropagation();showCtx(event,'${m.id}')">` : ''}
        <div class="bt" style="padding:4px 8px;background:rgba(0,0,0,.3);color:white;font-size:10px;border-radius:0 0 12px 12px">${safeTime}</div>
      </div></div>`;
    } else if (m.type === 'file') {
      content = `<div class="bubble${mine?' out':' in'}" oncontextmenu="showCtx(event,'${m.id}')">
        ${replyHtml}<div class="file-bbl${mine?' out':''}" onclick="downloadFile('${m.id}')" style="margin:0;border:none;padding:0">
        <div class="file-ico">${fileEmo(m.fileType)}</div>
        <div class="file-info"><div class="file-name">${escH(m.fileName||'Файл')}</div><div class="file-size">${m.fileSize||''}</div></div>
        <svg viewBox="0 0 24 24" style="width:16px;height:16px;stroke:currentColor;fill:none;stroke-width:2;opacity:.5;flex-shrink:0"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>
      </div><div class="bt" style="margin-top:4px">${safeTime}</div></div>`;
    } else {
      content = `<div class="bubble${mine?' out':' in'}" oncontextmenu="showCtx(event,'${m.id}')">
        ${replyHtml}
        ${escH(m.text)}
        <div class="bt">${safeTime}${mine ? `<span class="msg-ticks${m.read?' read':''}" title="${m.read?'Прочитано':'Доставлено'}"><svg width="18" height="11" viewBox="0 0 18 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 5.5L4.5 9L11 2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path d="M6 9L12.5 2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.5 9L16 2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg></span>` : ''}</div>
      </div>`;
    }
    html += `<div class="msg-row${mine?' me':''}" data-id="${m.id}" oncontextmenu="showCtx(event,'${m.id}')">
      ${mine ? '' : ava}
      <div class="bw">
        ${content}
        <div class="msg-actions">
          <button class="ma-btn" onclick="ctxReply('${m.id}')" title="Ответить"><svg viewBox="0 0 24 24"><polyline points="9 14 4 9 9 4"/><path d="M20 20v-7a4 4 0 00-4-4H4"/></svg></button>
          <button class="ma-btn" onclick="ctxCopy('${m.id}')" title="Копировать"><svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg></button>
          ${mine ? `<button class="ma-btn danger" onclick="ctxDelete('${m.id}')" title="Удалить"><svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a1 1 0 011-1h4a1 1 0 011 1v2"/></svg></button>` : ''}
        </div>
      </div>
    </div>`;
    prevFrom = m.from;
  });
  el.innerHTML = html;
  scrollToBottom(false);
}

function renderMedia(id) {
  const msgs = MESSAGES[id] || [];
  const imgs = msgs.filter(m=>m.type==='img'&&m.dataUrl).slice(-9);
  const grid = document.getElementById('media-grid');
  const emptyEl = document.getElementById('rp-media-empty');
  if (imgs.length) {
    if (emptyEl) emptyEl.style.display = 'none';
    grid.innerHTML = imgs.map(m=>`<div class="media-thumb" onclick="showLightbox('${m.dataUrl}')"><img src="${m.dataUrl}" alt="" loading="lazy"></div>`).join('');
  } else {
    if (emptyEl) emptyEl.style.display = '';
    grid.innerHTML = '';
  }
}

// ═══════════════ SEND ═══════════════
function msgKey(e) {
  if (e.key==='Enter' && !e.shiftKey) { e.preventDefault(); sendMsg(); }
}

function autoH(ta) {
  ta.style.height = 'auto';
  ta.style.height = Math.min(ta.scrollHeight, 120) + 'px';
}

async function sendMsg() {
  const inp = document.getElementById('msg-inp');
  const text = inp.value.trim();
  if ((!text && !pendingFile) || !CUR || CUR.isSystem) return;

  const replyName = REPLY ? (REPLY.from === 'me' ? ME.name : CUR.name) : null;
  const replyData = REPLY ? {from: REPLY.from, name: replyName, id: REPLY.id, text: REPLY.text || (REPLY.type==='img' ? '📷 Фото' : REPLY.type==='file' ? '📎 '+REPLY.fileName : '')} : null;
  const toUid = CUR.id;

  // ── Очищаем поле ввода сразу ──
  inp.value = ''; inp.style.height = 'auto';
  const sendBtn = document.getElementById('send-btn');
  if (sendBtn) sendBtn.classList.add('empty');
  const counter = document.getElementById('char-counter');
  if (counter) counter.className = 'char-counter';

  const fileCopy = pendingFile ? {...pendingFile} : null;
  cancelReply();
  if (fileCopy) cancelFile();

  if (!MESSAGES[toUid]) MESSAGES[toUid] = [];

  // ── Оптимистичный рендер: сразу добавляем сообщение с временным id ──
  const optimisticMsgs = [];
  const tempTime = nowT();

  if (fileCopy) {
    const tmpId = 'tmp_' + Date.now();
    const optimisticFile = {
      id: tmpId, _optimistic: true, from:'me', fromUid:ME.uid, toUid,
      type: fileCopy.isImg ? 'img' : 'file',
      dataUrl: fileCopy.dataUrl, fileName: fileCopy.name,
      fileSize: fileCopy.sizeStr, fileType: fileCopy.type,
      time: tempTime, timestamp: Date.now(), read:false, reply:replyData, text:''
    };
    MESSAGES[toUid].push(optimisticFile);
    optimisticMsgs.push(optimisticFile);
  }
  if (text) {
    const tmpId2 = 'tmp_' + (Date.now() + 1);
    const optimisticText = {
      id: tmpId2, _optimistic: true, from:'me', fromUid:ME.uid, toUid,
      text, type:'text', time: tempTime, timestamp: Date.now(), read:false, reply:replyData
    };
    MESSAGES[toUid].push(optimisticText);
    optimisticMsgs.push(optimisticText);
  }

  // Рендерим сразу — без ожидания сервера
  appendOptimisticMsgs(toUid, optimisticMsgs);
  playMsgSound();
  if (COSM.confettiOnSend) spawnConfetti();

  try {
    if (fileCopy) {
      const msgBody = {
        type: fileCopy.isImg ? 'img' : 'file',
        dataUrl: fileCopy.dataUrl,
        fileName: fileCopy.name,
        fileSize: fileCopy.sizeStr,
        fileType: fileCopy.type,
        reply: replyData
      };
      const saved = await api('POST', `/messages/${toUid}`, msgBody);
      // Заменяем временный id на настоящий
      const optFile = optimisticMsgs.find(m=>m.type!=='text');
      if (optFile) {
        optFile.id = saved.id; optFile.time = saved.time || tempTime;
        optFile.timestamp = saved.timestamp || Date.now();
        delete optFile._optimistic;
      }
      if (text) {
        const saved2 = await api('POST', `/messages/${toUid}`, {type:'text', text, reply:replyData});
        const optText = optimisticMsgs.find(m=>m.type==='text');
        if (optText) {
          optText.id = saved2.id; optText.time = saved2.time || tempTime;
          optText.timestamp = saved2.timestamp || Date.now();
          delete optText._optimistic;
        }
      }
    } else {
      const saved = await api('POST', `/messages/${toUid}`, {type:'text', text, reply:replyData});
      const optText = optimisticMsgs[0];
      if (optText) {
        optText.id = saved.id; optText.time = saved.time || tempTime;
        optText.timestamp = saved.timestamp || Date.now();
        delete optText._optimistic;
      }
    }

    renderSidebar();

    // Добавляем контакт в список если его нет
    if (!CONTACTS.find(c=>c.id===toUid)) {
      const u = await api('GET', `/users/${toUid}`).catch(()=>null);
      if (u) {
        CONTACTS.unshift({id:u.uid, name:u.name, username:u.username||'', avaEmo:u.avaEmo, avaImg:u.avaImg, color:u.color||0, bio:u.bio||'', verified:u.verified||false});
        renderSidebar();
      }
    }
  } catch(e) {
    // Откат оптимистичных сообщений при ошибке
    MESSAGES[toUid] = MESSAGES[toUid].filter(m=>!optimisticMsgs.includes(m));
    renderMsgs(toUid);
    showNotif(null,'⚠️ Ошибка отправки', e.message);
  }
}

// Добавляет новые сообщения в DOM без полного перерисова
function appendOptimisticMsgs(id, msgs) {
  const el = document.getElementById('msgs');
  if (!el) return;
  const allMsgs = MESSAGES[id] || [];
  msgs.forEach(m => {
    const rowHtml = buildMsgRow(m, allMsgs);
    el.insertAdjacentHTML('beforeend', rowHtml);
  });
  scrollToBottom(false);
}

// Добавляет одно входящее сообщение в DOM без полного перерисова
function appendSingleMsg(id, m) {
  const el = document.getElementById('msgs');
  if (!el) return;
  const allMsgs = MESSAGES[id] || [];
  const rowHtml = buildMsgRow(m, allMsgs);
  el.insertAdjacentHTML('beforeend', rowHtml);
  scrollToBottom(false);
}

function buildMsgRow(m, allMsgs) {
  const mine = m.from === 'me';
  const idx = allMsgs.indexOf(m);
  const prev = idx > 0 ? allMsgs[idx-1] : null;
  const showAva = !mine && (!prev || prev.from !== m.from);
  let ava = '';
  if (!mine && CUR) {
    let avaHtml = '', avaBg = '';
    if (CUR.avaImg)      { avaHtml = `<img src="${CUR.avaImg}" alt="">`; avaBg = 'background:var(--surface2)'; }
    else if (CUR.avaEmo) { avaHtml = CUR.avaEmo; avaBg = 'background:var(--surface2)'; }
    else                 { avaHtml = (CUR.name||'?')[0].toUpperCase(); avaBg = 'background:'+GRADS[CUR.color||0]; }
    ava = `<div class="ava sm${showAva?'':' hidden'}" style="${avaBg}">${avaHtml}</div>`;
  }
  const safeTime = m.time || '';
  const replyHtml = m.reply ? `<div class="rb" onclick="scrollToMsg('${m.reply.id||''}');event.stopPropagation()">
      <div class="rb-n">${escH(m.reply.name || (m.reply.from==='me' ? (ME?.name||'Я') : (CUR?.name||'')))}</div>
      <div class="rb-t">${escH(m.reply.text||'')}</div>
    </div>` : '';
  let content = '';
  if (m.type === 'img') {
    content = `<div class="bubble${mine?' out':' in'}" style="padding:4px" oncontextmenu="showCtx(event,'${m.id}')">
      ${replyHtml}<div class="img-bbl" onclick="showLightbox('${m.dataUrl||''}')" style="margin:0">
      ${m.dataUrl ? `<img src="${m.dataUrl}" alt="" oncontextmenu="event.stopPropagation();showCtx(event,'${m.id}')">` : ''}
      <div class="bt" style="padding:4px 8px;background:rgba(0,0,0,.3);color:white;font-size:10px;border-radius:0 0 12px 12px">${safeTime}</div>
    </div></div>`;
  } else if (m.type === 'file') {
    content = `<div class="bubble${mine?' out':' in'}" oncontextmenu="showCtx(event,'${m.id}')">
      ${replyHtml}<div class="file-bbl${mine?' out':''}" onclick="downloadFile('${m.id}')" style="margin:0;border:none;padding:0">
      <div class="file-ico">${fileEmo(m.fileType)}</div>
      <div class="file-info"><div class="file-name">${escH(m.fileName||'Файл')}</div><div class="file-size">${m.fileSize||''}</div></div>
      <svg viewBox="0 0 24 24" style="width:16px;height:16px;stroke:currentColor;fill:none;stroke-width:2;opacity:.5;flex-shrink:0"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>
    </div><div class="bt" style="margin-top:4px">${safeTime}</div></div>`;
  } else {
    content = `<div class="bubble${mine?' out':' in'}" oncontextmenu="showCtx(event,'${m.id}')">
      ${replyHtml}
      ${escH(m.text)}
      <div class="bt">${safeTime}${mine ? `<span class="msg-ticks${m.read?' read':''}" title="${m.read?'Прочитано':'Доставлено'}"><svg width="18" height="11" viewBox="0 0 18 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 5.5L4.5 9L11 2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path d="M6 9L12.5 2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.5 9L16 2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg></span>` : ''}</div>
    </div>`;
  }
  return `<div class="msg-row${mine?' me':''}" data-id="${m.id}" oncontextmenu="showCtx(event,'${m.id}')">
    ${mine ? '' : ava}
    <div class="bw">
      ${content}
      <div class="msg-actions">
        <button class="ma-btn" onclick="ctxReply('${m.id}')" title="Ответить"><svg viewBox="0 0 24 24"><polyline points="9 14 4 9 9 4"/><path d="M20 20v-7a4 4 0 00-4-4H4"/></svg></button>
        <button class="ma-btn" onclick="ctxCopy('${m.id}')" title="Копировать"><svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg></button>
        ${mine ? `<button class="ma-btn danger" onclick="ctxDelete('${m.id}')" title="Удалить"><svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a1 1 0 011-1h4a1 1 0 011 1v2"/></svg></button>` : ''}
      </div>
    </div>
  </div>`;
}

function onFileSelect(e) {
  const file = e.target.files[0];
  if (!file) return;
  if (file.size > 10*1024*1024) { showNotif(null,'⚠️ Ошибка','Файл не более 10 МБ'); return; }
  const reader = new FileReader();
  reader.onload = ev => {
    pendingFile = {name:file.name, size:file.size, sizeStr:fmtSize(file.size), type:file.type, dataUrl:ev.target.result, isImg:file.type.startsWith('image/')};
    document.getElementById('fp-ico').textContent = fileEmo(file.type);
    document.getElementById('fp-name').textContent = file.name;
    document.getElementById('fp-size').textContent = fmtSize(file.size);
    document.getElementById('file-prev').classList.add('on');
    const sendBtn = document.getElementById('send-btn');
    if (sendBtn) sendBtn.classList.remove('empty');
    if (file.type.startsWith('image/')) {
      document.getElementById('fp-ico').innerHTML = `<img src="${ev.target.result}" alt="" style="width:36px;height:36px;object-fit:cover;border-radius:6px">`;
    }
  };
  reader.readAsDataURL(file);
  e.target.value = '';
}

function cancelFile() {
  pendingFile = null;
  document.getElementById('file-prev').classList.remove('on');
  const inp = document.getElementById('msg-inp');
  const sendBtn = document.getElementById('send-btn');
  if (sendBtn && inp && !inp.value.trim()) sendBtn.classList.add('empty');
}

function downloadFile(msgId) {
  const msgs = MESSAGES[CUR?.id] || [];
  const m = msgs.find(x=>String(x.id)===String(msgId));
  if (!m||!m.dataUrl) return;
  const a = document.createElement('a');
  a.href = m.dataUrl; a.download = m.fileName || 'file';
  a.click();
}

function showLightbox(src) {
  if (!src) return;
  document.getElementById('lightbox-img').src = src;
  document.getElementById('lightbox').classList.add('on');
}

// ═══════════════ REPLY ═══════════════
function cancelReply() { REPLY = null; document.getElementById('reply-bar').classList.remove('on'); }

// ═══════════════ SEND BUTTON STATE ═══════════════
function onMsgInput(ta) {
  const val = ta.value;
  const len = val.length;
  const MAX = 2000;
  const sendBtn = document.getElementById('send-btn');
  const counter = document.getElementById('char-counter');
  // Toggle disabled state
  const isEmpty = !val.trim() && !pendingFile;
  if (sendBtn) sendBtn.classList.toggle('empty', isEmpty);
  // Character counter
  if (counter) {
    if (len > MAX * 0.8) {
      counter.textContent = `${MAX - len}`;
      counter.className = 'char-counter on' + (len >= MAX ? ' over' : len > MAX * 0.9 ? ' warn' : '');
    } else {
      counter.className = 'char-counter';
    }
  }
  // Typing sound
  playTypeSound();
  // Typing indicator via SSE
  sendTypingEvent();
}

let typingTimer = null;
function sendTypingEvent() {
  if (!CUR || CUR.isSystem || !TOKEN) return;
  api('POST', `/typing/${CUR.id}`, {}).catch(() => {});
  clearTimeout(typingTimer);
  typingTimer = setTimeout(() => {
    api('POST', `/typing/${CUR.id}/stop`, {}).catch(() => {});
  }, 2000);
}

// ═══════════════ SCROLL TO BOTTOM ═══════════════
let _scrollUnread = 0;
function initScrollBtn() {
  const msgs = document.getElementById('msgs');
  const btn = document.getElementById('scroll-btn');
  if (!msgs || !btn) return;
  msgs.addEventListener('scroll', () => {
    const threshold = 180;
    const atBottom = msgs.scrollHeight - msgs.scrollTop - msgs.clientHeight < threshold;
    if (atBottom) {
      btn.classList.remove('on');
      _scrollUnread = 0;
      const badge = btn.querySelector('.scroll-unread');
      if (badge) badge.remove();
    } else {
      btn.classList.add('on');
    }
  });
}

function scrollToBottom(force) {
  const msgs = document.getElementById('msgs');
  const btn = document.getElementById('scroll-btn');
  if (!msgs) return;
  msgs.scrollTo({ top: msgs.scrollHeight, behavior: force ? 'smooth' : 'auto' });
  if (btn) {
    btn.classList.remove('on');
    _scrollUnread = 0;
    const badge = btn.querySelector('.scroll-unread');
    if (badge) badge.remove();
  }
}

function maybeShowScrollBadge() {
  const msgs = document.getElementById('msgs');
  const btn = document.getElementById('scroll-btn');
  if (!msgs || !btn) return;
  const atBottom = msgs.scrollHeight - msgs.scrollTop - msgs.clientHeight < 180;
  if (!atBottom) {
    _scrollUnread++;
    btn.classList.add('on');
    let badge = btn.querySelector('.scroll-unread');
    if (!badge) {
      badge = document.createElement('span');
      badge.className = 'scroll-unread';
      btn.appendChild(badge);
    }
    badge.textContent = _scrollUnread > 99 ? '99+' : _scrollUnread;
  }
}

function scrollToMsg(id) {
  if (!id) return;
  const el = document.querySelector(`[data-id="${id}"]`);
  if (!el) return;
  el.scrollIntoView({behavior:'smooth', block:'center'});
  el.classList.add('msg-highlight');
  setTimeout(() => el.classList.remove('msg-highlight'), 1500);
}

// ═══════════════ CTX MENU ═══════════════
function showCtx(e, id) {
  e.preventDefault(); e.stopPropagation(); CTX_ID = id;
  const ctx = document.getElementById('ctx');
  ctx.classList.remove('on');
  // Temporarily show to measure height
  ctx.style.visibility = 'hidden';
  ctx.style.display = 'block';
  const ctxH = ctx.offsetHeight || 200;
  const ctxW = ctx.offsetWidth  || 190;
  ctx.style.display = '';
  ctx.style.visibility = '';
  let x = e.clientX, y = e.clientY;
  if (x + ctxW > window.innerWidth  - 8) x = window.innerWidth  - ctxW - 8;
  if (y + ctxH > window.innerHeight - 8) y = window.innerHeight - ctxH - 8;
  if (y < 8) y = 8;
  ctx.style.left = x + 'px';
  ctx.style.top  = y + 'px';
  ctx.style.right = 'auto';
  // Обновить текст закрепления
  const pinBtn = document.getElementById('ctx-pin-btn');
  if (pinBtn && CUR) {
    const isPinned = PINNED[CUR.id] && PINNED[CUR.id].id === id;
    pinBtn.innerHTML = isPinned
      ? `<svg viewBox="0 0 24 24" style="width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>Открепить`
      : `<svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/></svg>Закрепить`;
    pinBtn.onclick = isPinned ? () => ctxDo('unpin') : () => ctxDo('pin');
  }
  ctx.classList.add('on');
}

function ctxDo(act) {
  document.getElementById('ctx').classList.remove('on');
  const msgs = MESSAGES[CUR?.id] || [];
  const m = msgs.find(x=>String(x.id)===String(CTX_ID));
  if (!m) return;
  if (act==='reply') {
    REPLY = m;
    document.getElementById('rb-who').textContent = m.from==='me' ? ME.name : CUR.name;
    document.getElementById('rb-what').textContent = m.text || (m.type==='img' ? '📷 Фото' : 'Файл');
    document.getElementById('reply-bar').classList.add('on');
    document.getElementById('msg-inp').focus();
  } else if (act==='copy') {
    navigator.clipboard?.writeText(m.text||'').catch(()=>{});
    showNotif(null,'📋 Скопировано','Текст скопирован в буфер');
  } else if (act==='pin') {
    if (!CUR) return;
    PINNED[CUR.id] = { id: m.id, text: m.text || (m.type==='img' ? '📷 Фото' : m.type==='file' ? '📎 '+m.fileName : 'Сообщение'), type: m.type };
    try { localStorage.setItem('pz_pinned', JSON.stringify(PINNED)); } catch{}
    const pb = document.getElementById('pinned');
    const pt = document.getElementById('pinned-txt');
    if (pb && pt) {
      pt.textContent = PINNED[CUR.id].text;
      pb.style.display = 'flex';
      pb.onclick = () => { const el = document.querySelector(`[data-id="${m.id}"]`); if(el) el.scrollIntoView({behavior:'smooth', block:'center'}); };
    }
    showNotif(null,'📌 Закреплено','Сообщение закреплено');
  } else if (act==='unpin') {
    if (!CUR) return;
    delete PINNED[CUR.id];
    try { localStorage.setItem('pz_pinned', JSON.stringify(PINNED)); } catch{}
    const pb = document.getElementById('pinned');
    if (pb) pb.style.display = 'none';
    showNotif(null,'📌 Откреплено','Закрепление снято');
  } else if (act==='delete') {
    if (m.from !== 'me') { showNotif(null,'⚠️ Ошибка','Нельзя удалить чужое сообщение'); return; }
    api('DELETE', `/messages/${CUR.id}/${m.id}`).catch(()=>{});
    MESSAGES[CUR.id] = msgs.filter(x=>String(x.id)!==String(CTX_ID));
    renderMsgs(CUR.id); renderSidebar();
  }
}

// Quick hover action helpers
function ctxReply(id) { CTX_ID = id; ctxDo('reply'); }
function ctxCopy(id) { CTX_ID = id; ctxDo('copy'); }
function ctxDelete(id) { CTX_ID = id; ctxDo('delete'); }
function quickReact(id, emoji) {
  // TODO: Add reaction via API when implemented
  showNotif(null, emoji + ' Реакция', 'Добавлена реакция ' + emoji);
}

document.addEventListener('click', e => {
  if (!e.target.closest('#ctx')) document.getElementById('ctx').classList.remove('on');
  if (!e.target.closest('#emo-panel')&&!e.target.closest('.emo-toggle')) document.getElementById('emo-panel').classList.remove('on');
  if (!e.target.closest('#status-menu')&&!e.target.closest('#status-menu-btn')) document.getElementById('status-menu').classList.remove('on');
});

// ═══════════════ EMOJI PANEL ═══════════════
let emoCat = 0;
function buildEmoPanel() {
  const p = document.getElementById('emo-panel');
  const cats = EMO_CATS.map((c,i)=>`<button class="emo-cat${i===0?' on':''}" onclick="setEmoCat(${i},this)" title="${c.n}">${c.l}</button>`).join('');
  p.innerHTML = `<div class="emo-cats">${cats}</div><div class="emo-grid" id="emo-grid"></div>`;
  renderEmoGrid(0);
}
function setEmoCat(i, btn) { emoCat=i; document.querySelectorAll('.emo-cat').forEach(b=>b.classList.remove('on')); btn.classList.add('on'); renderEmoGrid(i); }
function renderEmoGrid(i) { const g=document.getElementById('emo-grid'); if(!g)return; g.innerHTML=EMO_CATS[i].e.map(e=>`<button class="emo-btn" onclick="insertEmo('${e}')">${e}</button>`).join(''); }
function toggleEmo(e) { e.stopPropagation(); document.getElementById('emo-panel').classList.toggle('on'); }
function insertEmo(e) {
  const inp = document.getElementById('msg-inp');
  const s = inp.selectionStart || inp.value.length;
  inp.value = inp.value.slice(0,s) + e + inp.value.slice(s);
  inp.focus(); inp.setSelectionRange(s+e.length, s+e.length);
}

// ═══════════════ CHAT MENU ═══════════════
function showChatMenu(e) {
  const ctx = document.getElementById('ctx');
  ctx.innerHTML = `
    <div class="ctx-item" onclick="this.parentElement.classList.remove('on');clearHistory()"><svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a1 1 0 011-1h4a1 1 0 011 1v2"/></svg>Очистить историю</div>
    <div class="ctx-item" onclick="this.parentElement.classList.remove('on');toggleMute()"><svg viewBox="0 0 24 24"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"/></svg>${MUTED.has(CUR?.id)?'Включить уведомления':'Отключить уведомления'}</div>
  `;
  ctx.style.right = '16px'; ctx.style.top = '56px'; ctx.style.left = 'auto';
  ctx.classList.add('on');
}

function clearHistory() {
  if (!CUR) return;
  MESSAGES[CUR.id] = [];
  renderMsgs(CUR.id); renderSidebar();
  showNotif(null,'🗑️ Очищено','История очищена локально');
}

// ═══════════════ RIGHT PANEL ═══════════════
function showRP() { RP_ON=true; document.getElementById('rp').classList.add('on'); }
function hideRP() { RP_ON=false; document.getElementById('rp').classList.remove('on'); }
function toggleRP() { if (RP_ON) hideRP(); else { if (CUR&&!CUR.isSystem) showRP(); } }

// ═══════════════ MUTE ═══════════════
function toggleMute() {
  if (!CUR) return;
  const muted = MUTED.has(CUR.id);
  const btn = document.getElementById('mute-btn');
  if (muted) {
    MUTED.delete(CUR.id);
    document.getElementById('mute-lbl').textContent='Мут';
    if (btn) btn.classList.remove('muted');
    showNotif(null,'🔔 Уведомления','Включены');
  } else {
    MUTED.add(CUR.id);
    document.getElementById('mute-lbl').textContent='Вкл.';
    if (btn) btn.classList.add('muted');
    showNotif(null,'🔕 Уведомления','Отключены');
  }
}

// ═══════════════ BLOCK SYSTEM ═══════════════
async function loadBlockLists() {
  try {
    const r1 = await api('GET', '/blocks');
    BLOCKED_USERS = new Set(r1.blocked || []);
    const r2 = await api('GET', '/blocked-by');
    BLOCKED_BY = new Set(r2.blockedBy || []);
  } catch(e) {}
}

function isBlockedBy(uid) { return BLOCKED_BY.has(uid); }
function hasBlocked(uid) { return BLOCKED_USERS.has(uid); }
function isBlockRelated(uid) { return hasBlocked(uid) || isBlockedBy(uid); }

function showBlockModal() {
  if (!CUR) return;
  const blocked = hasBlocked(CUR.id);
  const modal = document.getElementById('block-modal');
  const ico = document.getElementById('block-modal-ico');
  const title = document.getElementById('block-modal-title');
  const sub = document.getElementById('block-modal-sub');
  const btn = document.getElementById('block-modal-confirm');
  const name = CUR.name || CUR.username || 'Пользователь';
  if (blocked) {
    ico.textContent = '🔓';
    title.textContent = 'Разблокировать?';
    sub.textContent = `${name} снова сможет писать вам и звонить.`;
    btn.textContent = 'Разблокировать';
    btn.style.background = 'linear-gradient(135deg,#3ecf8e,#2ecc71)';
  } else {
    ico.textContent = '🚫';
    title.textContent = `Заблокировать ${name}?`;
    sub.textContent = 'Этот пользователь не сможет отправлять вам сообщения и звонить. Оба не увидят сообщения друг друга.';
    btn.textContent = 'Заблокировать';
    btn.style.background = 'linear-gradient(135deg,#e74c3c,#ff6b76)';
  }
  modal.classList.add('on');
}
function hideBlockModal() { document.getElementById('block-modal').classList.remove('on'); }

async function confirmBlock() {
  if (!CUR) return;
  hideBlockModal();
  const blocked = hasBlocked(CUR.id);
  try {
    if (blocked) {
      await api('DELETE', `/block/${CUR.id}`);
      BLOCKED_USERS.delete(CUR.id);
      showNotif(null, '🔓 Разблокирован', `${CUR.name || CUR.username} разблокирован`);
    } else {
      await api('POST', `/block/${CUR.id}`);
      BLOCKED_USERS.add(CUR.id);
      showNotif(null, '🚫 Заблокирован', `${CUR.name || CUR.username} заблокирован`);
    }
    updateBlockUI();
    updateChatBlockedState();
  } catch(e) {
    showNotif(null,'⚠️ Ошибка', e.message || 'Не удалось выполнить действие');
  }
}

function updateBlockUI() {
  if (!CUR) return;
  const blocked = hasBlocked(CUR.id);
  const bby = isBlockedBy(CUR.id);
  const label = document.getElementById('rp-block-label');
  const badge = document.getElementById('rp-blocked-badge');
  const rpCallBtn = document.getElementById('rp-call-btn');
  const rpVideoBtn = document.getElementById('rp-video-btn');
  const blockRow = document.getElementById('rp-block-row');

  if (label) label.textContent = blocked ? 'Разблокировать' : 'Заблокировать';
  if (badge) badge.classList.toggle('on', blocked);

  // Change block button text color when blocked
  if (blockRow) {
    blockRow.style.color = blocked ? 'var(--orange)' : '';
  }

  // Disable call buttons if either side blocked
  const canCall = !blocked && !bby;
  [rpCallBtn, rpVideoBtn].forEach(b => {
    if (!b) return;
    b.style.opacity = canCall ? '' : '.3';
    b.style.pointerEvents = canCall ? '' : 'none';
    b.title = canCall ? b.title : 'Недоступно при блокировке';
  });
}

function updateChatBlockedState() {
  if (!CUR) return;
  const ia = document.querySelector('.ia');
  const msgInp = document.getElementById('msg-inp');
  const sendBtn = document.querySelector('.send-btn');
  const attBtn = document.querySelector('.att-btn');
  const bl = hasBlocked(CUR.id);
  const bby = isBlockedBy(CUR.id);
  // Show/hide blocked notice in chat
  let notice = document.getElementById('blocked-notice');
  if (!notice) {
    notice = document.createElement('div');
    notice.id = 'blocked-notice';
    notice.className = 'blocked-notice';
    const cv = document.getElementById('cv');
    if (cv) cv.style.position = 'relative', cv.appendChild(notice);
  }
  if (bl) {
    notice.innerHTML = '<div class="blocked-notice-ico">🚫</div><div class="blocked-notice-title">Пользователь заблокирован</div><div class="blocked-notice-sub">Вы заблокировали этого пользователя. Разблокируйте, чтобы общаться.</div>';
    notice.classList.add('on');
    if (msgInp) msgInp.disabled = true, msgInp.placeholder = 'Вы заблокировали этого пользователя';
    if (sendBtn) sendBtn.style.opacity = '.35', sendBtn.style.pointerEvents = 'none';
    if (attBtn) attBtn.style.opacity = '.35', attBtn.style.pointerEvents = 'none';
  } else if (bby) {
    notice.innerHTML = '<div class="blocked-notice-ico">⛔</div><div class="blocked-notice-title">Вы заблокированы</div><div class="blocked-notice-sub">Этот пользователь заблокировал вас.</div>';
    notice.classList.add('on');
    if (msgInp) msgInp.disabled = true, msgInp.placeholder = 'Вы заблокированы';
    if (sendBtn) sendBtn.style.opacity = '.35', sendBtn.style.pointerEvents = 'none';
    if (attBtn) attBtn.style.opacity = '.35', attBtn.style.pointerEvents = 'none';
  } else {
    notice.classList.remove('on');
    if (msgInp) msgInp.disabled = false, msgInp.placeholder = 'Написать сообщение...';
    if (sendBtn) sendBtn.style.opacity = '', sendBtn.style.pointerEvents = '';
    if (attBtn) attBtn.style.opacity = '', attBtn.style.pointerEvents = '';
  }
  // Also update the right panel
  const rp = document.getElementById('rp');
  if (rp) rp.classList.toggle('rp-blocked-by', bby && !bl);
}

// ═══════════════ NOTIFICATIONS ═══════════════
function showNotif(imgSrc, title, text, isSys=false) {
  const n = document.createElement('div'); n.className = 'notif';
  const ico = isSys || imgSrc
    ? `<div class="notif-ico">${imgSrc ? `<img src="${escH(imgSrc)}" alt="">` : `<img src="${EMPIRE_IMG}" alt="" style="width:100%;height:100%;object-fit:cover">`}</div>`
    : `<div class="notif-ico" style="background:${GRADS[Math.floor(Math.random()*GRADS.length)]};font-size:16px">${escH(title.slice(0,2))}</div>`;
  n.innerHTML = `${ico}<div><div class="notif-title">${escH(title)}</div><div class="notif-txt">${escH(text)}</div></div>`;
  n.onclick = ()=>n.remove();
  document.body.appendChild(n);
  setTimeout(()=>{ n.style.animation='notifOut .3s ease both'; setTimeout(()=>n.remove(),300); }, 4000);
}

// ═══════════════ LOADER ═══════════════
const ldMsgs = ['Подключение...','Загрузка ключей...','Синхронизация...','Почти готово...'];
function runLoader(cb) {
  const ld = document.getElementById('loader');
  const txt = document.getElementById('ld-txt');
  let i = 0;
  const iv = setInterval(()=>{
    i++;
    if (i < ldMsgs.length) txt.textContent = ldMsgs[i];
    else { clearInterval(iv); txt.textContent='Готово!'; setTimeout(()=>{ ld.classList.add('out'); setTimeout(()=>{ ld.style.display='none'; cb(); },450); },400); }
  }, 500);
}

// ═══════════════ SEARCH ═══════════════
function openSearch() {
  document.getElementById('srch-overlay').classList.add('on');
  document.getElementById('srch-inp').value = '';
  renderSearch('');
  setTimeout(()=>document.getElementById('srch-inp').focus(), 80);
}
function closeSearch() { document.getElementById('srch-overlay').classList.remove('on'); }
function srchBg(e) { if (e.target===document.getElementById('srch-overlay')) closeSearch(); }

let srchTimer = null;
function doSearch(q) { clearTimeout(srchTimer); srchTimer = setTimeout(()=>renderSearch(q), 200); }

async function renderSearch(q) {
  const res = document.getElementById('sm-results');
  res.innerHTML = '<div style="padding:16px;text-align:center;color:var(--text3);font-size:13px">Поиск...</div>';
  try {
    const url = q ? `/users?q=${encodeURIComponent(q)}` : '/users';
    const all = await api('GET', url);
    const existing = new Set(CONTACTS.map(c=>c.id));
    const myChats = all.filter(u=>existing.has(u.uid));
    const others  = all.filter(u=>!existing.has(u.uid));
    let html = '';
    if (myChats.length) { html += `<div class="sm-lbl">Мои чаты</div>`; html += myChats.map(u=>smItem(u,true)).join(''); }
    if (others.length)  { html += `<div class="sm-lbl">Найти пользователя</div>`; html += others.map(u=>smItem(u,false)).join(''); }
    if (!all.length) html = `<div style="padding:28px;text-align:center;color:var(--text3);font-size:13px">${q?'Пользователь не найден':'Нет пользователей'}</div>`;
    res.innerHTML = html;
  } catch(e) {
    res.innerHTML = `<div style="padding:16px;text-align:center;color:var(--red);font-size:13px">Ошибка поиска</div>`;
  }
}

function smItem(u, exists) {
  let avHtml='', avBg='';
  if (u.avaImg)      { avHtml=`<img src="${u.avaImg}" alt="">`; avBg='background:var(--surface2)'; }
  else if (u.avaEmo) { avHtml=u.avaEmo; avBg='background:var(--surface2)'; }
  else               { avHtml=(u.name||'?')[0].toUpperCase(); avBg='background:'+GRADS[u.color||0]; }
  const pres = getPresence(u.uid);
  return `<div class="sm-item" onclick="startChatWith('${u.uid}')">
    <div class="ava sm" style="${avBg}">${avHtml}<div class="presence-ring ${pres}"></div></div>
    <div><div class="sm-item-name">${escH(u.name)}</div><div class="sm-item-tag">${escH(u.username||'')}${exists?' · В чатах':''}</div></div>
  </div>`;
}

async function startChatWith(uid) {
  closeSearch();
  let contact = CONTACTS.find(c=>c.id===uid);
  if (!contact) {
    try {
      const u = await api('GET', `/users/${uid}`);
      contact = {id:u.uid, name:u.name, username:u.username||'', avaEmo:u.avaEmo||null, avaImg:u.avaImg||null, color:u.color||0, bio:u.bio||''};
      CONTACTS.unshift(contact);
      if (!MESSAGES[uid]) MESSAGES[uid] = [];
      renderSidebar();
    } catch(e) {
      showNotif(null,'⚠️ Ошибка','Пользователь не найден');
      return;
    }
  }
  openChat(uid);
}

// ═══════════════ PROFILE ═══════════════
function openProfile() {
  document.getElementById('pm-overlay').classList.add('on');
  document.getElementById('pm-name').value = ME.name;
  document.getElementById('pm-uname').value = ME.username.replace('@','');
  document.getElementById('pm-bio').value = ME.bio || '';
  document.getElementById('pm-email').value = ME.email || '';
  const acctNameEl = document.getElementById('pm-acct-name');
  if (acctNameEl) acctNameEl.textContent = ME.name || ME.email || '—';
  refreshPMava();
  const cp = document.getElementById('color-picks');
  cp.innerHTML = DOT_COLORS.map((c,i)=>`<div class="cp${(ME.color||0)===i?' on':''}" style="background:${c}" onclick="pickColor(${i},this)"></div>`).join('');
  const eg = document.getElementById('pm-emo-grid');
  eg.innerHTML = AVA_EMOJIS.map(e=>`<button class="eg-btn${ME.avaEmo===e?' on':''}" onclick="pickEmoAva('${e}')">${e}</button>`).join('');
  const cd = document.getElementById('uname-cd');
  const lastChange = ME.usernameChangedAt || 0;
  const left = (24*3600000) - (Date.now() - lastChange);
  if (left > 0) {
    const h=Math.floor(left/3600000), m=Math.floor((left%3600000)/60000);
    cd.textContent = `⏳ смена через ${h}ч ${m}мин`;
    document.getElementById('pm-uname').readOnly = true;
    document.getElementById('pm-uname').style.opacity = '.45';
  } else {
    cd.textContent = '';
    document.getElementById('pm-uname').readOnly = false;
    document.getElementById('pm-uname').style.opacity = '1';
  }
  // Reset to first tab
  pmSwitchTab('profile', document.querySelector('.pm-tab'));

  // Init cosmetic pickers to saved state
  document.querySelectorAll('.accent-pick').forEach(b => {
    const c = b.getAttribute('onclick')?.match(/'(#[^']+)'/)?.[1];
    b.style.borderColor = c === COSM.accentColor ? 'rgba(255,255,255,.7)' : 'transparent';
  });
  document.querySelectorAll('.ava-ring-opt').forEach(b => {
    b.classList.toggle('on', b.dataset.ring === COSM.avaRing);
  });
  document.querySelectorAll('.name-style-opt').forEach(b => {
    b.classList.toggle('on', b.dataset.ns === COSM.nameStyle);
  });
  document.querySelectorAll('.bubble-theme-opt').forEach((b,i) => {
    const themes = ['default','emerald','sunset','ocean','rose','mono','gold','cyber'];
    b.classList.toggle('on', themes[i] === COSM.bubbleTheme);
  });
  document.querySelectorAll('.chat-bg-opt').forEach((b,i) => {
    const bgs = ['default','dots','grid','diagonal','purple','teal','midnight','void'];
    b.classList.toggle('on', bgs[i] === COSM.chatBg);
  });
  const csEl = document.getElementById('pm-custom-status');
  if (csEl) csEl.value = COSM.customStatus || '';
  const cmEl = document.getElementById('compact-mode');
  if (cmEl) cmEl.checked = document.body.classList.contains('compact');

  // App theme
  document.querySelectorAll('.theme-opt').forEach(b => {
    b.classList.toggle('on', b.dataset.theme === COSM.appTheme);
  });
  // Font size
  document.querySelectorAll('.fs-btn').forEach(b => {
    const on = b.dataset.fs === COSM.fontSize;
    b.style.borderColor = on ? 'var(--accent)' : 'transparent';
    b.style.background = on ? 'rgba(124,107,255,.12)' : 'var(--surface2)';
    b.style.color = on ? 'var(--accent2)' : 'var(--text3)';
  });
  // Effects
  document.querySelectorAll('.fx-opt').forEach(b => {
    b.classList.toggle('on', b.dataset.fx === COSM.effect);
  });
  const fxIntEl = document.getElementById('fx-intensity');
  if (fxIntEl) fxIntEl.value = COSM.fxIntensity;
  // Type sound
  document.querySelectorAll('.type-snd-btn').forEach(b => {
    const on = b.dataset.ts === COSM.typeSound;
    b.style.borderColor = on ? 'var(--accent)' : 'transparent';
    b.style.background = on ? 'rgba(124,107,255,.12)' : 'var(--surface2)';
    b.style.color = on ? 'var(--accent2)' : 'var(--text3)';
  });
  // Confetti
  const confEl = document.getElementById('confetti-send');
  if (confEl) confEl.checked = COSM.confettiOnSend;

  // Update live preview
  pmUpdatePreview();
}

function closeProfile() { document.getElementById('pm-overlay').classList.remove('on'); }

function refreshPMava() {
  const el = document.getElementById('pm-ava');
  // Убираем всё кроме overlay
  Array.from(el.childNodes).forEach(n=>{
    if (!n.classList || !n.classList.contains('pm-ava-over')) n.remove();
  });
  const over = el.querySelector('.pm-ava-over');
  if (ME.avaImg) {
    const img = document.createElement('img'); img.src = ME.avaImg; img.alt = '';
    el.insertBefore(img, over);
    el.style.background = 'var(--surface2)';
  } else if (ME.avaEmo) {
    const s = document.createElement('span');
    s.style.cssText = 'position:relative;z-index:1;font-size:32px';
    s.textContent = ME.avaEmo;
    el.insertBefore(s, over);
    el.style.background = 'var(--surface2)';
  } else {
    const s = document.createElement('span');
    s.style.cssText = 'position:relative;z-index:1;font-size:32px';
    s.textContent = (ME.name||'?')[0].toUpperCase();
    el.insertBefore(s, over);
    el.style.background = GRADS[ME.color||0];
  }
}

function pickColor(i, btn) {
  document.querySelectorAll('.cp').forEach(b=>b.classList.remove('on'));
  btn.classList.add('on');
  ME.color = i; ME.avaImg = null; ME.avaEmo = null; refreshPMava();
}

function pickEmoAva(e) {
  ME.avaEmo = e; ME.avaImg = null;
  document.querySelectorAll('.eg-btn').forEach(b=>{ b.classList.toggle('on', b.textContent===e); });
  refreshPMava();
}

function clearEmoAva() {
  ME.avaEmo = null; ME.avaImg = null; refreshPMava();
  document.querySelectorAll('.eg-btn').forEach(b=>b.classList.remove('on'));
}

async function saveProfile() {
  const name  = document.getElementById('pm-name').value.trim();
  const uname = document.getElementById('pm-uname').value.trim().replace(/^@/,'');
  const bio   = document.getElementById('pm-bio').value.trim();
  if (!name)  { showNotif(null,'⚠️ Ошибка','Имя не может быть пустым'); return; }
  if (!uname) { showNotif(null,'⚠️ Ошибка','Username не может быть пустым'); return; }
  const newU = '@'+uname;
  if (newU !== ME.username) {
    const left = (24*3600000) - (Date.now() - (ME.usernameChangedAt||0));
    if (left > 0) {
      const h=Math.floor(left/3600000), m=Math.floor((left%3600000)/60000);
      showNotif(null,'⏳ Кулдаун',`Смена username через ${h}ч ${m}мин`); return;
    }
  }
  // Save custom status
  const csEl = document.getElementById('pm-custom-status');
  if (csEl) { COSM.customStatus = csEl.value.trim(); localStorage.setItem('pz_custom_status', COSM.customStatus); }
  try {
    const updated = await api('PATCH','/me',{name,username:uname,bio,color:ME.color||0,avaEmo:ME.avaEmo||null,avaImg:ME.avaImg||null});
    ME = {...ME, ...updated};
    updateAdminTrigger();
    closeProfile(); renderSidebar();
    showNotif(null,'✅ Профиль обновлён','Изменения сохранены');
  } catch(e) {
    showNotif(null,'⚠️ Ошибка', e.message);
  }
}

function onAvaUpload(e) {
  const file = e.target.files[0]; if (!file) return;
  if (file.size > 2*1024*1024) { showNotif(null,'⚠️ Ошибка','Фото не более 2 МБ'); return; }
  const reader = new FileReader();
  reader.onload = ev => { ME.avaImg = ev.target.result; ME.avaEmo = null; refreshPMava(); };
  reader.readAsDataURL(file);
  e.target.value = '';
}

// ═══════════════ WebRTC CALLS ═══════════════
let rtcPeer = null, localStream = null, scrPeer = null;
let callType = 'audio', callDirection = 'outgoing';
let incomingOffer = null, callTargetUid = null;
// Буфер ICE-кандидатов, пришедших ДО acceptCall (до создания rtcPeer)
let pendingIceCandidates = [];

const RTC_CONFIG = {
  iceServers: [
    {urls:'stun:stun.l.google.com:19302'},
    {urls:'stun:stun1.l.google.com:19302'},
    {urls:'stun:stun2.l.google.com:19302'},
    {urls:'stun:stun3.l.google.com:19302'},
    // OpenRelay TURN — для случаев за NAT/firewall
    {urls:'turn:openrelay.metered.ca:80',  username:'openrelayproject',credential:'openrelayproject'},
    {urls:'turn:openrelay.metered.ca:443', username:'openrelayproject',credential:'openrelayproject'},
    {urls:'turns:openrelay.metered.ca:443',username:'openrelayproject',credential:'openrelayproject'},
  ]
};

async function handleRTCSignal(sig) {
  if (sig.type==='offer') {
    // Сбрасываем буфер при новом входящем звонке
    pendingIceCandidates = [];
    incomingOffer = sig; callTargetUid = sig.fromUid;
    let caller = CONTACTS.find(c=>c.id===sig.fromUid);
    if (!caller) {
      try { const u=await api('GET',`/users/${sig.fromUid}`); caller={id:u.uid,name:u.name,username:u.username||'',avaEmo:u.avaEmo,avaImg:u.avaImg,color:u.color||0}; }
      catch { caller={id:sig.fromUid,name:'Незнакомец',username:'',color:0}; }
    }
    showIncomingCall(caller, sig.callType||'audio');
  } else if (sig.type==='answer') {
    if (rtcPeer) {
      await rtcPeer.setRemoteDescription(new RTCSessionDescription(sig.sdp));
      // ✅ Останавливаем рингтон у звонящего — ответ получен
      stopRingtone();
      // ✅ Применяем ICE-кандидаты, накопившиеся пока ждали answer
      for (const c of pendingIceCandidates) {
        try { await rtcPeer.addIceCandidate(new RTCIceCandidate(c)); } catch {}
      }
      pendingIceCandidates = [];
    }
  } else if (sig.type==='candidate') {
    // ✅ Если rtcPeer есть и remote description уже задан — сразу добавляем
    // Иначе — буферизуем (кандидат пришёл раньше, чем createAnswer/setRemoteDescription)
    if (rtcPeer && rtcPeer.remoteDescription) {
      if (sig.candidate) try { await rtcPeer.addIceCandidate(new RTCIceCandidate(sig.candidate)); } catch {}
    } else {
      if (sig.candidate) pendingIceCandidates.push(sig.candidate);
    }
  } else if (sig.type === 'scr_offer') {
    // Получатель: принимаем отдельный peer для screen share
    if (scrPeer) { try { scrPeer.close(); } catch {} }
    scrPeer = new RTCPeerConnection(RTC_CONFIG);
    scrPeer.ontrack = e => {
      if (!e.streams[0]) return;
      const ssv = document.getElementById('screen-share-video');
      const ssa = document.getElementById('screen-share-area');
      if (ssv) { ssv.srcObject = e.streams[0]; ssv.play().catch(()=>{}); }
      if (ssa) ssa.classList.add('on');
      if (!callExpanded) toggleCallExpand?.();
      showNotif(null, '🖥 Демонстрация', 'Собеседник показывает экран');
    };
    scrPeer.onicecandidate = e => {
      if (e.candidate) sendSignal(sig.fromUid, {type: 'scr_candidate', candidate: e.candidate});
    };
    await scrPeer.setRemoteDescription(new RTCSessionDescription(sig.sdp));
    const answer = await scrPeer.createAnswer();
    await scrPeer.setLocalDescription(answer);
    await sendSignal(sig.fromUid, {type: 'scr_answer', sdp: answer});
  } else if (sig.type === 'scr_answer') {
    if (scrPeer) await scrPeer.setRemoteDescription(new RTCSessionDescription(sig.sdp));
  } else if (sig.type === 'scr_candidate') {
    if (scrPeer && sig.candidate) {
      try { await scrPeer.addIceCandidate(new RTCIceCandidate(sig.candidate)); } catch {}
    }
  } else if (sig.type === 'scr_stop') {
    if (scrPeer) { scrPeer.close(); scrPeer = null; }
    const ssv = document.getElementById('screen-share-video');
    const ssa = document.getElementById('screen-share-area');
    if (ssv) ssv.srcObject = null;
    if (ssa) ssa.classList.remove('on');
    showNotif(null, '🖥 Демонстрация', 'Собеседник остановил демонстрацию');
  } else if (sig.type==='hangup') {
    endCall();
  }
}

async function sendSignal(targetUid, payload) {
  try { await api('POST', `/signal/${targetUid}`, payload); } catch(e) { console.error('Signal error:', e); }
}

async function startCall(type) {
  if (!CUR||CUR.isSystem) return;
  // Block check — prevent call if blocked or blocked by
  if (hasBlocked(CUR.id) || isBlockedBy(CUR.id)) {
    showNotif(null,'🚫 Недоступно','Звонок невозможен при блокировке');
    return;
  }
  callType = type; callTargetUid = CUR.id; callDirection = 'outgoing';
  showCallOverlay(CUR, type, 'outgoing');
  try {
    localStream = await navigator.mediaDevices.getUserMedia({audio:true, video:type==='video'});
  } catch(e) {
    showNotif(null,'⚠️ Ошибка',`Нет доступа к ${type==='video'?'камере':'микрофону'}`);
    endCallUI(); return;
  }
  if (type==='video') {
    const lv=document.getElementById('call-local-video-el');
    if (lv) { lv.srcObject=localStream; lv.muted=true; }
    document.getElementById('call-local-video')?.classList.add('on');
  }
  rtcPeer = new RTCPeerConnection(RTC_CONFIG);
  localStream.getTracks().forEach(t=>rtcPeer.addTrack(t,localStream));
  rtcPeer.ontrack = e => {
    if (!e.streams[0]) return;
    const track = e.track;
    if (track.kind === 'video') {
      const rv = document.getElementById('call-remote-video-el');
      if (rv) { rv.srcObject = e.streams[0]; document.getElementById('call-video-area')?.classList.add('on'); }
    } else if (track.kind === 'audio') {
      let ra = document.getElementById('call-remote-audio');
      if (!ra) { ra = document.createElement('audio'); ra.id='call-remote-audio'; ra.autoplay=true; ra.style.display='none'; document.body.appendChild(ra); }
      ra.srcObject = e.streams[0];
      // ИСПРАВЛЕНИЕ: явный вызов .play() — autoplay блокируется браузером без взаимодействия
      if (audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
      const playPromise = ra.play();
      if (playPromise) playPromise.catch(()=>{ ra.muted=false; ra.play().catch(()=>{}); });
    }
  };
  rtcPeer.onicecandidate = e=>{ if (e.candidate) sendSignal(callTargetUid,{type:'candidate',candidate:e.candidate}); };
  rtcPeer.oniceconnectionstatechange = ()=>{
    const s=rtcPeer?.iceConnectionState;
    const status=document.getElementById('rtc-status');
    if (s==='connected'||s==='completed') {
      if (status) { status.textContent='● Подключено'; status.classList.add('on'); }
      document.getElementById('call-timer').style.display='block';
      document.getElementById('call-sub').textContent=type==='video'?'📹 Видеозвонок':'📞 Голосовой звонок';
      CALL_SEC=0; CALL_TMR=setInterval(()=>{ CALL_SEC++; const m=Math.floor(CALL_SEC/60),sc=CALL_SEC%60; document.getElementById('call-timer').textContent=`${m}:${String(sc).padStart(2,'0')}`; },1000);
    } else if (s==='failed'||s==='disconnected') {
      if (status) status.textContent='⚠ Разрыв соединения';
    }
  };
  const offer=await rtcPeer.createOffer();
  await rtcPeer.setLocalDescription(offer);
  await sendSignal(callTargetUid,{type:'offer',sdp:offer,callType:type});
  startRingtone();
}

function showCallOverlay(contact, type, direction) {
  const avaEl=document.getElementById('call-ava'); avaEl.innerHTML=''; setAvaEl(avaEl,contact);
  document.getElementById('call-name').textContent=contact.name;
  document.getElementById('call-sub').textContent=direction==='outgoing'?(type==='video'?'📹 Видеозвонок...':'📞 Голосовой вызов...'):(type==='video'?'📹 Входящий видеозвонок':'📞 Входящий вызов');
  document.getElementById('call-timer').style.display='none';
  document.getElementById('call-overlay').classList.add('on');
}

function showIncomingCall(caller, type) {
  // playRingtone(); // sound disabled
  const avaEl=document.getElementById('inc-ava'); setAvaEl(avaEl,caller);
  document.getElementById('inc-name').textContent=caller.name;
  document.getElementById('inc-sub').textContent=type==='video'?'📹 Видеозвонок':'📞 Голосовой вызов';
  startRingtone();
  document.getElementById('inc-overlay').classList.add('on');
}

async function acceptCall() {
  stopRingtone();
  document.getElementById('inc-overlay').classList.remove('on');
  callDirection='incoming';
  const caller=CONTACTS.find(c=>c.id===callTargetUid)||{id:callTargetUid,name:'Абонент',color:0};
  showCallOverlay(caller,incomingOffer?.callType||'audio','incoming');
  const type=incomingOffer?.callType||'audio';
  // Разблокировать AudioContext (требует жеста пользователя)
  try { const ctx = getAudioCtx(); if (ctx.state === 'suspended') await ctx.resume(); } catch {}
  try { localStream=await navigator.mediaDevices.getUserMedia({audio:true,video:type==='video'}); }
  catch { showNotif(null,'⚠️ Ошибка','Нет доступа к микрофону'); endCallUI(); return; }
  if (type==='video') {
    const lv=document.getElementById('call-local-video-el');
    if (lv) { lv.srcObject=localStream; lv.muted=true; }
    document.getElementById('call-local-video')?.classList.add('on');
  }
  rtcPeer=new RTCPeerConnection(RTC_CONFIG);
  localStream.getTracks().forEach(t=>rtcPeer.addTrack(t,localStream));
  rtcPeer.ontrack = e => {
    if (!e.streams[0]) return;
    const track = e.track;
    if (track.kind === 'video') {
      const rv = document.getElementById('call-remote-video-el');
      if (rv) { rv.srcObject = e.streams[0]; document.getElementById('call-video-area')?.classList.add('on'); }
    } else if (track.kind === 'audio') {
      let ra = document.getElementById('call-remote-audio');
      if (!ra) { ra = document.createElement('audio'); ra.id='call-remote-audio'; ra.autoplay=true; ra.style.display='none'; document.body.appendChild(ra); }
      ra.srcObject = e.streams[0];
      // ИСПРАВЛЕНИЕ: явный вызов .play() — autoplay блокируется браузером без взаимодействия
      if (audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
      const playPromise = ra.play();
      if (playPromise) playPromise.catch(()=>{ ra.muted=false; ra.play().catch(()=>{}); });
    }
  };
  rtcPeer.oniceconnectionstatechange=()=>{
    const s=rtcPeer?.iceConnectionState;
    if(s==='connected'||s==='completed'){
      document.getElementById('call-sub').textContent=type==='video'?'📹 Видеозвонок':'📞 Голосовой звонок';
      document.getElementById('call-timer').style.display='block';
      CALL_SEC=0; CALL_TMR=setInterval(()=>{ CALL_SEC++; const m=Math.floor(CALL_SEC/60),sc=CALL_SEC%60; document.getElementById('call-timer').textContent=`${m}:${String(sc).padStart(2,'0')}`; },1000);
    }
  };
  await rtcPeer.setRemoteDescription(new RTCSessionDescription(incomingOffer.sdp));
  // ✅ Применяем все ICE-кандидаты звонящего, пришедшие пока шёл вызов
  for (const c of pendingIceCandidates) {
    try { await rtcPeer.addIceCandidate(new RTCIceCandidate(c)); } catch {}
  }
  pendingIceCandidates = [];
  const answer=await rtcPeer.createAnswer();
  await rtcPeer.setLocalDescription(answer);
  await sendSignal(callTargetUid,{type:'answer',sdp:answer});
  incomingOffer=null;
}

function declineCall() {
  stopRingtone();
  document.getElementById('inc-overlay').classList.remove('on');
  if (callTargetUid) sendSignal(callTargetUid,{type:'hangup'});
  incomingOffer=null; callTargetUid=null;
}

function endCall() {
  stopRingtone();
  clearInterval(CALL_TMR); CALL_TMR = null;
  if (callTargetUid) sendSignal(callTargetUid,{type:'hangup'}).catch(()=>{});
  endCallUI();
}

function endCallUI() {
  stopScreenShare?.();
  if (scrPeer) { try { scrPeer.close(); } catch {} scrPeer = null; }
  if (callExpanded) toggleCallExpand?.();
  callExpanded = false;
  if (rtcPeer) { rtcPeer.close(); rtcPeer=null; }
  if (localStream) { localStream.getTracks().forEach(t=>t.stop()); localStream=null; }
  const rvEl=document.getElementById('call-remote-video-el'); if(rvEl)rvEl.srcObject=null;
  const lvEl=document.getElementById('call-local-video-el'); if(lvEl)lvEl.srcObject=null;
  const raEl=document.getElementById('call-remote-audio'); if(raEl){raEl.srcObject=null;raEl.remove();}
  document.getElementById('call-video-area')?.classList.remove('on');
  document.getElementById('call-local-video')?.classList.remove('on');
  document.getElementById('rtc-status')?.classList.remove('on');
  document.getElementById('call-overlay').classList.remove('on');
  document.getElementById('inc-overlay').classList.remove('on');
  callTargetUid=null; incomingOffer=null; pendingIceCandidates=[];
}

function toggleCallMute() {
  const btn=document.getElementById('cbtn-mute');
  const m=btn.dataset.m==='1'; btn.dataset.m=m?'0':'1';
  btn.style.background=m?'':'var(--red)';
  if (localStream) localStream.getAudioTracks().forEach(t=>t.enabled=m);
}

function toggleSpeaker() {
  const btn=document.getElementById('cbtn-spk');
  const off=btn.dataset.off==='1'; btn.dataset.off=off?'0':'1';
  btn.style.background=off?'':'var(--surface3)';
  document.getElementById('spk-path').style.display=off?'':'none';
}

// ═══════════════ KEYBOARD ═══════════════
document.addEventListener('keydown', e=>{
  if (e.key==='Escape') {
    closeSearch(); closeProfile();
    document.getElementById('call-overlay').classList.remove('on');
    document.getElementById('ctx').classList.remove('on');
    document.getElementById('emo-panel').classList.remove('on');
    document.getElementById('lightbox').classList.remove('on');
    document.getElementById('inc-overlay').classList.remove('on');
    document.getElementById('status-menu').classList.remove('on');
  }
});

// ═══════════════ INIT ═══════════════
window.addEventListener('load', ()=>{
  // Переключаем вкладку по умолчанию
  setMode('login', document.querySelectorAll('.tab-btn')[0]);

  runLoader(async ()=>{
    if (TOKEN) {
      try {
        const me = await api('GET', '/me');
        ME = me;
        MY_STATUS = ME.status || 'online';
        startApp();
        return;
      } catch(e) {
        TOKEN = null;
        sessionStorage.removeItem('pz_token');
        localStorage.removeItem('pz_token');
      }
    }
    document.getElementById('auth').style.display = 'flex';
    document.getElementById('loader').style.display = 'none';
  });
});
</script>


<script>

// ── РАСШИРЕННЫЙ ЭКРАН ЗВОНКА ──
let callExpanded = false;
let screenStream = null;

function toggleCallExpand() {
  callExpanded = !callExpanded;
  const modal = document.getElementById('call-modal-inner');
  const icon = document.getElementById('expand-icon');
  modal.classList.toggle('expanded', callExpanded);
  // Swap icon to compress
  icon.innerHTML = callExpanded
    ? '<path d="M8 3v5H3M21 8h-5V3M3 16h5v5M16 21v-5h5"/>'
    : '<path d="M8 3H5a2 2 0 00-2 2v3M21 8V5a2 2 0 00-2-2h-3M3 16v3a2 2 0 002 2h3M16 21h3a2 2 0 002-2v-3"/>';
  // Drag for local pip
  if (callExpanded) initPipDrag();
}

// PiP drag для локального видео
function initPipDrag() {
  const pip = document.getElementById('call-local-video');
  let dragging = false, ox = 0, oy = 0;
  pip.style.position = 'absolute';
  pip.style.bottom = '100px'; pip.style.right = '16px';
  pip.style.left = 'auto'; pip.style.top = 'auto';
  pip.onmousedown = e => {
    dragging = true;
    ox = e.clientX - pip.offsetLeft;
    oy = e.clientY - pip.offsetTop;
    pip.style.cursor = 'grabbing';
    e.preventDefault();
  };
  document.onmousemove = e => {
    if (!dragging) return;
    let x = e.clientX - ox, y = e.clientY - oy;
    const modal = document.getElementById('call-modal-inner');
    const mr = modal.getBoundingClientRect();
    x = Math.max(0, Math.min(x, mr.width - pip.offsetWidth));
    y = Math.max(0, Math.min(y, mr.height - pip.offsetHeight));
    pip.style.left = x + 'px'; pip.style.top = y + 'px';
    pip.style.right = 'auto'; pip.style.bottom = 'auto';
  };
  document.onmouseup = () => { dragging = false; pip.style.cursor = 'move'; };
}

// Демонстрация экрана
let screenSharing = false;
async function toggleScreenShare() {
  if (screenSharing) {
    stopScreenShare();
    return;
  }
  if (!rtcPeer || !callTargetUid) {
    showNotif(null, '⚠️', 'Начни звонок чтобы показать экран');
    return;
  }
  try {
    screenStream = await navigator.mediaDevices.getDisplayMedia({
      video: { cursor: 'always', frameRate: 30 },
      audio: false
    });
  } catch(e) {
    if (e.name !== 'NotAllowedError') showNotif(null, '⚠️ Ошибка', 'Не удалось захватить экран');
    return;
  }

  screenSharing = true;
  document.getElementById('screen-share-area').classList.add('on');
  document.getElementById('ct-sharescreen').classList.add('active');
  document.getElementById('cbtn-share2').classList.add('active');

  // Показываем себе превью
  const videoEl = document.getElementById('screen-share-video');
  if (videoEl) videoEl.srcObject = screenStream;

  if (!callExpanded) toggleCallExpand();

  // Создаём ОТДЕЛЬНЫЙ RTCPeerConnection для screen share
  // чтобы триггернуть ontrack у получателя
  scrPeer = new RTCPeerConnection(RTC_CONFIG);
  const vTrack = screenStream.getVideoTracks()[0];
  scrPeer.addTrack(vTrack, screenStream);

  scrPeer.onicecandidate = e => {
    if (e.candidate) sendSignal(callTargetUid, {type: 'scr_candidate', candidate: e.candidate});
  };

  const offer = await scrPeer.createOffer();
  await scrPeer.setLocalDescription(offer);
  await sendSignal(callTargetUid, {type: 'scr_offer', sdp: offer});

  vTrack.onended = () => stopScreenShare();
  showNotif(null, '🖥 Демонстрация', 'Экран транслируется собеседнику');
}

function stopScreenShare() {
  if (!screenSharing && !screenStream) return;
  screenSharing = false;
  if (screenStream) {
    screenStream.getTracks().forEach(t => t.stop());
    screenStream = null;
  }
  if (scrPeer) {
    scrPeer.close();
    scrPeer = null;
  }
  const ssv = document.getElementById('screen-share-video');
  if (ssv) ssv.srcObject = null;
  document.getElementById('screen-share-area')?.classList.remove('on');
  document.getElementById('ct-sharescreen')?.classList.remove('active');
  document.getElementById('cbtn-share2')?.classList.remove('active');

  if (callTargetUid) sendSignal(callTargetUid, {type: 'scr_stop'}).catch(()=>{});
  showNotif(null, '🖥 Демонстрация', 'Демонстрация экрана остановлена');
}

// Камера вкл/выкл
function toggleCamera() {
  const btn = document.getElementById('cbtn-cam');
  const off = btn.dataset.off === '1';
  btn.dataset.off = off ? '0' : '1';
  btn.style.background = off ? 'var(--surface2)' : 'var(--red)';
  if (localStream) localStream.getVideoTracks().forEach(t => t.enabled = off);
}

// (endCallUI уже полностью сбрасывает состояние)

</script>

<script>
// ── РАСШИРЕННЫЕ НАСТРОЙКИ ──
function setStatusQuick(status) {
  MY_STATUS = status;
  api('PATCH', '/me/status', { status }).catch(()=>{});
  updateMyStatusUI(status);
  showNotif(null, '✅', 'Статус обновлён');
}

// ═══════════════ COSMETIC SETTINGS ═══════════════
let COSM = {
  accentColor: localStorage.getItem('pz_accent') || '#7c6bff',
  avaRing:     localStorage.getItem('pz_ava_ring') || 'orbit',
  nameStyle:   localStorage.getItem('pz_name_style') || 'white',
  bubbleTheme: localStorage.getItem('pz_bubble_theme') || 'default',
  chatBg:      localStorage.getItem('pz_chat_bg') || 'default',
  customStatus:localStorage.getItem('pz_custom_status') || '',
  appTheme:    localStorage.getItem('pz_app_theme') || '',
  fontSize:    localStorage.getItem('pz_font_size') || 'md',
  effect:      localStorage.getItem('pz_effect') || 'none',
  fxIntensity: parseInt(localStorage.getItem('pz_fx_intensity')||'60'),
  typeSound:   localStorage.getItem('pz_type_sound') || 'none',
  confettiOnSend: localStorage.getItem('pz_confetti') === '1',
};
const BUBBLE_THEMES = {
  default: 'linear-gradient(135deg,#7c6bff,#a695ff)',
  emerald: 'linear-gradient(135deg,#10b981,#34d399)',
  sunset:  'linear-gradient(135deg,#f59e0b,#ef4444)',
  ocean:   'linear-gradient(135deg,#0ea5e9,#6366f1)',
  rose:    'linear-gradient(135deg,#ec4899,#f43f5e)',
  mono:    'linear-gradient(135deg,#334155,#475569)',
  gold:    'linear-gradient(135deg,#d97706,#f59e0b)',
  cyber:   'linear-gradient(135deg,#06b6d4,#10b981)',
};
const NAME_STYLES = {
  white:  '',
  accent: 'linear-gradient(135deg,var(--accent),#4fc3f7)',
  gold:   'linear-gradient(135deg,#f59e0b,#fbbf24,#fcd34d)',
  fire:   'linear-gradient(135deg,#ff6b35,#f7931e,#ffcc02)',
  ice:    'linear-gradient(135deg,#74b9ff,#a29bfe,#fd79a8)',
  neon:   'linear-gradient(135deg,#00f5ff,#39ff14)',
};
const CHAT_BG_STYLES = {
  default:  '',
  dots:     'radial-gradient(rgba(255,255,255,.06) 1px,transparent 1px)',
  grid:     '',
  diagonal: '',
  purple:   '',
  teal:     '',
  midnight: '',
  void:     '',
};

function applyCosmetics() {
  // Accent
  document.documentElement.style.setProperty('--accent', COSM.accentColor);
  document.documentElement.style.setProperty('--accent2', COSM.accentColor);
  // Bubble theme
  applyBubbleTheme(COSM.bubbleTheme);
  // Chat bg
  applyChatBg(COSM.chatBg);
  // Avatar ring
  const wrap = document.querySelector('.rp-ava-wrap');
  if (wrap) {
    wrap.className = 'rp-ava-wrap ring-' + COSM.avaRing;
  }
  // Name style — applied in updateRightPanel
}

function applyBubbleTheme(theme) {
  const grad = BUBBLE_THEMES[theme] || BUBBLE_THEMES.default;
  let style = document.getElementById('_bubble_style');
  if (!style) { style = document.createElement('style'); style.id = '_bubble_style'; document.head.appendChild(style); }
  style.textContent = `.bubble.out{background:${grad}!important}`;
}

function applyChatBg(bg) {
  const msgsEl = document.getElementById('msgs');
  if (!msgsEl) return;
  const bgMap = {
    default:  {bg:'', img:''},
    dots:     {bg:'#07080e', img:'radial-gradient(rgba(255,255,255,.06) 1px,transparent 1px)', size:'20px 20px'},
    grid:     {bg:'#07080e', img:'linear-gradient(rgba(255,255,255,.04) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.04) 1px,transparent 1px)', size:'24px 24px'},
    diagonal: {bg:'repeating-linear-gradient(45deg,#07080e,#07080e 10px,#0c0e18 10px,#0c0e18 20px)', img:''},
    purple:   {bg:'radial-gradient(ellipse at 30% 70%,rgba(124,107,255,.12) 0%,#07080e 60%)', img:''},
    teal:     {bg:'radial-gradient(ellipse at 70% 30%,rgba(79,195,247,.1) 0%,#07080e 60%)', img:''},
    midnight: {bg:'linear-gradient(180deg,#0a0a1a,#070810)', img:''},
    void:     {bg:'#000', img:''},
  };
  const v = bgMap[bg] || bgMap.default;
  if (v.img) {
    msgsEl.style.background = v.bg;
    msgsEl.style.backgroundImage = v.img;
    if (v.size) msgsEl.style.backgroundSize = v.size;
  } else {
    msgsEl.style.background = v.bg;
    msgsEl.style.backgroundImage = '';
    msgsEl.style.backgroundSize = '';
  }
}

function applyNameStyleEl(el) {
  const grad = NAME_STYLES[COSM.nameStyle];
  if (!grad) {
    el.style.background = '';
    el.style.webkitBackgroundClip = '';
    el.style.webkitTextFillColor = '';
    el.style.color = '#fff';
  } else {
    el.style.background = grad;
    el.style.webkitBackgroundClip = 'text';
    el.style.webkitTextFillColor = 'transparent';
  }
}

function setAccent(color, btn) {
  COSM.accentColor = color;
  document.documentElement.style.setProperty('--accent', color);
  document.documentElement.style.setProperty('--accent2', color);
  localStorage.setItem('pz_accent', color);
  document.querySelectorAll('.accent-pick').forEach(b => b.style.borderColor = 'transparent');
  if (btn) btn.style.borderColor = 'rgba(255,255,255,.7)';
  applyBubbleTheme(COSM.bubbleTheme);
  showNotif(null, '🎨', 'Цвет изменён');
}

function setAvaRing(ring, el) {
  COSM.avaRing = ring;
  localStorage.setItem('pz_ava_ring', ring);
  document.querySelectorAll('.ava-ring-opt').forEach(b=>b.classList.remove('on'));
  if (el) el.classList.add('on');
  const wrap = document.querySelector('.rp-ava-wrap');
  if (wrap) wrap.className = 'rp-ava-wrap ring-' + ring;
}

function setNameStyle(ns, el) {
  COSM.nameStyle = ns;
  localStorage.setItem('pz_name_style', ns);
  document.querySelectorAll('.name-style-opt').forEach(b=>b.classList.remove('on'));
  if (el) el.classList.add('on');
  const nameEl = document.getElementById('rp-name');
  if (nameEl) applyNameStyleEl(nameEl);
}

function setBubbleTheme(theme, el) {
  COSM.bubbleTheme = theme;
  localStorage.setItem('pz_bubble_theme', theme);
  document.querySelectorAll('.bubble-theme-opt').forEach(b=>b.classList.remove('on'));
  if (el) el.classList.add('on');
  applyBubbleTheme(theme);
}

function setChatBg(bg, el) {
  COSM.chatBg = bg;
  localStorage.setItem('pz_chat_bg', bg);
  document.querySelectorAll('.chat-bg-opt').forEach(b=>b.classList.remove('on'));
  if (el) el.classList.add('on');
  applyChatBg(bg);
}

function setCustomStatusPreset(txt) {
  document.getElementById('pm-custom-status').value = txt;
  COSM.customStatus = txt;
  localStorage.setItem('pz_custom_status', txt);
}

function pmSwitchTab(name, btn) {
  document.querySelectorAll('.pm-tab').forEach(b=>b.classList.remove('on'));
  document.querySelectorAll('.pm-pane').forEach(p=>p.classList.remove('on'));
  btn.classList.add('on');
  document.getElementById('pm-pane-'+name)?.classList.add('on');
}

function pmUpdatePreview() {
  const name = document.getElementById('pm-name')?.value || ME.name || '';
  const uname = document.getElementById('pm-uname')?.value || '';
  const pName = document.getElementById('pm-prev-name');
  const pTag = document.getElementById('pm-prev-tag');
  if (pName) pName.textContent = name;
  if (pTag) pTag.textContent = uname ? '@'+uname.replace('@','') : '';
  // Apply name style to preview
  if (pName) applyNameStyleEl(pName);
  // Apply ava to preview
  const prevAva = document.getElementById('pm-prev-ava');
  if (prevAva) {
    prevAva.innerHTML = '';
    if (ME.avaImg) {
      const img = document.createElement('img'); img.src = ME.avaImg; img.alt = '';
      prevAva.appendChild(img);
      prevAva.style.background = 'var(--surface2)';
    } else if (ME.avaEmo) {
      prevAva.textContent = ME.avaEmo;
      prevAva.style.background = 'var(--surface2)';
    } else {
      prevAva.textContent = (name||'?')[0].toUpperCase();
      prevAva.style.background = GRADS[ME.color||0];
    }
  }
}

// Init cosmetics on load
(function initCosmetics() {
  const saved = localStorage.getItem('pz_accent');
  if (saved) {
    COSM.accentColor = saved;
    document.documentElement.style.setProperty('--accent', saved);
    document.documentElement.style.setProperty('--accent2', saved);
  }
  if (localStorage.getItem('pz_compact') === '1') document.body.classList.add('compact');
  // Apply theme, font, effects
  if (COSM.appTheme) document.body.classList.add('theme-' + COSM.appTheme);
  document.body.classList.add('fs-' + COSM.fontSize);
  // These will be applied once app starts
})();

// ─── App Themes ───
function setAppTheme(theme, el) {
  COSM.appTheme = theme;
  localStorage.setItem('pz_app_theme', theme);
  document.body.className = document.body.className.replace(/\btheme-\S+/g, '').trim();
  if (theme) document.body.classList.add('theme-' + theme);
  document.querySelectorAll('.theme-opt').forEach(b => b.classList.remove('on'));
  if (el) el.classList.add('on');
  showNotif(null, '🎨', 'Тема изменена');
}

// ─── Font Size ───
function setFontSize(fs, el) {
  COSM.fontSize = fs;
  localStorage.setItem('pz_font_size', fs);
  document.body.classList.remove('fs-sm','fs-md','fs-lg','fs-xl');
  document.body.classList.add('fs-' + fs);
  document.querySelectorAll('.fs-btn').forEach(b => {
    const on = b.dataset.fs === fs;
    b.style.borderColor = on ? 'var(--accent)' : 'transparent';
    b.style.background = on ? 'rgba(124,107,255,.12)' : 'var(--surface2)';
    b.style.color = on ? 'var(--accent2)' : 'var(--text3)';
  });
}

// ─── Type Sound ───
let _typeSndCtx = null;
function setTypeSound(ts, el) {
  COSM.typeSound = ts;
  localStorage.setItem('pz_type_sound', ts);
  document.querySelectorAll('.type-snd-btn').forEach(b => {
    const on = b.dataset.ts === ts;
    b.style.borderColor = on ? 'var(--accent)' : 'transparent';
    b.style.background = on ? 'rgba(124,107,255,.12)' : 'var(--surface2)';
    b.style.color = on ? 'var(--accent2)' : 'var(--text3)';
  });
}
function playTypeSound() {
  if (COSM.typeSound === 'none') return;
  try {
    if (!_typeSndCtx) _typeSndCtx = new (window.AudioContext||window.webkitAudioContext)();
    const ctx = _typeSndCtx;
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain); gain.connect(ctx.destination);
    const now = ctx.currentTime;
    if (COSM.typeSound === 'soft') {
      osc.type = 'sine'; osc.frequency.value = 800;
      gain.gain.setValueAtTime(0.04, now); gain.gain.exponentialRampToValueAtTime(0.001, now + 0.08);
      osc.start(now); osc.stop(now + 0.08);
    } else if (COSM.typeSound === 'click') {
      osc.type = 'square'; osc.frequency.value = 1200;
      gain.gain.setValueAtTime(0.03, now); gain.gain.exponentialRampToValueAtTime(0.001, now + 0.04);
      osc.start(now); osc.stop(now + 0.04);
    } else if (COSM.typeSound === 'pop') {
      osc.type = 'sine'; osc.frequency.setValueAtTime(500, now); osc.frequency.exponentialRampToValueAtTime(200, now + 0.06);
      gain.gain.setValueAtTime(0.05, now); gain.gain.exponentialRampToValueAtTime(0.001, now + 0.06);
      osc.start(now); osc.stop(now + 0.06);
    }
  } catch {}
}

// ─── Confetti ───
function spawnConfetti() {
  const canvas = document.getElementById('fx-canvas');
  const ctx = canvas.getContext('2d');
  canvas.style.display = '';
  canvas.width = window.innerWidth; canvas.height = window.innerHeight;
  const pieces = [];
  const colors = ['#7c6bff','#a695ff','#4fc3f7','#3ecf8e','#ffc948','#ff6b76','#ec4899','#fb923c'];
  for (let i = 0; i < 60; i++) {
    pieces.push({
      x: window.innerWidth * 0.4 + Math.random() * window.innerWidth * 0.2,
      y: window.innerHeight * 0.7,
      vx: (Math.random()-0.5)*8, vy: -(Math.random()*12+4),
      rot: Math.random()*360, rv: (Math.random()-0.5)*10,
      color: colors[Math.floor(Math.random()*colors.length)],
      w: Math.random()*8+4, h: Math.random()*4+2,
      alpha: 1, life: 80+Math.random()*40
    });
  }
  let frame = 0;
  const was = FX_ACTIVE;
  function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // Draw FX layer first
    if (was) FX_DRAW_FN && FX_DRAW_FN(ctx);
    let alive = false;
    pieces.forEach(p => {
      p.vy += 0.3; p.x += p.vx; p.y += p.vy; p.rot += p.rv;
      p.life--; p.alpha = p.life / 120;
      if (p.life > 0) {
        alive = true;
        ctx.save(); ctx.globalAlpha = p.alpha;
        ctx.translate(p.x, p.y); ctx.rotate(p.rot*Math.PI/180);
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
        ctx.restore();
      }
    });
    if (alive) requestAnimationFrame(draw);
    else if (!FX_ACTIVE) canvas.style.display = 'none';
  }
  draw();
}

// ─── Visual Effects Engine ───
let FX_ACTIVE = false;
let FX_ANIM = null;
let FX_DRAW_FN = null;

function setFxIntensity(val) {
  COSM.fxIntensity = parseInt(val);
  localStorage.setItem('pz_fx_intensity', val);
  if (FX_ACTIVE) { stopEffect(); startEffect(COSM.effect); }
}

function setEffect(name, el) {
  COSM.effect = name;
  localStorage.setItem('pz_effect', name);
  document.querySelectorAll('.fx-opt').forEach(b => b.classList.remove('on'));
  if (el) el.classList.add('on');
  stopEffect();
  if (name !== 'none') startEffect(name);
}

function stopEffect() {
  FX_ACTIVE = false;
  FX_DRAW_FN = null;
  if (FX_ANIM) { cancelAnimationFrame(FX_ANIM); FX_ANIM = null; }
  const canvas = document.getElementById('fx-canvas');
  if (canvas) { canvas.style.display='none'; const ctx=canvas.getContext('2d'); ctx.clearRect(0,0,canvas.width,canvas.height); }
}

function startEffect(name) {
  const canvas = document.getElementById('fx-canvas');
  if (!canvas) return;
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  canvas.style.display = '';
  const ctx = canvas.getContext('2d');
  FX_ACTIVE = true;
  const intensity = COSM.fxIntensity;

  window.onresize = () => { if(FX_ACTIVE){canvas.width=window.innerWidth;canvas.height=window.innerHeight;} };

  if (name === 'snow') {
    const flakes = Array.from({length: Math.floor(intensity*1.5)}, () => ({
      x: Math.random()*canvas.width, y: Math.random()*canvas.height,
      r: Math.random()*3+1, speed: Math.random()*1.5+0.5,
      wind: Math.random()*0.5-0.25, opacity: Math.random()*0.6+0.3
    }));
    FX_DRAW_FN = () => {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      flakes.forEach(f => {
        ctx.beginPath(); ctx.arc(f.x,f.y,f.r,0,Math.PI*2);
        ctx.fillStyle=`rgba(255,255,255,${f.opacity})`; ctx.fill();
        f.y+=f.speed; f.x+=f.wind+Math.sin(f.y/60)*0.5;
        if(f.y>canvas.height){f.y=-5;f.x=Math.random()*canvas.width;}
        if(f.x<0)f.x=canvas.width; if(f.x>canvas.width)f.x=0;
      });
    };
  } else if (name === 'stars') {
    const stars = Array.from({length: Math.floor(intensity*2)}, () => ({
      x: Math.random()*canvas.width, y: Math.random()*canvas.height,
      r: Math.random()*2+0.5, phase: Math.random()*Math.PI*2, speed: Math.random()*0.02+0.005
    }));
    const shootings = [];
    let sTmr = 0;
    FX_DRAW_FN = () => {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      stars.forEach(s => {
        s.phase += s.speed;
        const op = 0.4 + Math.sin(s.phase)*0.4;
        ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
        ctx.fillStyle=`rgba(200,210,255,${op})`; ctx.fill();
      });
      sTmr++;
      if (sTmr % 120 === 0) shootings.push({x:Math.random()*canvas.width*0.7,y:Math.random()*canvas.height*0.3,vx:6,vy:3,life:40,alpha:1});
      shootings.forEach((s,i) => {
        ctx.beginPath(); ctx.moveTo(s.x,s.y); ctx.lineTo(s.x-s.vx*5,s.y-s.vy*5);
        ctx.strokeStyle=`rgba(255,255,200,${s.alpha})`; ctx.lineWidth=1.5; ctx.stroke();
        s.x+=s.vx; s.y+=s.vy; s.life--; s.alpha=s.life/40;
      });
      for (let i=shootings.length-1;i>=0;i--) if(shootings[i].life<=0) shootings.splice(i,1);
    };
  } else if (name === 'bubbles') {
    const bubs = Array.from({length: Math.floor(intensity*0.8)}, () => ({
      x: Math.random()*canvas.width, y: canvas.height+Math.random()*canvas.height,
      r: Math.random()*20+8, speed: Math.random()*0.8+0.3, wobble: Math.random()*Math.PI*2
    }));
    FX_DRAW_FN = () => {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      bubs.forEach(b => {
        b.wobble+=0.02; b.y-=b.speed; b.x+=Math.sin(b.wobble)*0.5;
        if(b.y<-b.r*2){b.y=canvas.height+b.r;b.x=Math.random()*canvas.width;}
        const g=ctx.createRadialGradient(b.x-b.r*0.3,b.y-b.r*0.3,1,b.x,b.y,b.r);
        g.addColorStop(0,'rgba(160,180,255,0.35)'); g.addColorStop(0.7,'rgba(100,130,255,0.05)'); g.addColorStop(1,'rgba(140,160,255,0.15)');
        ctx.beginPath(); ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
        ctx.fillStyle=g; ctx.fill();
        ctx.strokeStyle='rgba(160,180,255,0.3)'; ctx.lineWidth=1; ctx.stroke();
      });
    };
  } else if (name === 'fire') {
    const particles = [];
    FX_DRAW_FN = () => {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for(let i=0;i<Math.floor(intensity/10);i++) {
        particles.push({
          x:canvas.width/2+(Math.random()-0.5)*80, y:canvas.height+5,
          vx:(Math.random()-0.5)*2, vy:-(Math.random()*4+2),
          life:1, decay:0.02+Math.random()*0.02, r:Math.random()*12+4
        });
      }
      particles.forEach(p=>{
        p.x+=p.vx; p.y+=p.vy; p.life-=p.decay; p.vx*=0.99;
        const h=Math.floor(p.life*60); // hue 0→60 = red→yellow
        ctx.beginPath(); ctx.arc(p.x,p.y,p.r*p.life,0,Math.PI*2);
        ctx.fillStyle=`hsla(${h},100%,50%,${p.life*0.6})`; ctx.fill();
      });
      for(let i=particles.length-1;i>=0;i--) if(particles[i].life<=0) particles.splice(i,1);
    };
  } else if (name === 'rain') {
    const drops = Array.from({length: Math.floor(intensity*2)}, () => ({
      x: Math.random()*canvas.width, y: Math.random()*canvas.height,
      speed: Math.random()*8+6, len: Math.random()*15+8, opacity: Math.random()*0.4+0.1
    }));
    FX_DRAW_FN = () => {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      drops.forEach(d => {
        ctx.beginPath(); ctx.moveTo(d.x,d.y); ctx.lineTo(d.x+d.len*0.15,d.y+d.len);
        ctx.strokeStyle=`rgba(150,190,255,${d.opacity})`; ctx.lineWidth=1; ctx.stroke();
        d.y+=d.speed; d.x+=d.speed*0.15;
        if(d.y>canvas.height){d.y=-20;d.x=Math.random()*canvas.width;}
      });
    };
  } else if (name === 'aurora') {
    let t = 0;
    const aColors = [[124,107,255],[79,195,247],[62,207,142]];
    FX_DRAW_FN = () => {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      t += 0.008;
      for (let c = 0; c < 3; c++) {
        const [r,gv,bv] = aColors[c];
        ctx.beginPath();
        ctx.moveTo(0, canvas.height);
        for (let x = 0; x <= canvas.width; x += 8) {
          const y = canvas.height * 0.15 + c * 70 + Math.sin(x/160 + t + c*1.2)*60 + Math.sin(x/70 + t*1.8 + c)*30;
          ctx.lineTo(x, y);
        }
        ctx.lineTo(canvas.width, canvas.height); ctx.closePath();
        const grad = ctx.createLinearGradient(0, 0, 0, canvas.height * 0.5);
        grad.addColorStop(0, `rgba(${r},${gv},${bv},0)`);
        grad.addColorStop(0.5, `rgba(${r},${gv},${bv},${0.13 * (intensity/100)})`);
        grad.addColorStop(1, `rgba(${r},${gv},${bv},0.015)`);
        ctx.fillStyle = grad; ctx.fill();
      }
    };
  } else if (name === 'hearts') {
    const hearts = Array.from({length: Math.floor(intensity*0.5)}, () => ({
      x: Math.random()*canvas.width, y: canvas.height+Math.random()*canvas.height,
      size: Math.random()*14+6, speed: Math.random()*0.8+0.3,
      wobble: Math.random()*Math.PI*2, opacity: Math.random()*0.6+0.3,
      hue: Math.floor(Math.random()*60)+280
    }));
    FX_DRAW_FN = () => {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      hearts.forEach(h => {
        h.wobble+=0.03; h.y-=h.speed; h.x+=Math.sin(h.wobble)*0.6;
        if(h.y<-h.size*2){h.y=canvas.height+h.size;h.x=Math.random()*canvas.width;}
        ctx.save(); ctx.globalAlpha=h.opacity;
        ctx.translate(h.x,h.y);
        ctx.fillStyle=`hsl(${h.hue},80%,70%)`;
        const s=h.size/8;
        ctx.beginPath();
        ctx.moveTo(0,s*2);
        ctx.bezierCurveTo(s*4,s*-2,s*8,s*3,0,s*8);
        ctx.bezierCurveTo(-s*8,s*3,-s*4,s*-2,0,s*2);
        ctx.fill(); ctx.restore();
      });
    };
  }

  function fxLoop() {
    if (!FX_ACTIVE) return;
    FX_DRAW_FN && FX_DRAW_FN();
    FX_ANIM = requestAnimationFrame(fxLoop);
  }
  fxLoop();
}

function toggleBrowserNotifs(on) {
  if (on && Notification.permission !== 'granted') {
    Notification.requestPermission().then(p => {
      if (p !== 'granted') document.getElementById('notif-browser').checked = false;
    });
  }
}

function toggleCompact(on) {
  document.body.classList.toggle('compact', on);
  localStorage.setItem('pz_compact', on ? '1' : '0');
}

// Restore accent on load — handled by initCosmetics above

function updateOnlineCount() {
  const cnt = Object.values(PRESENCES || {}).filter(s => s === 'online' || s === 'idle' || s === 'dnd').length;
  const el = document.getElementById('online-cnt');
  if (el) el.textContent = cnt > 0 ? cnt : '';
}
// updateOnlineCount is called reactively via SSE presence events — no setInterval needed
</script>

<!-- ════════════════ ADMIN PANEL HTML v2 ════════════════ -->
<div class="adm-overlay" id="adm-overlay" onclick="if(event.target===this)closeAdminPanel()">
  <div class="adm-panel">

    <!-- Header -->
    <div class="adm-header">
      <div class="adm-header-left">
        <div class="adm-shield">
          <svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/></svg>
        </div>
        <div class="adm-title-wrap">
          <div class="adm-title">Панель администратора</div>
          <div class="adm-subtitle">Управление сервером Перезажигал</div>
        </div>
        <span class="adm-badge">@boss</span>
      </div>
      <div class="adm-header-right">
        <div class="adm-live-dot">LIVE</div>
        <button class="adm-close" onclick="closeAdminPanel()">
          <svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
    </div>

    <div class="adm-body">
      <!-- Sidebar -->
      <nav class="adm-nav">
        <span class="adm-nav-section">Обзор</span>
        <button class="adm-nav-btn on" onclick="admTab('stats',this)">
          <svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><path d="M17 14v7M14 17h7"/></svg>
          Статистика
        </button>
        <button class="adm-nav-btn" onclick="admTab('sessions',this)">
          <svg viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
          Онлайн
          <span class="adm-nav-badge" id="adm-online-count">0</span>
        </button>
        <span class="adm-nav-section">Пользователи</span>
        <button class="adm-nav-btn" onclick="admTab('users',this)">
          <svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/></svg>
          Список
        </button>
        <button class="adm-nav-btn" onclick="admTab('messages',this)">
          <svg viewBox="0 0 24 24"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg>
          Сообщения
        </button>
        <button class="adm-nav-btn" onclick="admTab('search',this)">
          <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
          Поиск
        </button>
        <span class="adm-nav-section">Связь</span>
        <button class="adm-nav-btn" onclick="admTab('broadcast',this)">
          <svg viewBox="0 0 24 24"><path d="M22 2L11 13M22 2L15 22l-4-9-9-4 20-7z"/></svg>
          Рассылка
        </button>
        <button class="adm-nav-btn" onclick="admTab('announce',this)">
          <svg viewBox="0 0 24 24"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"/></svg>
          Уведомление
        </button>
        <span class="adm-nav-section">Система</span>
        <button class="adm-nav-btn" onclick="admTab('log',this)">
          <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/></svg>
          Журнал
        </button>
        <button class="adm-nav-btn" onclick="admTab('danger',this)">
          <svg viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0zM12 9v4M12 17h.01"/></svg>
          Опасная зона
        </button>
        <span class="adm-nav-section">Аналитика</span>
        <button class="adm-nav-btn" onclick="admTab('analytics',this)">
          <svg viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
          Активность
        </button>
        <button class="adm-nav-btn" onclick="admTab('ipbans',this)">
          <svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
          IP-Баны
        </button>
        <button class="adm-nav-btn" onclick="admTab('quickactions',this)">
          <svg viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
          Быстрые действия
        </button>
        <span class="adm-nav-section" style="color:var(--red);opacity:.9">🕵️ Разведка</span>
        <button class="adm-nav-btn" onclick="admTab('spy',this)" style="color:var(--accent2)">
          <svg viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
          Шпион
          <span class="adm-nav-badge" id="adm-spy-badge" style="background:var(--red);display:none">●</span>
        </button>
        <button class="adm-nav-btn" onclick="admTab('multiaccounts',this)">
          <svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><circle cx="20" cy="7" r="3" stroke-dasharray="2 1"/></svg>
          Мульти-акки
        </button>
        <button class="adm-nav-btn" onclick="admTab('geoip',this)">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/></svg>
          ГеоIP
        </button>
        <span class="adm-nav-section" style="color:var(--yellow);opacity:.9">⚙️ Инструменты</span>
        <button class="adm-nav-btn" onclick="admTab('livefeed',this)">
          <svg viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
          Live Feed
          <span class="adm-live-dot" style="padding:1px 5px;font-size:8px;border-radius:4px;margin-left:4px">LIVE</span>
        </button>
        <button class="adm-nav-btn" onclick="admTab('automod',this)">
          <svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          Автомод
        </button>
        <button class="adm-nav-btn" onclick="admTab('roles',this)">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="6"/><path d="M9 12L12 16l3-4"/><path d="M3 21v-1a8 8 0 0116 0v1"/></svg>
          Роли
        </button>
      </nav>

      <div class="adm-content">

        <!-- ═══ STATS ═══ -->
        <div class="adm-tab-panel on" id="adm-tab-stats">
          <div class="adm-section-title">
            <span class="icon">📊</span>
            Статистика сервера
            <button class="adm-btn neutral" onclick="admRefreshStats()" style="margin-left:auto;font-size:11px">↻ Обновить</button>
          </div>
          <div class="adm-cards" id="adm-stats-cards">
            <div style="color:var(--text3);font-size:13px;grid-column:1/-1">Загрузка...</div>
          </div>
          <div class="adm-server-bar" id="adm-server-info"></div>
        </div>

        <!-- ═══ USERS ═══ -->
        <div class="adm-tab-panel" id="adm-tab-users">
          <div class="adm-section-title">
            <span class="icon">👥</span> Пользователи
            <span id="adm-users-count" style="font-size:12px;color:var(--text3);font-family:'Manrope',sans-serif;font-weight:500;margin-left:auto"></span>
          </div>
          <div class="adm-search-row">
            <input class="adm-inp" placeholder="🔍 Поиск по имени, @username, email..." id="adm-user-search" oninput="admSearchUsers()" style="flex:1">
            <select class="adm-inp" id="adm-users-filter" onchange="admLoadUsers()" style="width:140px">
              <option value="">Все</option>
              <option value="banned">Забаненные</option>
              <option value="muted">Замьюченные</option>
              <option value="online">Онлайн</option>
            </select>
            <button class="adm-btn neutral" onclick="admLoadUsers()">↻</button>
            <button class="adm-btn neutral" onclick="admExportCSV()" title="Экспорт в CSV">📥 CSV</button>
          </div>
          <div class="adm-table-wrap">
            <table class="adm-table" id="adm-users-table">
              <thead><tr><th>Пользователь</th><th>Email</th><th>Статус</th><th>Предупр.</th><th>Бан</th><th>Дата</th><th>Действия</th></tr></thead>
              <tbody id="adm-users-tbody">
                <tr><td colspan="7" style="text-align:center;color:var(--text3);padding:30px">Загрузка...</td></tr>
              </tbody>
            </table>
          </div>
          <div class="adm-pagination" id="adm-users-pages"></div>
        </div>

        <!-- ═══ SESSIONS ═══ -->
        <div class="adm-tab-panel" id="adm-tab-sessions">
          <div class="adm-section-title">
            <span class="icon">🟢</span> Активные сессии
            <button class="adm-btn neutral" onclick="admLoadSessions()" style="margin-left:auto;font-size:11px">↻ Обновить</button>
          </div>
          <div class="adm-table-wrap">
            <table class="adm-table">
              <thead><tr><th>Пользователь</th><th>Статус</th><th>Подключений</th><th>Действия</th></tr></thead>
              <tbody id="adm-sessions-tbody">
                <tr><td colspan="4" style="text-align:center;color:var(--text3);padding:30px">Загрузка...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ═══ MESSAGES ═══ -->
        <div class="adm-tab-panel" id="adm-tab-messages">
          <div class="adm-section-title"><span class="icon">💬</span> Сообщения пользователя</div>
          <div class="adm-search-row">
            <input class="adm-inp" placeholder="UID или @username пользователя..." id="adm-msg-uid-inp" style="flex:1" onkeydown="if(event.key==='Enter')admLoadUserMsgs()">
            <button class="adm-btn primary lg" onclick="admLoadUserMsgs()">Показать</button>
          </div>
          <div id="adm-msgs-content"></div>
        </div>

        <!-- ═══ BROADCAST ═══ -->
        <div class="adm-tab-panel" id="adm-tab-broadcast">
          <!-- BROADCAST TO ALL -->
          <div class="adm-section-title"><span class="icon">📢</span> Системная рассылка — всем</div>
          <div style="background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:20px;margin-bottom:20px">
            <div class="adm-inp-group">
              <label>Тип сообщения</label>
              <div class="adm-broadcast-type">
                <button class="adm-type-btn on info" onclick="admSetBroadcastType('info',this)">ℹ️ Информация</button>
                <button class="adm-type-btn warning" onclick="admSetBroadcastType('warning',this)">⚠️ Внимание</button>
                <button class="adm-type-btn danger" onclick="admSetBroadcastType('danger',this)">🚨 Опасность</button>
              </div>
            </div>
            <div class="adm-inp-group">
              <label>Текст сообщения</label>
              <textarea class="adm-inp full" id="adm-broadcast-text" rows="3" placeholder="Введите текст для всех пользователей сервера..."></textarea>
            </div>
            <button class="adm-btn primary lg" style="width:100%" onclick="admSendBroadcast()">
              <svg viewBox="0 0 24 24" style="width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2"><path d="M22 2L11 13M22 2L15 22l-4-9-9-4 20-7z"/></svg>
              Отправить всем пользователям
            </button>
          </div>

          <!-- BOT MESSAGE -->
          <div class="adm-section-title"><span class="icon">🤖</span> Написать от бота «Перезажигал»</div>
          <div style="background:linear-gradient(135deg,rgba(124,107,255,.06),rgba(79,195,247,.04));border:1px solid rgba(124,107,255,.2);border-radius:16px;padding:20px;margin-bottom:20px">
            <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;padding:12px 14px;background:rgba(124,107,255,.08);border-radius:12px;border:1px solid rgba(124,107,255,.15)">
              <div style="width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,#7c6bff,#4fc3f7);display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0">⚜️</div>
              <div>
                <div style="font-weight:700;font-size:13px">Перезажигал</div>
                <div style="font-size:11px;color:var(--accent2)">@perezazhigal · Официальный бот</div>
              </div>
            </div>

            <div class="adm-inp-group" style="margin-bottom:12px">
              <label>Получатель</label>
              <div style="display:flex;gap:8px">
                <select class="adm-inp" id="adm-bot-target" style="flex:1" onchange="admBotTargetChange()">
                  <option value="all">📢 Всем пользователям</option>
                  <option value="user">👤 Конкретному пользователю</option>
                </select>
              </div>
            </div>
            <div class="adm-inp-group" id="adm-bot-uid-group" style="display:none;margin-bottom:12px">
              <label>UID или @username пользователя</label>
              <input class="adm-inp full" id="adm-bot-uid" placeholder="uid или @username...">
            </div>
            <div class="adm-inp-group" style="margin-bottom:12px">
              <label>Сообщение от бота</label>
              <textarea class="adm-inp full" id="adm-bot-text" rows="3" placeholder="Введите сообщение, которое придёт от Перезажигал..."></textarea>
            </div>
            <div class="adm-inp-group" style="margin-bottom:14px">
              <label>Быстрые шаблоны</label>
              <div style="display:flex;flex-wrap:wrap;gap:6px">
                <button class="adm-btn neutral" style="font-size:11px;padding:5px 10px" onclick="admBotTemplate('🎉 Поздравляем! Вы получили специальный статус на платформе.')">🎉 Поздравление</button>
                <button class="adm-btn neutral" style="font-size:11px;padding:5px 10px" onclick="admBotTemplate('⚠️ Внимание! На платформе ведутся технические работы. Возможны временные неполадки.')">⚠️ Тех. работы</button>
                <button class="adm-btn neutral" style="font-size:11px;padding:5px 10px" onclick="admBotTemplate('✅ Ваше обращение рассмотрено. Меры приняты.')">✅ Ответ на жалобу</button>
                <button class="adm-btn neutral" style="font-size:11px;padding:5px 10px" onclick="admBotTemplate('🔔 Напоминаем о правилах платформы. Уважайте других пользователей.')">🔔 Правила</button>
                <button class="adm-btn neutral" style="font-size:11px;padding:5px 10px" onclick="admBotTemplate('🎁 Для вас доступен специальный подарок от команды Перезажигал!')">🎁 Подарок</button>
              </div>
            </div>
            <button class="adm-btn primary lg" style="width:100%;background:linear-gradient(135deg,rgba(124,107,255,.3),rgba(79,195,247,.2));border-color:rgba(124,107,255,.4)" onclick="admSendBotMsg()">
              <svg viewBox="0 0 24 24" style="width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2"><path d="M12 2a10 10 0 110 20A10 10 0 0112 2zm0 5v5l3 3"/></svg>
              Отправить от бота
            </button>
          </div>

          <div class="adm-section-title"><span class="icon">📜</span> История рассылок</div>
          <div id="adm-broadcasts-history" style="color:var(--text3);font-size:13px">Загрузка...</div>
        </div>

        <!-- ═══ LOG ═══ -->
        <div class="adm-tab-panel" id="adm-tab-log">
          <div class="adm-section-title"><span class="icon">📋</span> Журнал действий</div>
          <div class="adm-search-row">
            <select class="adm-inp" id="adm-log-filter" onchange="admLoadLog()" style="flex:1">
              <option value="">Все действия</option>
              <option value="ban">🚫 Баны</option>
              <option value="unban">✅ Разбаны</option>
              <option value="mute">🔇 Мьюты</option>
              <option value="unmute">🔊 Размьюты</option>
              <option value="kick">👢 Кики</option>
              <option value="warn">⚠️ Предупреждения</option>
              <option value="delete_user">🗑 Удаление аккаунтов</option>
              <option value="broadcast">📢 Рассылки</option>
              <option value="edit_user">✏️ Редактирование</option>
              <option value="reset_password">🔑 Смена пароля</option>
            </select>
            <button class="adm-btn neutral" onclick="admLoadLog()">↻</button>
          </div>
          <div id="adm-log-content" style="color:var(--text3);font-size:13px">Загрузка...</div>
          <div class="adm-pagination" id="adm-log-pages"></div>
        </div>

        <!-- ═══ ANNOUNCE ═══ -->
        <div class="adm-tab-panel" id="adm-tab-announce">
          <div class="adm-section-title"><span class="icon">🔔</span> Личное уведомление</div>
          <div style="background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:20px">
            <div class="adm-inp-group">
              <label>Получатель (UID или @username)</label>
              <input class="adm-inp full" id="adm-ann-uid" placeholder="Введите UID или @username...">
            </div>
            <div class="adm-inp-group">
              <label>Тип уведомления</label>
              <div class="adm-broadcast-type">
                <button class="adm-type-btn on info" onclick="admSetAnnType('info',this)">ℹ️ Инфо</button>
                <button class="adm-type-btn warning" onclick="admSetAnnType('warning',this)">⚠️ Внимание</button>
                <button class="adm-type-btn danger" onclick="admSetAnnType('danger',this)">🚨 Серьёзно</button>
              </div>
            </div>
            <div class="adm-inp-group">
              <label>Текст уведомления</label>
              <textarea class="adm-inp full" id="adm-ann-text" rows="3" placeholder="Введите текст личного уведомления..."></textarea>
            </div>
            <button class="adm-btn primary lg" style="width:100%" onclick="admSendAnnounce()">📨 Отправить пользователю</button>
          </div>
        </div>

        <!-- ═══ SEARCH ═══ -->
        <div class="adm-tab-panel" id="adm-tab-search">
          <div class="adm-section-title"><span class="icon">🔍</span> Поиск по сообщениям</div>
          <div class="adm-search-row">
            <input class="adm-inp" id="adm-msg-search-inp" placeholder="Введите текст для поиска..." style="flex:1" onkeydown="if(event.key==='Enter')admSearchMessages()">
            <button class="adm-btn primary lg" onclick="admSearchMessages()">Найти</button>
          </div>
          <div id="adm-msg-search-results"></div>
        </div>

        <!-- ═══ DANGER ZONE ═══ -->
        <div class="adm-tab-panel" id="adm-tab-danger">
          <div class="adm-section-title" style="color:var(--red)"><span class="icon">⚠️</span> Опасная зона</div>
          <div style="background:rgba(255,50,50,.04);border:1px solid rgba(255,100,100,.12);border-radius:16px;padding:24px;margin-bottom:16px">
            <p style="font-size:12px;color:var(--text3);margin-bottom:20px;line-height:1.7">⚠️ Действия в этой зоне <strong style="color:var(--red)">необратимы</strong>. Используйте с крайней осторожностью.</p>
            <div style="display:flex;flex-direction:column;gap:12px">
              <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 16px;background:rgba(255,255,255,.02);border-radius:12px;border:1px solid rgba(255,255,255,.05)">
                <div>
                  <div style="font-size:13px;font-weight:700;color:var(--text)">🗑 Очистить ВСЕ сообщения</div>
                  <div style="font-size:11px;color:var(--text3);margin-top:3px">Необратимо удалит все сообщения на сервере</div>
                </div>
                <button class="adm-btn danger lg" onclick="admConfirmClearAll()">Очистить</button>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 16px;background:rgba(255,255,255,.02);border-radius:12px;border:1px solid rgba(255,255,255,.05)">
                <div>
                  <div style="font-size:13px;font-weight:700;color:var(--text)">🔄 Экспорт пользователей</div>
                  <div style="font-size:11px;color:var(--text3);margin-top:3px">Скачать список всех пользователей (JSON)</div>
                </div>
                <button class="adm-btn neutral lg" onclick="admExportUsers()">Экспорт</button>
              </div>
            </div>
          </div>
        </div>

        <!-- ═══ ANALYTICS ═══ -->
        <div class="adm-tab-panel" id="adm-tab-analytics">
          <div class="adm-section-title"><span class="icon">📈</span> Активность пользователей</div>
          <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px" id="adm-analytics-cards">
            <div style="background:rgba(124,107,255,.08);border:1px solid rgba(124,107,255,.15);border-radius:14px;padding:16px;text-align:center">
              <div style="font-size:28px;font-weight:800;color:var(--accent)" id="an-total-msgs">—</div>
              <div style="font-size:11px;color:var(--text3);margin-top:4px">Всего сообщений</div>
            </div>
            <div style="background:rgba(62,207,142,.06);border:1px solid rgba(62,207,142,.12);border-radius:14px;padding:16px;text-align:center">
              <div style="font-size:28px;font-weight:800;color:var(--green)" id="an-today-msgs">—</div>
              <div style="font-size:11px;color:var(--text3);margin-top:4px">Сегодня</div>
            </div>
            <div style="background:rgba(255,201,72,.06);border:1px solid rgba(255,201,72,.12);border-radius:14px;padding:16px;text-align:center">
              <div style="font-size:28px;font-weight:800;color:var(--yellow)" id="an-peak-online">—</div>
              <div style="font-size:11px;color:var(--text3);margin-top:4px">Пик онлайна</div>
            </div>
          </div>
          <div class="adm-section-title"><span class="icon">🏆</span> Топ активных пользователей</div>
          <div id="adm-top-users" style="color:var(--text3);font-size:13px">Загрузка...</div>
          <div class="adm-section-title" style="margin-top:16px"><span class="icon">📅</span> Активность за неделю</div>
          <div id="adm-week-chart" style="padding:16px;background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:14px">
            <div style="display:flex;align-items:flex-end;gap:8px;height:80px" id="adm-chart-bars"></div>
            <div style="display:flex;justify-content:space-between;margin-top:8px;font-size:10px;color:var(--text3)" id="adm-chart-labels"></div>
          </div>
        </div>

        <!-- ═══ IP BANS ═══ -->
        <div class="adm-tab-panel" id="adm-tab-ipbans">
          <div class="adm-section-title"><span class="icon">🔒</span> IP-блокировки</div>
          <div class="adm-search-row">
            <input class="adm-inp" id="adm-ip-inp" placeholder="Введите IP-адрес для блокировки..." style="flex:1;font-family:monospace">
            <input class="adm-inp" id="adm-ip-reason" placeholder="Причина..." style="width:160px">
            <button class="adm-btn danger" onclick="admAddIPBan()">🚫 Забанить IP</button>
          </div>
          <div class="adm-table-wrap" style="margin-top:16px">
            <table class="adm-table">
              <thead><tr><th>IP-адрес</th><th>Причина</th><th>Дата</th><th>Действия</th></tr></thead>
              <tbody id="adm-ipbans-tbody">
                <tr><td colspan="4" style="text-align:center;color:var(--text3);padding:30px">Загрузка...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ═══ QUICK ACTIONS ═══ -->
        <div class="adm-tab-panel" id="adm-tab-quickactions">
          <div class="adm-section-title"><span class="icon">⚡</span> Быстрые действия</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px">
            <button class="adm-btn neutral" style="padding:18px;height:auto;flex-direction:column;gap:8px;border-radius:14px" onclick="admQuickUnbanAll()">
              <span style="font-size:24px">✅</span>
              <span style="font-weight:700">Разбанить всех</span>
              <span style="font-size:11px;color:var(--text3)">Снять все активные баны</span>
            </button>
            <button class="adm-btn neutral" style="padding:18px;height:auto;flex-direction:column;gap:8px;border-radius:14px" onclick="admQuickUnmuteAll()">
              <span style="font-size:24px">🔊</span>
              <span style="font-weight:700">Размьютить всех</span>
              <span style="font-size:11px;color:var(--text3)">Снять все активные мьюты</span>
            </button>
            <button class="adm-btn neutral" style="padding:18px;height:auto;flex-direction:column;gap:8px;border-radius:14px" onclick="admQuickKickAll()">
              <span style="font-size:24px">👢</span>
              <span style="font-weight:700">Кикнуть всех</span>
              <span style="font-size:11px;color:var(--text3)">Отключить всех онлайн</span>
            </button>
            <button class="adm-btn neutral" style="padding:18px;height:auto;flex-direction:column;gap:8px;border-radius:14px" onclick="admQuickResetWarns()">
              <span style="font-size:24px">🔄</span>
              <span style="font-weight:700">Сбросить варны</span>
              <span style="font-size:11px;color:var(--text3)">Обнулить все предупреждения</span>
            </button>
          </div>
          <div class="adm-section-title"><span class="icon">🔧</span> Обслуживание</div>
          <div style="display:flex;flex-direction:column;gap:10px">
            <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 16px;background:rgba(255,255,255,.02);border-radius:12px;border:1px solid var(--border)">
              <div>
                <div style="font-size:13px;font-weight:700">🌙 Режим обслуживания</div>
                <div style="font-size:11px;color:var(--text3);margin-top:2px">Запретить вход новым пользователям</div>
              </div>
              <label class="pm-toggle"><input type="checkbox" id="adm-maintenance-toggle" onchange="admToggleMaintenance(this.checked)"><span class="pm-toggle-track"></span></label>
            </div>
            <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 16px;background:rgba(255,255,255,.02);border-radius:12px;border:1px solid var(--border)">
              <div>
                <div style="font-size:13px;font-weight:700">🔕 Заморозить чат</div>
                <div style="font-size:11px;color:var(--text3);margin-top:2px">Запретить отправку сообщений</div>
              </div>
              <label class="pm-toggle"><input type="checkbox" id="adm-freeze-toggle" onchange="admToggleFreeze(this.checked)"><span class="pm-toggle-track"></span></label>
            </div>
            <div style="display:flex;align-items:center;justify-content:space-between;padding:14px 16px;background:rgba(255,255,255,.02);border-radius:12px;border:1px solid var(--border)">
              <div>
                <div style="font-size:13px;font-weight:700">🆕 Только новые аккаунты (slowmode)</div>
                <div style="font-size:11px;color:var(--text3);margin-top:2px">Ограничить частоту сообщений</div>
              </div>
              <label class="pm-toggle"><input type="checkbox" id="adm-slowmode-toggle" onchange="admToggleSlowmode(this.checked)"><span class="pm-toggle-track"></span></label>
            </div>
          </div>
        </div>

      </div><!-- /adm-content -->
    </div><!-- /adm-body -->
  </div>
</div>

<!-- ════════ SPY MODE PANEL INJECTION ════════ -->
<script>
// Inject spy/new tabs into adm-content after DOM loads
document.addEventListener('DOMContentLoaded', function() {
  const content = document.querySelector('.adm-content');
  if (!content) return;

  // ── SPY TAB ──
  content.insertAdjacentHTML('beforeend', `
  <div class="adm-tab-panel" id="adm-tab-spy">
    <div class="adm-section-title">
      <span class="icon">👁️</span> Режим шпиона
      <span style="font-size:11px;color:var(--text3);font-weight:400;margin-left:8px">Мониторинг переписок в реальном времени</span>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <span id="spy-live-indicator" style="display:none;font-size:11px;color:var(--green)"><span class="spy-live-pulse"></span>Слежка активна</span>
        <button class="adm-btn neutral" onclick="admSpyRefresh()" style="font-size:11px">↻</button>
      </div>
    </div>

    <!-- User picker -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:16px">
      <div>
        <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px">👤 Пользователь A (цель)</div>
        <input class="adm-inp full" id="spy-user-a" placeholder="UID или @username..." oninput="admSpySearch('a')">
        <div id="spy-suggest-a" style="max-height:160px;overflow-y:auto;margin-top:4px"></div>
      </div>
      <div>
        <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px">👤 Пользователь B (собеседник, опционально)</div>
        <input class="adm-inp full" id="spy-user-b" placeholder="Оставьте пустым для всех чатов..." oninput="admSpySearch('b')">
        <div id="spy-suggest-b" style="max-height:160px;overflow-y:auto;margin-top:4px"></div>
      </div>
    </div>

    <button class="adm-btn primary" style="margin-bottom:16px;padding:10px 24px" onclick="admSpyLoad()">
      🕵️ Начать слежку
    </button>

    <!-- Conversation list -->
    <div id="spy-convs-section" style="display:none">
      <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px">📂 Все переписки пользователя</div>
      <div class="spy-conv-list" id="spy-conv-list"></div>
    </div>

    <!-- Message viewer -->
    <div id="spy-msgs-section" style="display:none">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
        <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em" id="spy-msgs-header">💬 Сообщения</div>
        <div style="display:flex;gap:6px">
          <button class="adm-btn neutral" style="font-size:10px;padding:4px 8px" onclick="admSpyRefreshMsgs()">↻</button>
          <button class="adm-btn danger" style="font-size:10px;padding:4px 8px" id="spy-clear-btn" onclick="admSpyClearRoom()">🗑 Удалить</button>
        </div>
      </div>
      <div class="spy-msg-stream" id="spy-msg-stream">
        <div class="spy-empty">Выберите переписку выше ↑</div>
      </div>
      <div style="display:flex;gap:8px;margin-top:10px">
        <input class="adm-inp" style="flex:1" id="spy-inject-text" placeholder="🕵️ Вмешаться в переписку (инъекция сообщения)..." onkeydown="if(event.key==='Enter')admSpyInject()">
        <select class="adm-inp" id="spy-inject-as" style="width:140px">
          <option value="a">От пользователя A</option>
          <option value="b">От пользователя B</option>
        </select>
        <button class="adm-btn warn" onclick="admSpyInject()">⚡ Инъекция</button>
      </div>
    </div>

    <!-- Shadow actions -->
    <div style="margin-top:16px;background:rgba(255,50,50,.04);border:1px solid rgba(255,100,100,.1);border-radius:12px;padding:14px" id="spy-shadow-panel" style="display:none">
      <div style="font-size:11px;font-weight:700;color:var(--red);text-transform:uppercase;letter-spacing:.06em;margin-bottom:10px">🎭 Теневые действия</div>
      <div style="display:flex;gap:8px;flex-wrap:wrap" id="spy-shadow-btns"></div>
    </div>
  </div>

  <!-- ══ MULTI ACCOUNTS TAB ══ -->
  <div class="adm-tab-panel" id="adm-tab-multiaccounts">
    <div class="adm-section-title">
      <span class="icon">👥</span> Мультиаккаунты
      <span style="font-size:11px;color:var(--text3);font-weight:400;margin-left:8px">Определение дублирующихся аккаунтов по IP</span>
      <button class="adm-btn primary" onclick="admLoadMultiAccounts()" style="margin-left:auto;font-size:11px">🔍 Сканировать</button>
    </div>
    <div style="background:rgba(255,201,72,.05);border:1px solid rgba(255,201,72,.12);border-radius:12px;padding:12px 14px;margin-bottom:16px;font-size:12px;color:var(--text3);line-height:1.6">
      ⚠️ Анализ ведётся на основе истории IP-адресов. Пользователи за одним NAT/VPN могут ложно совпасть. Это инструмент подозрений, не доказательств.
    </div>
    <div id="adm-multi-stats" style="display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap"></div>
    <div id="adm-multi-results">
      <div style="text-align:center;color:var(--text3);padding:40px;font-size:13px">Нажмите «Сканировать» для анализа</div>
    </div>
  </div>

  <!-- ══ GEOIP TAB ══ -->
  <div class="adm-tab-panel" id="adm-tab-geoip">
    <div class="adm-section-title">
      <span class="icon">🌍</span> ГеоIP Разведка
    </div>
    <div class="adm-search-row" style="margin-bottom:16px">
      <input class="adm-inp" id="geoip-search-uid" placeholder="Введите UID, @username или IP напрямую..." style="flex:1" onkeydown="if(event.key==='Enter')admGeoLookup()">
      <button class="adm-btn primary" onclick="admGeoLookup()">🌍 Определить</button>
    </div>
    <div id="geoip-result-area">
      <div style="text-align:center;color:var(--text3);padding:40px">
        <div style="font-size:48px;margin-bottom:12px">🌐</div>
        <div>Введите пользователя для определения геолокации</div>
      </div>
    </div>
  </div>

  <!-- ══ LIVE FEED TAB ══ -->
  <div class="adm-tab-panel" id="adm-tab-livefeed">
    <div class="adm-section-title">
      <span class="icon" style="animation:livePulse 1.4s infinite">📡</span> Live Feed
      <span style="font-size:11px;color:var(--green);margin-left:8px"><span class="spy-live-pulse"></span>Обновляется в реальном времени</span>
      <div style="margin-left:auto;display:flex;gap:8px">
        <select class="adm-inp" id="livefeed-filter" style="font-size:11px;padding:4px 8px;height:auto">
          <option value="">Все события</option>
          <option value="msg">💬 Сообщения</option>
          <option value="join">🟢 Входы</option>
          <option value="leave">⚫ Выходы</option>
          <option value="ban">🚫 Баны</option>
          <option value="warn">⚠️ Варны</option>
        </select>
        <button class="adm-btn neutral" style="font-size:11px" onclick="admClearFeed()">🗑 Очистить</button>
        <button class="adm-btn danger" id="livefeed-pause-btn" style="font-size:11px" onclick="admToggleFeedPause()">⏸ Пауза</button>
      </div>
    </div>
    <div style="display:flex;gap:10px;margin-bottom:12px" id="livefeed-stats">
      <div style="background:rgba(62,207,142,.06);border:1px solid rgba(62,207,142,.15);border-radius:8px;padding:8px 14px;text-align:center;min-width:70px">
        <div style="font-size:18px;font-weight:800;color:var(--green)" id="lf-msgs-count">0</div>
        <div style="font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.05em">сообщений</div>
      </div>
      <div style="background:rgba(124,107,255,.06);border:1px solid rgba(124,107,255,.15);border-radius:8px;padding:8px 14px;text-align:center;min-width:70px">
        <div style="font-size:18px;font-weight:800;color:var(--accent)" id="lf-joins-count">0</div>
        <div style="font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.05em">подключений</div>
      </div>
      <div style="background:rgba(255,107,118,.06);border:1px solid rgba(255,107,118,.15);border-radius:8px;padding:8px 14px;text-align:center;min-width:70px">
        <div style="font-size:18px;font-weight:800;color:var(--red)" id="lf-bans-count">0</div>
        <div style="font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.05em">банов</div>
      </div>
      <div style="background:rgba(255,201,72,.06);border:1px solid rgba(255,201,72,.15);border-radius:8px;padding:8px 14px;text-align:center;min-width:70px">
        <div style="font-size:18px;font-weight:800;color:var(--yellow)" id="lf-warns-count">0</div>
        <div style="font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.05em">предупр.</div>
      </div>
    </div>
    <div class="live-feed-wrap">
      <div id="live-feed-container"></div>
    </div>
  </div>

  <!-- ══ AUTOMOD TAB ══ -->
  <div class="adm-tab-panel" id="adm-tab-automod">
    <div class="adm-section-title">
      <span class="icon">🛡️</span> Автомодерация
      <span style="font-size:11px;color:var(--text3);font-weight:400;margin-left:8px">Правила фильтрации сообщений</span>
      <label class="pm-toggle" style="margin-left:auto;display:flex;align-items:center;gap:8px">
        <span style="font-size:11px;color:var(--text2)">Автомод активен</span>
        <input type="checkbox" id="automod-enabled" onchange="admAutomodToggle(this.checked)" checked>
        <span class="pm-toggle-track"></span>
      </label>
    </div>

    <!-- Add rule -->
    <div style="background:rgba(124,107,255,.05);border:1px solid rgba(124,107,255,.15);border-radius:14px;padding:16px;margin-bottom:16px">
      <div style="font-size:12px;font-weight:700;margin-bottom:12px;color:var(--text2)">➕ Добавить правило</div>
      <div style="display:grid;grid-template-columns:1fr auto auto auto;gap:8px;align-items:center">
        <input class="adm-inp" id="automod-word" placeholder="Слово/фраза/регекс..." style="font-family:monospace">
        <select class="adm-inp" id="automod-action" style="width:130px">
          <option value="delete">🗑 Удалить</option>
          <option value="warn">⚠️ Варн</option>
          <option value="mute">🔇 Мьют 10мин</option>
          <option value="ban">🚫 Бан</option>
        </select>
        <select class="adm-inp" id="automod-match" style="width:110px">
          <option value="contains">Содержит</option>
          <option value="exact">Точное</option>
          <option value="regex">Регекс</option>
          <option value="startswith">Начало</option>
        </select>
        <button class="adm-btn primary" onclick="admAddAutomodRule()">Добавить</button>
      </div>
    </div>

    <!-- Quick presets -->
    <div style="margin-bottom:14px">
      <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px">⚡ Быстрые пресеты</div>
      <div style="display:flex;flex-wrap:wrap;gap:6px">
        <button class="adm-btn neutral" style="font-size:11px" onclick="admAutomodPreset('spam')">📩 Анти-спам</button>
        <button class="adm-btn neutral" style="font-size:11px" onclick="admAutomodPreset('links')">🔗 Анти-ссылки</button>
        <button class="adm-btn neutral" style="font-size:11px" onclick="admAutomodPreset('caps')">🔠 Анти-caps</button>
        <button class="adm-btn neutral" style="font-size:11px" onclick="admAutomodPreset('flood')">🌊 Анти-флуд</button>
        <button class="adm-btn danger" style="font-size:11px" onclick="admAutomodClearAll()">🗑 Очистить всё</button>
      </div>
    </div>

    <!-- Rules list -->
    <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px">
      Активные правила (<span id="automod-count">0</span>)
    </div>
    <div id="automod-rules-list">
      <div style="text-align:center;color:var(--text3);padding:30px;font-size:13px">Правил нет — сообщения не фильтруются</div>
    </div>

    <!-- Stats -->
    <div style="margin-top:16px;background:rgba(255,255,255,.02);border-radius:12px;border:1px solid var(--border);padding:14px">
      <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-bottom:10px">📊 Статистика срабатываний</div>
      <div id="automod-stats" style="font-size:12px;color:var(--text3)">Нет данных за сегодня</div>
    </div>
  </div>

  <!-- ══ ROLES TAB ══ -->
  <div class="adm-tab-panel" id="adm-tab-roles">
    <div class="adm-section-title">
      <span class="icon">🎖️</span> Роли и бейджи
      <button class="adm-btn neutral" onclick="admLoadRoles()" style="margin-left:auto;font-size:11px">↻ Обновить</button>
    </div>

    <!-- Role assignment -->
    <div style="background:linear-gradient(135deg,rgba(124,107,255,.06),rgba(255,201,72,.04));border:1px solid rgba(124,107,255,.15);border-radius:14px;padding:16px;margin-bottom:16px">
      <div style="font-size:12px;font-weight:700;margin-bottom:12px;color:var(--text2)">🏅 Назначить роль</div>
      <div style="display:flex;gap:8px;margin-bottom:12px">
        <input class="adm-inp" id="roles-user-inp" style="flex:1" placeholder="UID или @username...">
        <button class="adm-btn neutral" onclick="admRoleFindUser()">Найти</button>
      </div>
      <div id="roles-user-preview" style="display:none;margin-bottom:12px;padding:10px;background:rgba(255,255,255,.03);border-radius:10px;border:1px solid var(--border)"></div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:12px">
        <div class="role-opt" data-role="none" onclick="admSelectRole('none',this)">
          <div style="font-size:20px;margin-bottom:4px">👤</div>
          <div style="font-size:10px;font-weight:700;color:var(--text3)">Обычный</div>
        </div>
        <div class="role-opt" data-role="vip" onclick="admSelectRole('vip',this)">
          <div style="font-size:20px;margin-bottom:4px">👑</div>
          <div style="font-size:10px;font-weight:700;color:var(--yellow)">VIP</div>
        </div>
        <div class="role-opt" data-role="mod" onclick="admSelectRole('mod',this)">
          <div style="font-size:20px;margin-bottom:4px">🛡️</div>
          <div style="font-size:10px;font-weight:700;color:var(--green)">Модератор</div>
        </div>
        <div class="role-opt" data-role="dev" onclick="admSelectRole('dev',this)">
          <div style="font-size:20px;margin-bottom:4px">⚡</div>
          <div style="font-size:10px;font-weight:700;color:var(--accent2)">Разработчик</div>
        </div>
      </div>
      <button class="adm-btn primary" style="width:100%" onclick="admAssignRole()">🎖️ Назначить роль</button>
    </div>

    <!-- Roles list -->
    <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px">
      Пользователи с ролями (<span id="roles-count">0</span>)
    </div>
    <div id="roles-list">
      <div style="text-align:center;color:var(--text3);padding:30px">Загрузка...</div>
    </div>

    <!-- Verified badges section -->
    <div style="margin-top:24px">
      <div style="font-size:13px;font-weight:800;margin-bottom:12px;display:flex;align-items:center;gap:8px">
        <div class="verified-badge" style="width:18px;height:18px"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>
        Галочки верификации
      </div>
      <div style="background:linear-gradient(135deg,rgba(79,195,247,.06),rgba(124,107,255,.04));border:1px solid rgba(79,195,247,.18);border-radius:14px;padding:16px;margin-bottom:12px">
        <div style="font-size:12px;font-weight:700;margin-bottom:10px;color:var(--text2)">✅ Выдать / снять галочку</div>
        <div style="display:flex;gap:8px;margin-bottom:10px">
          <input class="adm-inp" id="verify-user-inp" style="flex:1" placeholder="UID или @username...">
          <button class="adm-btn neutral" onclick="admFindVerifyUser()">Найти</button>
        </div>
        <div id="verify-user-preview" style="display:none;margin-bottom:10px;padding:10px;background:rgba(255,255,255,.03);border-radius:10px;border:1px solid var(--border)"></div>
        <div style="display:flex;gap:8px">
          <button class="adm-btn primary" style="flex:1" onclick="admVerifyUser(true)">✅ Выдать галочку</button>
          <button class="adm-btn danger" style="flex:1" onclick="admVerifyUser(false)">❌ Снять галочку</button>
        </div>
      </div>
      <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px">
        Верифицированные (<span id="verified-count">0</span>)
      </div>
      <div id="verified-list">
        <div style="text-align:center;color:var(--text3);padding:20px;font-size:12px">Нет верифицированных</div>
      </div>
    </div>
  </div>
  `);
});
</script>

<!-- ═══ EDIT USER MODAL ═══ -->
<div class="adm-modal-overlay" id="adm-edit-modal">
  <div class="adm-modal">
    <div class="adm-modal-ico blue">✏️</div>
    <h3>Редактировать пользователя</h3>
    <p>Изменение профиля пользователя</p>
    <input type="hidden" id="adm-edit-uid">
    <div class="adm-inp-group"><label>Имя</label><input class="adm-inp full" id="adm-edit-name" placeholder="Имя..."></div>
    <div class="adm-inp-group"><label>Username</label><input class="adm-inp full" id="adm-edit-username" placeholder="@username..."></div>
    <div class="adm-inp-group"><label>Новый пароль (пусто = не менять)</label><input class="adm-inp full" id="adm-edit-pass" type="password" placeholder="Минимум 6 символов..."></div>
    <div class="adm-inp-group"><label>Статус</label>
      <select class="adm-inp full" id="adm-edit-status">
        <option value="online">🟢 Онлайн</option>
        <option value="idle">🟡 Отсутствую</option>
        <option value="dnd">🔴 Не беспокоить</option>
        <option value="invisible">⚫ Невидимый</option>
      </select>
    </div>
    <div class="adm-modal-footer">
      <button class="adm-btn neutral" onclick="document.getElementById('adm-edit-modal').classList.remove('on')">Отмена</button>
      <button class="adm-btn primary" onclick="admSaveUser()">💾 Сохранить</button>
    </div>
  </div>
</div>

<!-- ═══ BAN MODAL ═══ -->
<div class="adm-modal-overlay" id="adm-ban-modal">
  <div class="adm-modal">
    <div class="adm-modal-ico red">🚫</div>
    <h3>Заблокировать пользователя</h3>
    <p id="adm-ban-name-hint" style="color:var(--red)"></p>
    <input type="hidden" id="adm-ban-uid">
    <div class="adm-inp-group"><label>Причина блокировки</label><input class="adm-inp full" id="adm-ban-reason" placeholder="Укажите причину..."></div>
    <div class="adm-inp-group">
      <label>Длительность</label>
      <div style="display:flex;gap:8px">
        <input class="adm-inp" id="adm-ban-duration" type="number" value="0" min="0" style="width:100px">
        <select class="adm-inp" id="adm-ban-unit" style="flex:1">
          <option value="hours">Часов (0 = навсегда)</option>
          <option value="days">Дней</option>
        </select>
      </div>
    </div>
    <div class="adm-modal-footer">
      <button class="adm-btn neutral" onclick="document.getElementById('adm-ban-modal').classList.remove('on')">Отмена</button>
      <button class="adm-btn danger" onclick="admConfirmBan()">🚫 Заблокировать</button>
    </div>
  </div>
</div>

<!-- ═══ WARN MODAL ═══ -->
<div class="adm-modal-overlay" id="adm-warn-modal">
  <div class="adm-modal">
    <div class="adm-modal-ico yellow">⚠️</div>
    <h3>Выдать предупреждение</h3>
    <p>После 3 предупреждений — автоматический бан</p>
    <input type="hidden" id="adm-warn-uid">
    <div class="adm-inp-group"><label>Причина</label><input class="adm-inp full" id="adm-warn-reason" placeholder="За что предупреждение..."></div>
    <div class="adm-modal-footer">
      <button class="adm-btn neutral" onclick="document.getElementById('adm-warn-modal').classList.remove('on')">Отмена</button>
      <button class="adm-btn warn" onclick="admConfirmWarn()">⚠️ Предупредить</button>
    </div>
  </div>
</div>

<!-- ═══ MUTE MODAL ═══ -->
<div class="adm-modal-overlay" id="adm-mute-modal">
  <div class="adm-modal">
    <div class="adm-modal-ico yellow">🔇</div>
    <h3>Замьютить пользователя</h3>
    <p id="adm-mute-name-hint" style="color:var(--yellow)"></p>
    <input type="hidden" id="adm-mute-uid">
    <div class="adm-inp-group"><label>Причина</label><input class="adm-inp full" id="adm-mute-reason" placeholder="Укажите причину мьюта..."></div>
    <div class="adm-inp-group">
      <label>Длительность</label>
      <div style="display:flex;gap:8px">
        <input class="adm-inp" id="adm-mute-duration" type="number" value="60" min="0" style="width:100px">
        <select class="adm-inp" id="adm-mute-unit" style="flex:1">
          <option value="minutes">Минут (0 = навсегда)</option>
          <option value="hours">Часов</option>
          <option value="days">Дней</option>
        </select>
      </div>
    </div>
    <div class="adm-modal-footer">
      <button class="adm-btn neutral" onclick="document.getElementById('adm-mute-modal').classList.remove('on')">Отмена</button>
      <button class="adm-btn warn" onclick="admConfirmMute()">🔇 Замьютить</button>
    </div>
  </div>
</div>

<!-- ═══ KICK MODAL ═══ -->
<div class="adm-modal-overlay" id="adm-kick-modal">
  <div class="adm-modal">
    <div class="adm-modal-ico yellow">👢</div>
    <h3>Кикнуть пользователя</h3>
    <p>Пользователь будет отключён без блокировки</p>
    <input type="hidden" id="adm-kick-uid">
    <div class="adm-inp-group"><label>Причина (необязательно)</label><input class="adm-inp full" id="adm-kick-reason" placeholder="Причина..."></div>
    <div class="adm-modal-footer">
      <button class="adm-btn neutral" onclick="document.getElementById('adm-kick-modal').classList.remove('on')">Отмена</button>
      <button class="adm-btn warn" onclick="admConfirmKick()">👢 Кикнуть</button>
    </div>
  </div>
</div>

<!-- ═══ TOAST CONTAINER ═══ -->
<div class="adm-toasts" id="adm-toasts"></div>

<!-- Old compat -->
<div class="adm-notif" id="adm-notif"></div>

<script>
// ════════════ ADMIN PANEL JS v2 — FIXED + ENHANCED ════════════
let ADM_USERS = [], ADM_USERS_PAGE = 1, ADM_LOG_PAGE = 1;
let ADM_BROADCAST_TYPE = 'info', ADM_ANN_TYPE = 'info';

// ── Panel open/close ──
function openAdminPanel() {
  document.getElementById('adm-overlay').classList.add('on');
  admLoadStats();
  admUpdateOnlineBadge();
}
function closeAdminPanel() {
  document.getElementById('adm-overlay').classList.remove('on');
}

// ── Tab switching ──
function admTab(name, btn) {
  document.querySelectorAll('.adm-tab-panel').forEach(p => p.classList.remove('on'));
  document.querySelectorAll('.adm-nav-btn').forEach(b => b.classList.remove('on'));
  const panel = document.getElementById('adm-tab-' + name);
  if (!panel) return;
  panel.classList.add('on');
  btn.classList.add('on');
  if (name === 'stats') admLoadStats();
  else if (name === 'users') admLoadUsers();
  else if (name === 'sessions') admLoadSessions();
  else if (name === 'log') admLoadLog();
  else if (name === 'broadcast') admLoadBroadcasts();
  else if (name === 'analytics') admLoadAnalytics();
  else if (name === 'ipbans') admLoadIPBans();
  else if (name === 'quickactions') { /* nothing to load */ }
}

// ── Update online badge ──
async function admUpdateOnlineBadge() {
  try {
    const d = await api('GET', '/admin/sessions');
    const el = document.getElementById('adm-online-count');
    if (el) el.textContent = d.total || 0;
  } catch {}
}

// ── Stats ──
async function admLoadStats() {
  try {
    const d = await api('GET', '/admin/stats');
    document.getElementById('adm-stats-cards').innerHTML = `
      <div class="adm-card green"><div class="adm-card-icon">👥</div><div class="adm-card-val">${d.users}</div><div class="adm-card-lbl">Пользователей</div></div>
      <div class="adm-card accent"><div class="adm-card-icon">🟢</div><div class="adm-card-val">${d.online}</div><div class="adm-card-lbl">Онлайн сейчас</div></div>
      <div class="adm-card red"><div class="adm-card-icon">🚫</div><div class="adm-card-val">${d.banned}</div><div class="adm-card-lbl">Забанено</div></div>
      <div class="adm-card yellow"><div class="adm-card-icon">🔇</div><div class="adm-card-val">${d.muted}</div><div class="adm-card-lbl">Замьючено</div></div>
      <div class="adm-card"><div class="adm-card-icon">💬</div><div class="adm-card-val">${d.totalMessages.toLocaleString('ru')}</div><div class="adm-card-lbl">Сообщений</div></div>
      <div class="adm-card accent"><div class="adm-card-icon">📅</div><div class="adm-card-val">${d.todayMessages}</div><div class="adm-card-lbl">Сегодня</div></div>
      <div class="adm-card green"><div class="adm-card-icon">✨</div><div class="adm-card-val">${d.newUsers24h}</div><div class="adm-card-lbl">Новых за 24ч</div></div>
      <div class="adm-card red"><div class="adm-card-icon">⚡</div><div class="adm-card-val">${d.recentBans}</div><div class="adm-card-lbl">Банов за 24ч</div></div>
    `;
    const up = Math.floor(d.uptime);
    const h = Math.floor(up / 3600), m = Math.floor((up % 3600) / 60), s = up % 60;
    document.getElementById('adm-server-info').innerHTML = `
      <span>⏱ Аптайм: <b>${h}ч ${m}м ${s}с</b></span>
      <span>⚙️ Node.js: <b>${d.nodeVersion}</b></span>
      <span>💾 RAM: <b>${d.memoryMB} MB</b></span>
      <span>🕐 <b>${new Date(d.serverTime).toLocaleString('ru')}</b></span>
    `;
    // update online badge
    const el = document.getElementById('adm-online-count');
    if (el) el.textContent = d.online || 0;
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

function admRefreshStats() { admLoadStats(); admToast('success', 'Обновлено', 'Статистика загружена'); }

// ── Users ──
let admSearchTimer;
function admSearchUsers() {
  clearTimeout(admSearchTimer);
  admSearchTimer = setTimeout(admLoadUsers, 350);
}

async function admLoadUsers(page = 1) {
  ADM_USERS_PAGE = page;
  const q = document.getElementById('adm-user-search')?.value || '';
  const filter = document.getElementById('adm-users-filter')?.value || '';
  const tb = document.getElementById('adm-users-tbody');
  tb.innerHTML = '<tr><td colspan="7" style="text-align:center;color:var(--text3);padding:30px">Загрузка...</td></tr>';
  try {
    let url = `/admin/users?page=${page}&limit=30`;
    if (q) url += `&q=${encodeURIComponent(q)}`;
    const d = await api('GET', url);
    ADM_USERS = d.users;
    // Filter locally if needed
    let users = d.users;
    if (filter === 'banned') users = users.filter(u => u.banned);
    else if (filter === 'muted') users = users.filter(u => u.muted);
    else if (filter === 'online') users = users.filter(u => u.online);
    const countEl = document.getElementById('adm-users-count');
    if (countEl) countEl.textContent = `${d.total} пользователей`;
    admRenderUsers(users);
    admRenderPages('adm-users-pages', d.page, d.pages, p => admLoadUsers(p));
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

function admRenderUsers(users) {
  const tb = document.getElementById('adm-users-tbody');
  if (!users.length) {
    tb.innerHTML = '<tr><td colspan="7" style="text-align:center;color:var(--text3);padding:30px">Нет пользователей</td></tr>';
    return;
  }
  tb.innerHTML = users.map(u => {
    const onlineDot = u.online
      ? '<span class="adm-status-dot online"></span>'
      : u.banned
        ? '<span class="adm-status-dot banned"></span>'
        : u.muted
          ? '<span class="adm-status-dot muted"></span>'
          : '<span class="adm-status-dot offline"></span>';

    const avaHtml = u.avaImg
      ? `<div class="adm-ava"><img src="${u.avaImg}" alt=""></div>`
      : `<div class="adm-ava" style="background:hsl(${(u.color||0)*40},50%,25%);color:hsl(${(u.color||0)*40},70%,75%)">${(u.name||'?')[0].toUpperCase()}</div>`;

    const warnBadge = u.warnCount > 0 ? `<span class="adm-warn-badge">⚠️ ${u.warnCount}</span>` : '—';
    const tags = [];
    if (u.banned) tags.push('<span class="adm-tag banned">БАН</span>');
    if (u.muted) tags.push('<span class="adm-tag muted">МЬЮ</span>');
    const tagsHtml = tags.join('');
    const date = u.createdAt ? new Date(u.createdAt).toLocaleDateString('ru') : '—';
    const banInfo = u.banned && u.banReason ? `<div style="font-size:10px;color:var(--red);margin-top:2px">Причина: ${escHtml(u.banReason)}</div>` : '';
    const muteUntil = u.muted && u.muteUntil ? new Date(u.muteUntil).toLocaleString('ru') : '';

    return `<tr style="cursor:pointer" onclick="admShowUserInfo('${u.uid}')">
      <td>
        <div class="adm-user-row">
          ${avaHtml}
          <div class="adm-user-info">
            <strong>${escHtml(u.name)}</strong>
            <small>${escHtml(u.username||'')} ${tagsHtml}</small>
            ${banInfo}
            ${muteUntil ? `<small style="color:var(--yellow)">Мьют до: ${muteUntil}</small>` : ''}
          </div>
        </div>
      </td>
      <td style="font-size:11px;color:var(--text3)">${escHtml(u.email||'')}</td>
      <td style="white-space:nowrap">${onlineDot}<span style="font-size:11px;color:${u.online ? 'var(--green)' : 'var(--text3)'}">${u.online ? 'Онлайн' : 'Офлайн'}</span></td>
      <td>${warnBadge}</td>
      <td style="font-size:11px;color:var(--text3)">${u.banUntil > Date.now() ? `<span style="color:var(--red)">до ${new Date(u.banUntil).toLocaleDateString('ru')}</span>` : (u.banned ? '<span style="color:var(--red)">Навсегда</span>' : '—')}</td>
      <td style="font-size:11px;color:var(--text3)">${date}</td>
      <td onclick="event.stopPropagation()">
        <div class="adm-actions">
          <button class="adm-btn neutral" onclick="admOpenEdit('${u.uid}')" title="Редактировать">✏️</button>
          <button class="adm-btn warn" onclick="admOpenWarn('${u.uid}')" title="Предупредить">⚠️</button>
          ${u.banned
            ? `<button class="adm-btn success" onclick="admUnban('${u.uid}')" title="Разбанить">✅ Разбан</button>`
            : `<button class="adm-btn danger" onclick="admOpenBan('${u.uid}','${escHtml(u.name)}')" title="Забанить">🚫 Бан</button>`}
          ${u.muted
            ? `<button class="adm-btn neutral" onclick="admUnmute('${u.uid}')" title="Снять мьют">🔊 Мьют↑</button>`
            : `<button class="adm-btn warn" onclick="admOpenMute('${u.uid}','${escHtml(u.name)}')" title="Замьютить">🔇 Мьют</button>`}
          <button class="adm-btn neutral" onclick="admOpenKick('${u.uid}')" title="Кикнуть">👢</button>
          <button class="adm-btn neutral" onclick="admViewMsgs('${u.uid}')" title="Сообщения">💬</button>
          <button class="adm-btn primary" onclick="admSendNote('${u.uid}')" title="Уведомление">📨</button>
          <button class="adm-btn neutral" onclick="admOpenNotes('${u.uid}','${escHtml(u.name)}')" title="Заметки">📝</button>
          <button class="adm-btn danger" onclick="admDeleteUser('${u.uid}','${escHtml(u.name)}')" title="Удалить">🗑</button>
        </div>
      </td>
    </tr>`;
  }).join('');
}

function admRenderPages(id, page, pages, cb) {
  const el = document.getElementById(id);
  if (!el || pages <= 1) { if (el) el.innerHTML = ''; return; }
  let html = '';
  const start = Math.max(1, page - 2);
  const end = Math.min(pages, page + 2);
  if (start > 1) html += `<button class="adm-page-btn" data-page="1">1</button>${start > 2 ? '<span style="color:var(--text3)">…</span>' : ''}`;
  for (let i = start; i <= end; i++) {
    html += `<button class="adm-page-btn${i === page ? ' on' : ''}" data-page="${i}">${i}</button>`;
  }
  if (end < pages) html += `${end < pages - 1 ? '<span style="color:var(--text3)">…</span>' : ''}<button class="adm-page-btn" data-page="${pages}">${pages}</button>`;
  el.innerHTML = html;
  el.querySelectorAll('.adm-page-btn').forEach(btn => {
    btn.addEventListener('click', () => cb(parseInt(btn.dataset.page)));
  });
}

// ── Edit user ──
function admOpenEdit(uid) {
  const u = ADM_USERS.find(x => x.uid === uid);
  if (!u) return;
  document.getElementById('adm-edit-uid').value = uid;
  document.getElementById('adm-edit-name').value = u.name || '';
  document.getElementById('adm-edit-username').value = (u.username || '').replace('@', '');
  document.getElementById('adm-edit-pass').value = '';
  document.getElementById('adm-edit-status').value = u.status || 'online';
  document.getElementById('adm-edit-modal').classList.add('on');
}

async function admSaveUser() {
  const uid = document.getElementById('adm-edit-uid').value;
  const name = document.getElementById('adm-edit-name').value.trim();
  const username = document.getElementById('adm-edit-username').value.trim();
  const pass = document.getElementById('adm-edit-pass').value;
  const status = document.getElementById('adm-edit-status').value;
  try {
    await api('PATCH', `/admin/user/${uid}`, { name, username, status });
    if (pass) {
      if (pass.length < 6) { admToast('error', 'Ошибка', 'Пароль минимум 6 символов'); return; }
      await api('POST', `/admin/reset-password/${uid}`, { newPassword: pass });
    }
    document.getElementById('adm-edit-modal').classList.remove('on');
    admToast('success', 'Сохранено', `Профиль пользователя обновлён`);
    admLoadUsers(ADM_USERS_PAGE);
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Ban ──
function admOpenBan(uid, name) {
  document.getElementById('adm-ban-uid').value = uid;
  document.getElementById('adm-ban-reason').value = '';
  document.getElementById('adm-ban-duration').value = '0';
  document.getElementById('adm-ban-unit').value = 'hours';
  const hint = document.getElementById('adm-ban-name-hint');
  if (hint) hint.textContent = name ? `Блокировка: ${name}` : '';
  document.getElementById('adm-ban-modal').classList.add('on');
}

async function admConfirmBan() {
  const uid = document.getElementById('adm-ban-uid').value;
  const reason = document.getElementById('adm-ban-reason').value.trim() || 'Нарушение правил';
  let duration = parseInt(document.getElementById('adm-ban-duration').value) || 0;
  const unit = document.getElementById('adm-ban-unit')?.value || 'hours';
  if (unit === 'days') duration *= 24; // convert days to hours
  try {
    await api('POST', `/admin/ban/${uid}`, { reason, duration });
    document.getElementById('adm-ban-modal').classList.remove('on');
    admToast('success', 'Забанен', `Пользователь заблокирован${duration ? ` на ${duration}ч` : ' навсегда'}`);
    admLoadUsers(ADM_USERS_PAGE);
    admLoadStats();
  } catch(e) { admToast('error', 'Ошибка бана', e.message); }
}

async function admUnban(uid) {
  try {
    await api('DELETE', `/admin/ban/${uid}`);
    admToast('success', 'Разбанен', 'Блокировка снята');
    admLoadUsers(ADM_USERS_PAGE);
    admLoadStats();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Warn ──
function admOpenWarn(uid) {
  document.getElementById('adm-warn-uid').value = uid;
  document.getElementById('adm-warn-reason').value = '';
  document.getElementById('adm-warn-modal').classList.add('on');
}

async function admConfirmWarn() {
  const uid = document.getElementById('adm-warn-uid').value;
  const reason = document.getElementById('adm-warn-reason').value.trim() || 'Нарушение правил';
  try {
    const d = await api('POST', `/admin/warn/${uid}`, { reason });
    document.getElementById('adm-warn-modal').classList.remove('on');
    if (d.autoBanned) {
      admToast('error', 'Автобан!', `${d.warnCount} предупреждений → автоматическая блокировка`);
    } else {
      admToast('warn', `Предупреждение #${d.warnCount}`, 'Предупреждение выдано пользователю');
    }
    admLoadUsers(ADM_USERS_PAGE);
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Mute ──
function admOpenMute(uid, name) {
  document.getElementById('adm-mute-uid').value = uid;
  document.getElementById('adm-mute-reason').value = '';
  document.getElementById('adm-mute-duration').value = '60';
  document.getElementById('adm-mute-unit').value = 'minutes';
  const hint = document.getElementById('adm-mute-name-hint');
  if (hint) hint.textContent = name ? `Мьют: ${name}` : '';
  document.getElementById('adm-mute-modal').classList.add('on');
}

async function admConfirmMute() {
  const uid = document.getElementById('adm-mute-uid').value;
  const reason = document.getElementById('adm-mute-reason').value.trim() || 'Нарушение правил';
  let duration = parseInt(document.getElementById('adm-mute-duration').value) || 0;
  const unit = document.getElementById('adm-mute-unit')?.value || 'minutes';
  // Convert to minutes for the API
  if (unit === 'hours') duration *= 60;
  else if (unit === 'days') duration *= 60 * 24;
  try {
    await api('POST', `/admin/mute/${uid}`, { reason, duration });
    document.getElementById('adm-mute-modal').classList.remove('on');
    admToast('success', 'Замьючен', `Пользователь замьючен${duration ? ` на ${duration} мин` : ' навсегда'}`);
    admLoadUsers(ADM_USERS_PAGE);
    admLoadStats();
  } catch(e) { admToast('error', 'Ошибка мьюта', e.message); }
}

async function admUnmute(uid) {
  try {
    await api('DELETE', `/admin/mute/${uid}`);
    admToast('success', 'Мьют снят', 'Пользователь снова может писать');
    admLoadUsers(ADM_USERS_PAGE);
    admLoadStats();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Kick ──
function admOpenKick(uid) {
  document.getElementById('adm-kick-uid').value = uid;
  document.getElementById('adm-kick-reason').value = '';
  document.getElementById('adm-kick-modal').classList.add('on');
}

async function admConfirmKick() {
  const uid = document.getElementById('adm-kick-uid').value;
  const reason = document.getElementById('adm-kick-reason').value.trim();
  try {
    await api('POST', `/admin/kick/${uid}`, { reason });
    document.getElementById('adm-kick-modal').classList.remove('on');
    admToast('success', 'Кикнут', 'Пользователь отключён от сервера');
    admLoadSessions();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Quick note/announce from user table ──
function admSendNote(uid) {
  const u = ADM_USERS.find(x => x.uid === uid);
  document.getElementById('adm-ann-uid').value = uid;
  document.getElementById('adm-ann-text').value = '';
  // Switch to announce tab
  const btn = document.querySelector('.adm-nav-btn[onclick*="announce"]');
  if (btn) admTab('announce', btn);
  admToast('info', 'Готово', 'Введите сообщение для пользователя');
}

// ── Delete user ──
async function admDeleteUser(uid, name) {
  // Double confirm via modal
  const confirmed = await admShowConfirm(
    '🗑 Удалить аккаунт?',
    `Аккаунт "${name}" будет удалён НАВСЕГДА вместе со всеми сообщениями. Это действие необратимо.`
  );
  if (!confirmed) return;
  try {
    await api('DELETE', `/admin/user/${uid}`);
    admToast('success', 'Удалено', `Аккаунт ${name} удалён`);
    admLoadUsers(ADM_USERS_PAGE);
    admLoadStats();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Confirm dialog (returns Promise<boolean>) ──
function admShowConfirm(title, text) {
  return new Promise(resolve => {
    const overlay = document.createElement('div');
    overlay.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(12px);z-index:9200;display:flex;align-items:center;justify-content:center';
    overlay.innerHTML = `
      <div style="background:linear-gradient(145deg,#130a0a,#0d0608);border:1px solid rgba(255,80,80,.15);border-top:1px solid rgba(255,80,80,.3);border-radius:22px;padding:36px;text-align:center;width:380px;max-width:95vw;box-shadow:0 50px 100px rgba(0,0,0,.9),0 0 60px rgba(255,50,50,.1);animation:admPanelIn .3s cubic-bezier(.34,1.2,.64,1) both">
        <div style="font-size:36px;margin-bottom:16px">⚠️</div>
        <div style="font-family:'Syne',sans-serif;font-size:18px;font-weight:800;color:var(--red);margin-bottom:10px">${title}</div>
        <div style="font-size:13px;color:var(--text3);line-height:1.6;margin-bottom:24px">${text}</div>
        <div style="display:flex;gap:12px;justify-content:center">
          <button id="adm-confirm-no" class="adm-btn neutral lg" style="min-width:120px">Отмена</button>
          <button id="adm-confirm-yes" class="adm-btn danger lg" style="min-width:120px">Подтвердить</button>
        </div>
      </div>
    `;
    document.body.appendChild(overlay);
    overlay.querySelector('#adm-confirm-no').onclick = () => { overlay.remove(); resolve(false); };
    overlay.querySelector('#adm-confirm-yes').onclick = () => { overlay.remove(); resolve(true); };
  });
}

// ── Sessions ──
async function admLoadSessions() {
  try {
    const d = await api('GET', '/admin/sessions');
    const tb = document.getElementById('adm-sessions-tbody');
    const el = document.getElementById('adm-online-count');
    if (el) el.textContent = d.total || 0;
    if (!d.sessions.length) {
      tb.innerHTML = '<tr><td colspan="4" style="text-align:center;color:var(--text3);padding:30px">Никого онлайн</td></tr>';
      return;
    }
    tb.innerHTML = d.sessions.map(s => `<tr>
      <td>
        <div class="adm-user-row">
          <div class="adm-ava">${(s.name||'?')[0].toUpperCase()}</div>
          <div class="adm-user-info">
            <strong>${escHtml(s.name)}</strong>
            <small>${escHtml(s.username)}</small>
          </div>
        </div>
      </td>
      <td><span class="adm-status-dot online"></span><span style="color:var(--green);font-size:11px">${s.status||'online'}</span></td>
      <td style="font-size:13px;color:var(--text2)">${s.connections} соед.</td>
      <td>
        <div class="adm-actions">
          <button class="adm-btn warn" onclick="admOpenKick('${s.uid}')">👢 Кик</button>
          <button class="adm-btn danger" onclick="admOpenBan('${s.uid}','${escHtml(s.name)}')">🚫 Бан</button>
        </div>
      </td>
    </tr>`).join('');
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Messages ──
function admViewMsgs(uid) {
  const btn = document.querySelector('.adm-nav-btn[onclick*="messages"]');
  if (btn) admTab('messages', btn);
  document.getElementById('adm-msg-uid-inp').value = uid;
  admLoadUserMsgs();
}

async function admLoadUserMsgs() {
  const val = document.getElementById('adm-msg-uid-inp').value.trim();
  if (!val) return;
  const el = document.getElementById('adm-msgs-content');
  el.innerHTML = '<div style="color:var(--text3);padding:20px">Загрузка...</div>';
  try {
    const d = await api('GET', `/admin/messages/${val}?page=1`);
    if (!d.messages.length) {
      el.innerHTML = '<div style="color:var(--text3);padding:30px;text-align:center">Нет сообщений</div>';
      return;
    }
    el.innerHTML = `
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
        <span style="font-size:12px;color:var(--text3)">Показано ${d.messages.length} из ${d.total}</span>
        <button class="adm-btn danger" onclick="admClearUserMsgs('${val}')">🗑 Очистить все</button>
      </div>
      <div class="adm-table-wrap">
        <table class="adm-table">
          <thead><tr><th>От</th><th>Кому</th><th>Сообщение</th><th>Время</th><th></th></tr></thead>
          <tbody>${d.messages.map(m => `<tr>
            <td style="font-size:11px;color:var(--text3)">${m.from.slice(0,10)}</td>
            <td style="font-size:11px;color:var(--text3)">${m.to.slice(0,10)}</td>
            <td style="max-width:300px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${escHtml(m.text||'[медиа]')}</td>
            <td style="font-size:11px;color:var(--text3);white-space:nowrap">${m.time||''}</td>
            <td><button class="adm-btn danger" onclick="admDelMsg('${m.id}')">🗑</button></td>
          </tr>`).join('')}</tbody>
        </table>
      </div>
    `;
  } catch(e) {
    el.innerHTML = `<div style="color:var(--red);padding:20px">Ошибка: ${e.message}</div>`;
  }
}

async function admClearUserMsgs(uid) {
  const ok = await admShowConfirm('🗑 Очистить сообщения?', 'Все сообщения пользователя будут удалены навсегда.');
  if (!ok) return;
  try {
    await api('DELETE', `/admin/messages/${uid}`);
    admToast('success', 'Очищено', 'Сообщения пользователя удалены');
    admLoadUserMsgs();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admDelMsg(msgId) {
  try {
    await api('DELETE', `/admin/message/${msgId}`);
    admToast('success', 'Удалено', 'Сообщение удалено');
    admLoadUserMsgs();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Broadcast ──
function admSetBroadcastType(t, btn) {
  ADM_BROADCAST_TYPE = t;
  btn.closest('.adm-broadcast-type').querySelectorAll('.adm-type-btn').forEach(b => b.classList.remove('on'));
  btn.classList.add('on', t);
}

function admSetAnnType(t, btn) {
  ADM_ANN_TYPE = t;
  btn.closest('.adm-broadcast-type').querySelectorAll('.adm-type-btn').forEach(b => b.classList.remove('on'));
  btn.classList.add('on', t);
}

async function admSendBroadcast() {
  const text = document.getElementById('adm-broadcast-text').value.trim();
  if (!text) { admToast('error', 'Ошибка', 'Введите текст сообщения'); return; }
  try {
    await api('POST', '/admin/broadcast', { text, type: ADM_BROADCAST_TYPE });
    document.getElementById('adm-broadcast-text').value = '';
    admToast('success', 'Отправлено!', `Рассылка (${ADM_BROADCAST_TYPE}) отправлена всем`);
    admLoadBroadcasts();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admLoadBroadcasts() {
  try {
    const d = await api('GET', '/admin/broadcasts');
    const el = document.getElementById('adm-broadcasts-history');
    if (!d.broadcasts.length) {
      el.innerHTML = '<div style="color:var(--text3);font-size:13px;padding:10px 0">История пуста</div>';
      return;
    }
    el.innerHTML = d.broadcasts.map(b => `
      <div class="adm-broadcast-item ${b.type||'info'}">
        <div class="adm-broadcast-text">${escHtml(b.text)}</div>
        <div class="adm-broadcast-meta">
          <span>Тип: ${b.type||'info'}</span>
          <span>${new Date(b.timestamp).toLocaleString('ru')}</span>
        </div>
      </div>
    `).join('');
  } catch {}
}

// ── Log ──
async function admLoadLog(page = 1) {
  ADM_LOG_PAGE = page;
  const action = document.getElementById('adm-log-filter')?.value || '';
  const el = document.getElementById('adm-log-content');
  el.innerHTML = '<div style="color:var(--text3);font-size:13px">Загрузка...</div>';
  try {
    const d = await api('GET', `/admin/log?page=${page}${action ? '&action=' + action : ''}`);
    if (!d.log.length) {
      el.innerHTML = '<div style="color:var(--text3);padding:20px;text-align:center">Нет записей</div>';
      return;
    }
    el.innerHTML = '<div>' + d.log.map(l => {
      const u = ADM_USERS.find(x => x.uid === l.admin_uid);
      const adminName = u ? u.name : l.admin_uid.slice(0, 8);
      return `<div class="adm-log-item">
        <span class="adm-log-action ${l.action}">${l.action}</span>
        <div class="adm-log-details">
          <span style="color:var(--text)">${escHtml(adminName)}</span>
          ${l.target_uid ? `→ <span style="color:var(--text2)">${l.target_uid.slice(0,10)}</span>` : ''}
          ${l.details ? `<br><span style="color:var(--text3)">${escHtml(l.details)}</span>` : ''}
          ${l.ip ? `<span style="color:var(--text3);font-size:10px;margin-left:8px">IP: ${l.ip}</span>` : ''}
        </div>
        <span class="adm-log-time">${new Date(l.timestamp).toLocaleString('ru')}</span>
      </div>`;
    }).join('') + '</div>';
    admRenderPages('adm-log-pages', page, d.pages, p => admLoadLog(p));
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Announce ──
async function admSendAnnounce() {
  const uid = document.getElementById('adm-ann-uid').value.trim();
  const text = document.getElementById('adm-ann-text').value.trim();
  if (!uid || !text) { admToast('error', 'Ошибка', 'Заполните все поля'); return; }
  try {
    await api('POST', `/admin/announce/${uid}`, { text, type: ADM_ANN_TYPE });
    document.getElementById('adm-ann-text').value = '';
    admToast('success', 'Отправлено!', 'Личное уведомление доставлено');
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── Search ──
async function admSearchMessages() {
  const q = document.getElementById('adm-msg-search-inp').value.trim();
  if (!q) return;
  const el = document.getElementById('adm-msg-search-results');
  el.innerHTML = '<div style="color:var(--text3);padding:20px">Поиск...</div>';
  try {
    const d = await api('GET', `/admin/search?q=${encodeURIComponent(q)}`);
    if (!d.results.length) {
      el.innerHTML = '<div style="color:var(--text3);padding:30px;text-align:center">Ничего не найдено</div>';
      return;
    }
    el.innerHTML = `
      <div style="font-size:12px;color:var(--text3);margin-bottom:10px">Найдено: ${d.results.length}</div>
      <div class="adm-table-wrap">
        <table class="adm-table">
          <thead><tr><th>От</th><th>Сообщение</th><th>Время</th><th></th></tr></thead>
          <tbody>${d.results.map(m => `<tr>
            <td style="font-size:11px;color:var(--text3)">${m.from.slice(0,10)}</td>
            <td style="max-width:400px">${escHtml(m.text||'')}</td>
            <td style="font-size:11px;color:var(--text3);white-space:nowrap">${m.time||''}</td>
            <td><button class="adm-btn danger" onclick="admDelMsg('${m.id}')">🗑</button></td>
          </tr>`).join('')}</tbody>
        </table>
      </div>
    `;
  } catch(e) {
    el.innerHTML = `<div style="color:var(--red);padding:20px">Ошибка: ${e.message}</div>`;
  }
}

// ── Danger zone ──
async function admConfirmClearAll() {
  const ok = await admShowConfirm('🗑 Очистить ВСЕ сообщения?', 'НАВСЕГДА удалит каждое сообщение на сервере. Это необратимо.');
  if (!ok) return;
  try {
    await api('POST', '/admin/clear-all-messages');
    admToast('success', 'Очищено', 'Все сообщения удалены');
    admLoadStats();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admExportUsers() {
  try {
    const d = await api('GET', '/admin/users?limit=1000');
    const json = JSON.stringify(d.users, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `perezazhigal_users_${Date.now()}.json`;
    a.click();
    admToast('success', 'Экспорт', 'Файл скачан');
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ── TOAST NOTIFICATION SYSTEM ──
function admToast(type, title, message, duration = 4000) {
  const container = document.getElementById('adm-toasts');
  if (!container) return;

  const icons = { success: '✅', error: '❌', info: 'ℹ️', warn: '⚠️' };
  const toast = document.createElement('div');
  toast.className = `adm-toast ${type}`;
  toast.innerHTML = `
    <div class="adm-toast-line"></div>
    <div class="adm-toast-icon">${icons[type] || 'ℹ️'}</div>
    <div class="adm-toast-body">
      <div class="adm-toast-title">${title}</div>
      ${message ? `<div class="adm-toast-msg">${message}</div>` : ''}
    </div>
    <button class="adm-toast-close" onclick="this.closest('.adm-toast').remove()">✕</button>
    <div class="adm-toast-progress" style="animation-duration:${duration}ms"></div>
  `;
  container.appendChild(toast);

  setTimeout(() => {
    toast.classList.add('out');
    setTimeout(() => toast.remove(), 350);
  }, duration);
}

// ── Legacy compat ──
function admShowNotif(text, type = 'info') {
  const typeMap = { success: 'success', error: 'error', info: 'info' };
  admToast(typeMap[type] || 'info', type === 'error' ? 'Ошибка' : type === 'success' ? 'Готово' : 'Инфо', text);
}

function escHtml(s) {
  return String(s || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
}


// ══════════════════════════════════════════════
// BAN SCREEN + KICK SCREEN FUNCTIONS
// ══════════════════════════════════════════════
function showBanScreen(reason, banUntil) {
  // Create particles
  const particles = document.getElementById('bs-particles');
  if (particles) {
    particles.innerHTML = '';
    for (let i = 0; i < 30; i++) {
      const p = document.createElement('div');
      p.className = 'bs-particle';
      p.style.cssText = `
        left:${Math.random()*100}%;
        animation-duration:${3+Math.random()*6}s;
        animation-delay:${Math.random()*4}s;
        width:${1+Math.random()*3}px;
        height:${1+Math.random()*3}px;
        opacity:${0.3+Math.random()*0.7};
      `;
      particles.appendChild(p);
    }
  }
  const reasonEl = document.getElementById('bs-reason-text');
  if (reasonEl) reasonEl.textContent = reason || 'Нарушение правил платформы';

  const untilEl = document.getElementById('bs-until-wrap');
  if (untilEl) {
    if (!banUntil || banUntil === 0) {
      untilEl.textContent = 'Навсегда';
    } else {
      const d = new Date(banUntil);
      untilEl.textContent = 'До: ' + d.toLocaleString('ru', {day:'numeric',month:'long',year:'numeric',hour:'2-digit',minute:'2-digit'});
    }
  }

  const idEl = document.getElementById('bs-id-wrap');
  if (idEl) idEl.textContent = 'Ban ID: PZ-' + Math.random().toString(36).substr(2,8).toUpperCase();

  const screen = document.getElementById('ban-screen');
  if (screen) {
    screen.classList.add('on');
    document.getElementById('app')?.classList.remove('on');
    document.getElementById('auth').style.display = 'none';
  }

  // If it's a temporary ban, show countdown
  if (banUntil && banUntil > 0) {
    const countdown = document.getElementById('bs-countdown');
    if (countdown) {
      countdown.style.display = 'block';
      function updateBanCountdown() {
        const remaining = Math.max(0, banUntil - Date.now());
        if (remaining === 0) { countdown.innerHTML = '⏰ Бан истёк! <button class="bs-btn" onclick="location.reload()" style="margin-top:8px;display:inline-block">Войти снова</button>'; return; }
        const d = Math.floor(remaining / 86400000);
        const h = Math.floor((remaining % 86400000) / 3600000);
        const m = Math.floor((remaining % 3600000) / 60000);
        const s = Math.floor((remaining % 60000) / 1000);
        countdown.innerHTML = d > 0
          ? `${d}д ${h}ч ${m}м<span> осталось</span>`
          : h > 0
          ? `${h}ч ${m}м ${s}с<span> осталось</span>`
          : `${m}м ${s}с<span> осталось</span>`;
        setTimeout(updateBanCountdown, 1000);
      }
      updateBanCountdown();
    }
  }
}

function showKickScreen(reason) {
  const reasonEl = document.getElementById('ks-reason-text');
  if (reasonEl) reasonEl.textContent = reason || 'Вас отключил администратор';

  const screen = document.getElementById('kick-screen');
  if (screen) {
    screen.classList.add('on');
    document.getElementById('app')?.classList.remove('on');
    document.getElementById('auth').style.display = 'none';
  }
  // Countdown
  let secs = 5;
  const timer = setInterval(() => {
    secs--;
    const reasonEl2 = document.getElementById('ks-reason-text');
    if (reasonEl2) {
      reasonEl2.innerHTML = (reason || 'Вас отключил администратор') + '<br><span style="font-size:11px;color:rgba(255,200,50,.5)">Перезагрузка через ' + secs + 'с...</span>';
    }
    if (secs <= 0) { clearInterval(timer); location.reload(); }
  }, 1000);
}

// ══════════════════════════════════════════════
// CHECK BAN ON LOGIN (called in doAuth)
// ══════════════════════════════════════════════
function checkIfBanned(res) {
  if (res && res.banned) {
    TOKEN = null;
    localStorage.removeItem('pz_token');
    sessionStorage.removeItem('pz_token');
    showBanScreen(res.banReason || 'Нарушение правил', res.banUntil);
    return true;
  }
  return false;
}

// ══════════════════════════════════════════════
// BOT MESSAGING
// ══════════════════════════════════════════════
function admBotTargetChange() {
  const target = document.getElementById('adm-bot-target')?.value;
  const group = document.getElementById('adm-bot-uid-group');
  if (group) group.style.display = target === 'user' ? 'block' : 'none';
}

function admBotTemplate(text) {
  const el = document.getElementById('adm-bot-text');
  if (el) { el.value = text; el.focus(); }
}

async function admSendBotMsg() {
  const target = document.getElementById('adm-bot-target')?.value || 'all';
  const text = document.getElementById('adm-bot-text')?.value.trim();
  if (!text) { admToast('warn', 'Пусто', 'Введите текст сообщения'); return; }

  try {
    if (target === 'all') {
      // Send as broadcast but from bot
      await api('POST', '/admin/broadcast', { text, type: 'info', fromBot: true });
      admToast('success', '✅ Отправлено', 'Сообщение от бота доставлено всем');
    } else {
      const uid = document.getElementById('adm-bot-uid')?.value.trim();
      if (!uid) { admToast('warn', 'Нет UID', 'Укажите пользователя'); return; }
      await api('POST', `/admin/users/${uid}/message`, { text, type: 'info', fromBot: true });
      admToast('success', '✅ Отправлено', `Сообщение от бота доставлено пользователю`);
    }
    document.getElementById('adm-bot-text').value = '';
  } catch(e) {
    admToast('error', 'Ошибка', e.message);
  }
}

// ══════════════════════════════════════════════
// ANALYTICS TAB
// ══════════════════════════════════════════════
async function admLoadAnalytics() {
  try {
    const stats = await api('GET', '/admin/stats');
    const el = (id) => document.getElementById(id);
    if (el('an-total-msgs')) el('an-total-msgs').textContent = stats.totalMessages || '—';
    if (el('an-today-msgs')) el('an-today-msgs').textContent = stats.todayMessages || '—';
    if (el('an-peak-online')) el('an-peak-online').textContent = stats.peakOnline || '—';

    // Render top users
    if (stats.topUsers && el('adm-top-users')) {
      el('adm-top-users').innerHTML = stats.topUsers.slice(0,10).map((u,i)=>`
        <div style="display:flex;align-items:center;gap:12px;padding:10px 14px;background:rgba(255,255,255,.02);border-radius:10px;margin-bottom:6px;border:1px solid var(--border)">
          <div style="width:24px;text-align:center;font-size:14px;font-weight:800;color:${i===0?'#ffd700':i===1?'#c0c0c0':i===2?'#cd7f32':'var(--text3)'}">${i+1}</div>
          <div style="width:32px;height:32px;border-radius:8px;background:var(--surface2);display:flex;align-items:center;justify-content:center;font-size:14px">${(u.name||'?')[0].toUpperCase()}</div>
          <div style="flex:1"><div style="font-size:13px;font-weight:600">${escHtml(u.name||'?')}</div><div style="font-size:11px;color:var(--text3)">@${escHtml(u.username||'')}</div></div>
          <div style="font-size:12px;color:var(--accent);font-weight:700">${u.msgCount||0} сообщ.</div>
        </div>
      `).join('');
    }

    // Week chart
    const days = ['Пн','Вт','Ср','Чт','Пт','Сб','Вс'];
    const weekData = stats.weekActivity || [20,45,38,60,42,80,35];
    const maxVal = Math.max(...weekData, 1);
    const barsEl = el('adm-chart-bars');
    const labelsEl = el('adm-chart-labels');
    if (barsEl) {
      barsEl.innerHTML = weekData.map((v,i)=>`
        <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px">
          <div style="font-size:10px;color:var(--accent2);font-weight:700">${v}</div>
          <div style="width:100%;background:linear-gradient(180deg,var(--accent),rgba(124,107,255,.3));border-radius:4px 4px 0 0;height:${(v/maxVal)*60}px;min-height:4px"></div>
        </div>
      `).join('');
    }
    if (labelsEl) labelsEl.innerHTML = days.map(d=>`<span>${d}</span>`).join('');
  } catch(e) {
    const el = document.getElementById('adm-top-users');
    if (el) el.textContent = 'Ошибка загрузки: ' + e.message;
  }
}

// ══════════════════════════════════════════════
// IP BANS TAB
// ══════════════════════════════════════════════
async function admLoadIPBans() {
  try {
    const data = await api('GET', '/admin/ipbans');
    const tbody = document.getElementById('adm-ipbans-tbody');
    if (!tbody) return;
    if (!data.bans || !data.bans.length) {
      tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;color:var(--text3);padding:30px">Нет активных IP-банов</td></tr>';
      return;
    }
    tbody.innerHTML = data.bans.map(b => `
      <tr>
        <td><code style="font-family:monospace;color:var(--accent2)">${escHtml(b.ip)}</code></td>
        <td>${escHtml(b.reason||'—')}</td>
        <td style="color:var(--text3);font-size:11px">${b.createdAt ? new Date(b.createdAt).toLocaleString('ru') : '—'}</td>
        <td>
          <button class="adm-btn danger" style="padding:4px 10px;font-size:11px" onclick="admRemoveIPBan('${b.ip}')">Снять</button>
        </td>
      </tr>
    `).join('');
  } catch(e) {
    const tbody = document.getElementById('adm-ipbans-tbody');
    if (tbody) tbody.innerHTML = `<tr><td colspan="4" style="text-align:center;color:var(--red);padding:20px">Ошибка: ${e.message}</td></tr>`;
  }
}

async function admAddIPBan() {
  const ip = document.getElementById('adm-ip-inp')?.value.trim();
  const reason = document.getElementById('adm-ip-reason')?.value.trim() || 'Ручная блокировка';
  if (!ip) { admToast('warn', 'Нет IP', 'Введите IP-адрес'); return; }
  try {
    await api('POST', '/admin/ipbans', { ip, reason });
    document.getElementById('adm-ip-inp').value = '';
    document.getElementById('adm-ip-reason').value = '';
    admToast('success', '🚫 IP заблокирован', ip);
    admLoadIPBans();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admRemoveIPBan(ip) {
  try {
    await api('DELETE', `/admin/ipbans/${encodeURIComponent(ip)}`);
    admToast('success', '✅ IP разблокирован', ip);
    admLoadIPBans();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ══════════════════════════════════════════════
// QUICK ACTIONS
// ══════════════════════════════════════════════
async function admQuickUnbanAll() {
  const ok = await admShowConfirm('Разбанить всех?', 'Все активные баны будут сняты.');
  if (!ok) return;
  try {
    await api('POST', '/admin/unban-all');
    admToast('success', '✅ Готово', 'Все баны сняты');
    admLoadUsers(1);
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admQuickUnmuteAll() {
  const ok = await admShowConfirm('Размьютить всех?', 'Все активные мьюты будут сняты.');
  if (!ok) return;
  try {
    await api('POST', '/admin/unmute-all');
    admToast('success', '🔊 Готово', 'Все мьюты сняты');
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admQuickKickAll() {
  const ok = await admShowConfirm('Кикнуть всех онлайн?', 'Все подключённые пользователи будут отключены.');
  if (!ok) return;
  try {
    await api('POST', '/admin/kick-all');
    admToast('success', '👢 Готово', 'Все пользователи кикнуты');
    admLoadSessions();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admQuickResetWarns() {
  const ok = await admShowConfirm('Сбросить все предупреждения?', 'Счётчик варнов всех пользователей будет обнулён.');
  if (!ok) return;
  try {
    await api('POST', '/admin/reset-all-warns');
    admToast('success', '🔄 Готово', 'Все предупреждения сброшены');
    admLoadUsers(1);
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

function admExportCSV() {
  const a = document.createElement('a');
  a.href = '/admin/export/users';
  a.style.display = 'none';
  document.body.appendChild(a);
  // Need auth header — use fetch + blob
  fetch('/admin/export/users', { headers: { 'Authorization': 'Bearer ' + TOKEN } })
    .then(r => r.ok ? r.blob() : Promise.reject('Ошибка'))
    .then(blob => {
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url; link.download = `users_${new Date().toISOString().slice(0,10)}.csv`;
      link.click(); URL.revokeObjectURL(url);
      admToast('success', '📥 Экспорт', 'CSV файл скачан');
    })
    .catch(e => admToast('error', 'Ошибка', String(e)));
}

async function admToggleMaintenance(on) {
  try {
    await api('POST', '/admin/maintenance', { enabled: on });
    admToast('info', on ? '🌙 Режим обслуживания включён' : '✅ Режим обслуживания отключён', '');
  } catch(e) {
    admToast('error', 'Ошибка', e.message);
    document.getElementById('adm-maintenance-toggle').checked = !on;
  }
}

async function admToggleFreeze(on) {
  try {
    await api('POST', '/admin/freeze-chat', { enabled: on });
    admToast('info', on ? '🔕 Чат заморожен' : '✅ Чат разморожен', '');
  } catch(e) {
    admToast('error', 'Ошибка', e.message);
    document.getElementById('adm-freeze-toggle').checked = !on;
  }
}

async function admToggleSlowmode(on) {
  try {
    await api('POST', '/admin/slowmode', { enabled: on });
    admToast('info', on ? '🐢 Slowmode включён' : '✅ Slowmode отключён', '');
  } catch(e) {
    admToast('error', 'Ошибка', e.message);
    document.getElementById('adm-slowmode-toggle').checked = !on;
  }
}

// ══════════════════════════════════════════════
// USER INFO MODAL
// ══════════════════════════════════════════════
async function admShowUserInfo(uid) {
  const overlay = document.getElementById('adm-userinfo-modal');
  overlay.classList.add('on');

  const u = ADM_USERS.find(x => x.uid === uid) || {};

  // Аватарка
  const avaEl = document.getElementById('adm-ui-ava');
  if (u.avaImg) {
    avaEl.innerHTML = `<img src="${u.avaImg}" style="width:100%;height:100%;object-fit:cover">`;
    avaEl.style.background = 'var(--surface2)';
  } else if (u.avaEmo) {
    avaEl.textContent = u.avaEmo;
    avaEl.style.background = `hsl(${(u.color||0)*40},40%,20%)`;
  } else {
    avaEl.textContent = (u.name||'?')[0].toUpperCase();
    avaEl.style.background = `hsl(${(u.color||0)*40},50%,22%)`;
  }

  document.getElementById('adm-ui-name').textContent = u.name || '—';
  document.getElementById('adm-ui-username').textContent = (u.username||'') + ' · ' + (u.email||'');
  document.getElementById('adm-ui-bio').textContent = u.bio || 'Нет описания';

  const badgesEl = document.getElementById('adm-ui-badges');
  const badges = [];
  if (u.online) badges.push('<span style="background:rgba(62,207,142,.15);color:var(--green);border:1px solid rgba(62,207,142,.25);border-radius:8px;padding:2px 10px;font-size:11px;font-weight:700">● Онлайн</span>');
  if (u.banned) badges.push('<span style="background:rgba(255,107,118,.12);color:var(--red);border:1px solid rgba(255,107,118,.2);border-radius:8px;padding:2px 10px;font-size:11px;font-weight:700">🚫 БАН</span>');
  if (u.muted) badges.push('<span style="background:rgba(255,201,72,.12);color:var(--yellow);border:1px solid rgba(255,201,72,.2);border-radius:8px;padding:2px 10px;font-size:11px;font-weight:700">🔇 МЬЮ</span>');
  if (u.warnCount > 0) badges.push(`<span style="background:rgba(255,140,66,.12);color:var(--orange);border:1px solid rgba(255,140,66,.2);border-radius:8px;padding:2px 10px;font-size:11px;font-weight:700">⚠️ ${u.warnCount} варн</span>`);
  badgesEl.innerHTML = badges.join('');

  // Базовая сетка
  const gridEl = document.getElementById('adm-ui-grid');
  const cell = (label, val, color='') => `
    <div style="background:var(--surface);border-radius:10px;padding:10px 14px">
      <div style="font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:4px">${label}</div>
      <div style="font-size:12px;font-weight:600;color:${color||'var(--text)'};word-break:break-all;font-family:monospace">${val||'—'}</div>
    </div>`;

  gridEl.innerHTML =
    cell('UID', escHtml(u.uid||'')) +
    cell('Email', escHtml(u.email||'')) +
    cell('Username', escHtml(u.username||'')) +
    cell('Статус', u.status||'online') +
    cell('Регистрация', u.createdAt ? new Date(u.createdAt).toLocaleString('ru') : '—') +
    cell('Онлайн', u.online ? '<span style="color:var(--green)">Да</span>' : '<span style="color:var(--text3)">Нет</span>') +
    (u.banned ? cell('Бан до', u.banUntil > Date.now() ? new Date(u.banUntil).toLocaleString('ru') : 'Навсегда', 'var(--red)') : '') +
    (u.banned ? cell('Причина бана', escHtml(u.banReason||'—'), 'var(--red)') : '') +
    (u.muted && u.muteUntil ? cell('Мьют до', new Date(u.muteUntil).toLocaleString('ru'), 'var(--yellow)') : '');

  document.getElementById('adm-ui-warns').textContent = u.warnCount || 0;

  document.getElementById('adm-ui-edit-btn').onclick = () => {
    document.getElementById('adm-userinfo-modal').classList.remove('on');
    admOpenEdit(uid);
  };
  const banBtnEl = document.getElementById('adm-ui-ban-btn');
  if (banBtnEl) {
    if (u.banned) {
      banBtnEl.textContent = '✅ Разбанить';
      banBtnEl.className = 'adm-btn success';
      banBtnEl.onclick = () => { document.getElementById('adm-userinfo-modal').classList.remove('on'); admUnban(uid); };
    } else {
      banBtnEl.textContent = '🚫 Бан';
      banBtnEl.className = 'adm-btn danger';
      banBtnEl.onclick = () => { document.getElementById('adm-userinfo-modal').classList.remove('on'); admOpenBan(uid, u.name); };
    }
  }

  // Загружаем детальные данные
  try {
    const d = await api('GET', `/admin/users/${uid}`);
    document.getElementById('adm-ui-msgcount').textContent = d.totalMessages ?? '—';
    document.getElementById('adm-ui-sessions').textContent = d.sessions?.length ?? '—';

    // IP история
    const ipEl = document.getElementById('adm-ui-ip-block');
    if (d.ipHistory && d.ipHistory.length > 0) {
      ipEl.innerHTML = `
        <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:10px">🌐 История IP (${d.ipHistory.length})</div>
        <div style="max-height:140px;overflow-y:auto">
          ${d.ipHistory.map(ip => `
            <div style="display:flex;justify-content:space-between;align-items:flex-start;padding:5px 0;border-bottom:1px solid var(--border);gap:8px">
              <div>
                <div style="font-size:12px;font-weight:700;color:var(--text);font-family:monospace">${escHtml(ip.ip||'?')}</div>
                <div style="font-size:10px;color:var(--text3);margin-top:1px">${escHtml((ip.user_agent||'').slice(0,60))}</div>
              </div>
              <div style="text-align:right;flex-shrink:0">
                <div style="font-size:10px;color:var(--accent2);font-weight:700">${ip.action||'login'}</div>
                <div style="font-size:10px;color:var(--text3)">${new Date(ip.timestamp).toLocaleDateString('ru')} ${new Date(ip.timestamp).toLocaleTimeString('ru',{hour:'2-digit',minute:'2-digit'})}</div>
              </div>
            </div>`).join('')}
        </div>`;
    } else if (d.logIps && d.logIps.length > 0) {
      ipEl.innerHTML = `
        <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:8px">🌐 Известные IP</div>
        ${d.logIps.map(e => `<div style="font-size:12px;font-family:monospace;color:var(--text);padding:3px 0">${escHtml(e.ip||'?')}</div>`).join('')}`;
    } else {
      ipEl.innerHTML = `<div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:6px">🌐 IP адреса</div><div style="font-size:12px;color:var(--text3)">Нет данных об IP</div>`;
    }

    // История модерации
    const modEl = document.getElementById('adm-ui-mod-block');
    if (d.modHistory && d.modHistory.length > 0) {
      modEl.innerHTML = `
        <div style="font-size:11px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:8px">📋 История модерации</div>
        <div style="max-height:120px;overflow-y:auto">
          ${d.modHistory.map(m => `
            <div style="display:flex;justify-content:space-between;align-items:center;padding:4px 0;border-bottom:1px solid var(--border)">
              <div>
                <span style="font-size:11px;font-weight:700;color:var(--text)">${escHtml(m.action||'')}</span>
                ${m.details ? `<span style="font-size:11px;color:var(--text3);margin-left:6px">${escHtml(m.details)}</span>` : ''}
              </div>
              <span style="font-size:10px;color:var(--text3);flex-shrink:0;margin-left:8px">${new Date(m.timestamp).toLocaleDateString('ru')}</span>
            </div>`).join('')}
        </div>`;
      modEl.style.display = '';
    } else {
      modEl.style.display = 'none';
    }

    // Заметки
    const notesEl = document.getElementById('adm-ui-notes-block');
    if (d.notes && d.notes.length > 0) {
      document.getElementById('adm-ui-notes-list').innerHTML = d.notes.map(n =>
        `<div style="padding:6px 0;border-bottom:1px solid var(--border)">
          <div style="font-size:10px;color:var(--text3);margin-bottom:2px">${n.adminName||'Админ'} · ${new Date(n.timestamp).toLocaleDateString('ru')}</div>
          <div style="font-size:12px;color:var(--text2)">${escHtml(n.note)}</div>
        </div>`
      ).join('');
      notesEl.style.display = '';
    } else {
      notesEl.style.display = 'none';
    }

    // Сессии
    if (d.sessions && d.sessions.length > 0) {
      const lastSeen = Math.max(...d.sessions.map(s=>s.last_seen||0));
      document.getElementById('adm-ui-sessions').textContent = `${d.sessions.length} (${lastSeen ? new Date(lastSeen).toLocaleDateString('ru') : '—'})`;
    }

  } catch(e) {
    console.warn('admShowUserInfo detail error', e);
  }
}


// ══════════════════════════════════════════════
// ADMIN NOTES
// ══════════════════════════════════════════════
async function admOpenNotes(uid, name) {
  document.getElementById('adm-notes-uid').value = uid;
  document.getElementById('adm-notes-username').textContent = 'Заметки о: ' + name;
  document.getElementById('adm-notes-text').value = '';
  const histEl = document.getElementById('adm-notes-history');
  histEl.innerHTML = '<div style="color:var(--text3);font-size:12px">Загрузка...</div>';
  document.getElementById('adm-notes-modal').classList.add('on');
  try {
    const d = await api('GET', '/admin/users/' + uid + '/notes');
    const notes = d.notes || [];
    if (!notes.length) {
      histEl.innerHTML = '<div style="color:var(--text3);font-size:12px;padding:8px 0">Нет заметок</div>';
    } else {
      histEl.innerHTML = notes.reverse().map(n=>`
        <div style="padding:8px 10px;background:rgba(255,255,255,.02);border-radius:8px;margin-bottom:6px;border-left:2px solid rgba(124,107,255,.4)">
          <div style="font-size:11px;color:var(--text3);margin-bottom:4px">${new Date(n.createdAt||Date.now()).toLocaleString('ru')} · ${escHtml(n.adminName||'Admin')}</div>
          <div style="font-size:12px;color:var(--text2)">${escHtml(n.text)}</div>
        </div>
      `).join('');
    }
  } catch(e) {
    histEl.innerHTML = '<div style="color:var(--text3);font-size:12px">Ошибка загрузки</div>';
  }
}

async function admSaveNote() {
  const uid = document.getElementById('adm-notes-uid').value;
  const text = document.getElementById('adm-notes-text').value.trim();
  if (!text) { admToast('warn', 'Пусто', 'Введите текст заметки'); return; }
  try {
    await api('POST', '/admin/users/' + uid + '/notes', { text });
    admToast('success', '📝 Заметка сохранена', '');
    document.getElementById('adm-notes-text').value = '';
    admOpenNotes(uid, document.getElementById('adm-notes-username').textContent.replace('Заметки о: ',''));
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ════ Show/hide admin button ════
function updateAdminTrigger() {
  const btn = document.getElementById('adm-trigger-btn');
  if (!btn) return;
  const admins = ['@boss', '@vyyxek'];
  if (ME && admins.includes(ME.username?.toLowerCase())) btn.classList.add('visible');
  else btn.classList.remove('visible');
}
</script>


<!-- ═══ ADMIN NOTES MODAL ═══ -->
<div class="adm-modal-overlay" id="adm-notes-modal">
  <div class="adm-modal">
    <div class="adm-modal-ico blue">📝</div>
    <h3>Заметки администратора</h3>
    <p id="adm-notes-username">Заметки о пользователе</p>
    <input type="hidden" id="adm-notes-uid">
    <div class="adm-inp-group">
      <label>Внутренние заметки (видны только администраторам)</label>
      <textarea class="adm-inp full" id="adm-notes-text" rows="5" placeholder="Введите заметку о пользователе..."></textarea>
    </div>
    <div id="adm-notes-history" style="max-height:160px;overflow-y:auto;margin-bottom:12px"></div>
    <div class="adm-modal-footer">
      <button class="adm-btn neutral" onclick="document.getElementById('adm-notes-modal').classList.remove('on')">Отмена</button>
      <button class="adm-btn primary" onclick="admSaveNote()">💾 Сохранить заметку</button>
    </div>
  </div>
</div>

<!-- ═══ USER INFO MODAL ═══ -->
<div class="adm-modal-overlay" id="adm-userinfo-modal" onclick="if(event.target===this)this.classList.remove('on')">
  <div class="adm-modal" style="max-width:620px;width:95%;max-height:90vh;overflow-y:auto">
    <div style="display:flex;align-items:center;gap:16px;margin-bottom:20px">
      <div id="adm-ui-ava" style="width:68px;height:68px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:30px;flex-shrink:0;overflow:hidden"></div>
      <div style="flex:1;min-width:0">
        <div style="font-size:20px;font-weight:800;color:var(--text)" id="adm-ui-name"></div>
        <div style="font-size:12px;color:var(--text3);margin-top:2px" id="adm-ui-username"></div>
        <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px" id="adm-ui-badges"></div>
      </div>
      <button class="adm-btn neutral" onclick="document.getElementById('adm-userinfo-modal').classList.remove('on')" style="align-self:flex-start;font-size:16px;padding:6px 10px">✕</button>
    </div>

    <!-- Основная сетка -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:12px" id="adm-ui-grid"></div>

    <!-- О себе -->
    <div style="background:var(--surface);border-radius:12px;padding:12px 14px;margin-bottom:10px">
      <div style="font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:5px">💬 О себе</div>
      <div style="font-size:13px;color:var(--text2);line-height:1.6;font-style:italic" id="adm-ui-bio"></div>
    </div>

    <!-- Статистика -->
    <div style="background:var(--surface);border-radius:12px;padding:12px 14px;margin-bottom:10px">
      <div style="font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:10px">📊 Статистика</div>
      <div style="display:flex;gap:20px;flex-wrap:wrap">
        <div style="text-align:center"><div style="font-size:24px;font-weight:800;color:var(--accent)" id="adm-ui-msgcount">…</div><div style="font-size:10px;color:var(--text3)">сообщений</div></div>
        <div style="text-align:center"><div style="font-size:24px;font-weight:800;color:var(--yellow)" id="adm-ui-warns">…</div><div style="font-size:10px;color:var(--text3)">предупреждений</div></div>
        <div style="text-align:center"><div style="font-size:24px;font-weight:800;color:var(--green)" id="adm-ui-sessions">…</div><div style="font-size:10px;color:var(--text3)">сессий</div></div>
      </div>
    </div>

    <!-- IP история -->
    <div style="background:var(--surface);border-radius:12px;padding:12px 14px;margin-bottom:10px" id="adm-ui-ip-block">
      <div style="font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em">🌐 IP адреса</div>
      <div style="font-size:12px;color:var(--text3);margin-top:6px">Загрузка...</div>
    </div>

    <!-- История модерации -->
    <div style="background:var(--surface);border-radius:12px;padding:12px 14px;margin-bottom:10px" id="adm-ui-mod-block">
      <div style="font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em">📋 История модерации</div>
      <div style="font-size:12px;color:var(--text3);margin-top:6px">Загрузка...</div>
    </div>

    <!-- Заметки -->
    <div style="background:var(--surface);border-radius:12px;padding:12px 14px;margin-bottom:14px" id="adm-ui-notes-block">
      <div style="font-size:10px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:8px">📝 Заметки</div>
      <div id="adm-ui-notes-list" style="font-size:12px;color:var(--text2);line-height:1.7"></div>
    </div>

    <div class="adm-modal-footer">
      <button class="adm-btn neutral" onclick="document.getElementById('adm-userinfo-modal').classList.remove('on')">Закрыть</button>
      <button class="adm-btn warn" id="adm-ui-ban-btn">🚫 Бан</button>
      <button class="adm-btn primary" id="adm-ui-edit-btn">✏️ Редактировать</button>
    </div>
  </div>
</div>

<!-- ═══ IMPERSONATE MODAL ═══ -->
<div class="adm-modal-overlay" id="adm-impersonate-modal" onclick="if(event.target===this)this.classList.remove('on')">
  <div class="adm-modal" style="max-width:500px">
    <div class="adm-modal-ico" style="background:rgba(255,140,66,.1);border-color:rgba(255,140,66,.25);font-size:28px">🎭</div>
    <h3>Маскировка</h3>
    <p style="color:var(--text3)">Отправить сообщение от имени другого пользователя</p>
    <input type="hidden" id="imp-uid">
    <div style="background:rgba(255,140,66,.06);border:1px solid rgba(255,140,66,.2);border-radius:10px;padding:10px 12px;margin-bottom:12px;font-size:12px;color:var(--yellow)">
      ⚠️ Сообщение будет отправлено в переписку с выбранным собеседником от имени этого пользователя
    </div>
    <div class="adm-inp-group">
      <label>Собеседник (получатель)</label>
      <input class="adm-inp full" id="imp-target-uid" placeholder="UID или @username получателя...">
    </div>
    <div class="adm-inp-group">
      <label>Текст сообщения</label>
      <textarea class="adm-inp full" id="imp-text" rows="4" placeholder="Введите текст, который будет отправлен от имени пользователя..." oninput="admImpersonatePreview()"></textarea>
    </div>
    <div class="impersonate-preview" id="imp-preview">
      <div style="font-size:10px;color:var(--text3);margin-bottom:6px">Превью:</div>
      <div class="imp-fake-bubble" id="imp-preview-text"></div>
    </div>
    <div class="adm-modal-footer">
      <button class="adm-btn neutral" onclick="document.getElementById('adm-impersonate-modal').classList.remove('on')">Отмена</button>
      <button class="adm-btn warn" onclick="admConfirmImpersonate()" style="background:rgba(255,140,66,.15);border-color:rgba(255,140,66,.3);color:var(--orange)">🎭 Отправить под маскировкой</button>
    </div>
  </div>
</div>

<!-- ═══ SHADOW MUTE CONFIRM MODAL ═══ -->
<div class="adm-modal-overlay" id="adm-shadowmute-modal" onclick="if(event.target===this)this.classList.remove('on')">
  <div class="adm-modal">
    <div class="adm-modal-ico" style="background:rgba(79,195,247,.08);border-color:rgba(79,195,247,.2);font-size:28px">👻</div>
    <h3>Теневой мьют</h3>
    <input type="hidden" id="shadowmute-uid">
    <p id="shadowmute-name-hint" style="color:var(--accent3)"></p>
    <div style="background:rgba(79,195,247,.05);border:1px solid rgba(79,195,247,.15);border-radius:10px;padding:12px;margin-bottom:14px;font-size:12px;color:var(--text2);line-height:1.6">
      👻 <strong>Теневой мьют</strong> — пользователь думает, что его сообщения отправляются, но другие пользователи их не видят. Идеально для скрытой модерации без конфликтов.
    </div>
    <div class="adm-inp-group">
      <label>Длительность (часов, 0 = навсегда)</label>
      <input class="adm-inp full" id="shadowmute-duration" type="number" value="24" min="0">
    </div>
    <div class="adm-modal-footer">
      <button class="adm-btn neutral" onclick="document.getElementById('adm-shadowmute-modal').classList.remove('on')">Отмена</button>
      <button class="adm-btn" style="background:rgba(79,195,247,.12);border-color:rgba(79,195,247,.3);color:var(--accent3)" onclick="admConfirmShadowMute()">👻 Применить теневой мьют</button>
    </div>
  </div>
</div>

<script>
// ════════════════════════════════════════════
// NEW ADMIN FEATURES v3 — SPY / MULTI / GEO / LIVEFEED / AUTOMOD / ROLES
// ════════════════════════════════════════════

// ── Override admTab to load new tabs ──
const _origAdmTab = window.admTab;
window.admTab = function(name, btn) {
  _origAdmTab(name, btn);
  const loaders = {
    spy: () => admSpyInit(),
    multiaccounts: () => admLoadMultiAccounts(),
    geoip: () => {},
    livefeed: () => admStartLiveFeed(),
    automod: () => admLoadAutomodRules(),
    roles: () => { admLoadRoles(); admLoadVerifiedList(); },
  };
  if (loaders[name]) loaders[name]();
};

// ══════════════════════════════════
// 🕵️ SPY MODE
// ══════════════════════════════════
let SPY_USER_A = null, SPY_USER_B = null, SPY_ROOM = null;
let SPY_REFRESH_TMR = null;

function admSpyInit() {
  // nothing on init, wait for user input
}

async function admSpySearch(side) {
  const val = document.getElementById('spy-user-' + side).value.trim();
  const suggest = document.getElementById('spy-suggest-' + side);
  if (!val || val.length < 2) { suggest.innerHTML = ''; return; }
  try {
    const d = await api('GET', '/admin/users?q=' + encodeURIComponent(val) + '&limit=5');
    suggest.innerHTML = (d.users||[]).map(u => `
      <div class="spy-user-card" onclick="admSpyPickUser('${side}','${u.uid}','${escHtml(u.name)}','${escHtml(u.username||'')}')">
        <div class="adm-ava" style="width:28px;height:28px;font-size:12px;flex-shrink:0">${(u.name||'?')[0]}</div>
        <div><div style="font-size:12px;font-weight:700">${escHtml(u.name)}</div><div style="font-size:10px;color:var(--text3)">${escHtml(u.username||u.uid)}</div></div>
        ${u.online ? '<span style="width:7px;height:7px;border-radius:50%;background:var(--green);display:inline-block;margin-left:auto"></span>' : ''}
      </div>
    `).join('');
  } catch {}
}

function admSpyPickUser(side, uid, name, username) {
  if (side === 'a') { SPY_USER_A = { uid, name, username }; }
  else { SPY_USER_B = { uid, name, username }; }
  document.getElementById('spy-user-' + side).value = name + ' (' + username + ')';
  document.getElementById('spy-suggest-' + side).innerHTML = '';
}

async function admSpyLoad() {
  if (!SPY_USER_A) {
    const val = document.getElementById('spy-user-a').value.trim();
    if (!val) { admToast('warn', '⚠️ Ошибка', 'Выберите пользователя A'); return; }
    // Try to resolve by uid/username
    try {
      const d = await api('GET', '/admin/users?q=' + encodeURIComponent(val) + '&limit=1');
      if (d.users && d.users[0]) SPY_USER_A = d.users[0];
      else { admToast('warn', '⚠️', 'Пользователь не найден'); return; }
    } catch { admToast('error', 'Ошибка', 'Не удалось найти'); return; }
  }

  // Load conversations
  try {
    const d = await api('GET', '/admin/spy/' + SPY_USER_A.uid);
    const convs = d.conversations || [];
    const convList = document.getElementById('spy-conv-list');
    const convSection = document.getElementById('spy-convs-section');
    const shadowPanel = document.getElementById('spy-shadow-panel');
    const shadowBtns = document.getElementById('spy-shadow-btns');
    convSection.style.display = 'block';
    shadowPanel.style.display = 'block';

    if (!convs.length) {
      convList.innerHTML = '<div class="spy-empty">Нет переписок</div>';
    } else {
      convList.innerHTML = convs.map(c => `
        <div class="spy-conv-item" onclick="admSpyOpenRoom('${c.room_id}','${escHtml(c.partner_name||c.partner_uid)}')">
          <div style="width:28px;height:28px;border-radius:50%;background:var(--surface3);display:flex;align-items:center;justify-content:center;font-size:12px;flex-shrink:0">${(c.partner_name||'?')[0]}</div>
          <div style="flex:1;min-width:0">
            <div style="font-size:12px;font-weight:700;truncate">${escHtml(c.partner_name||c.partner_uid)}</div>
            <div style="font-size:10px;color:var(--text3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${escHtml(c.last_text||'...')}</div>
          </div>
          <div style="font-size:9px;color:var(--text3);white-space:nowrap">${c.msg_count} сообщ.</div>
        </div>
      `).join('');
    }

    // Shadow action buttons
    shadowBtns.innerHTML = `
      <button class="adm-btn" style="font-size:11px;background:rgba(79,195,247,.08);border-color:rgba(79,195,247,.2);color:var(--accent3)" onclick="admOpenShadowMute('${SPY_USER_A.uid}','${escHtml(SPY_USER_A.name)}')">👻 Теневой мьют</button>
      <button class="adm-btn warn" style="font-size:11px" onclick="admOpenImpersonate('${SPY_USER_A.uid}','${escHtml(SPY_USER_A.name)}')">🎭 Маскировка</button>
      <button class="adm-btn danger" style="font-size:11px" onclick="admOpenKick('${SPY_USER_A.uid}')">👢 Тихий кик</button>
      <button class="adm-btn" style="font-size:11px;background:rgba(255,255,255,.04)" onclick="admShowUserInfo('${SPY_USER_A.uid}')">👤 Профиль</button>
    `;

    document.getElementById('spy-live-indicator').style.display = 'inline-flex';
    admToast('success', '🕵️ Слежка активна', 'Загружено ' + convs.length + ' переписок');
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

let SPY_AUTO_REFRESH = null;

async function admSpyOpenRoom(roomId, partnerName) {
  SPY_ROOM = roomId;
  document.querySelectorAll('.spy-conv-item').forEach(el => {
    el.classList.toggle('on', el.onclick?.toString().includes(roomId));
  });
  document.getElementById('spy-msgs-section').style.display = 'block';
  document.getElementById('spy-msgs-header').textContent = '💬 ' + partnerName;
  await admSpyRefreshMsgs();

  // Auto-refresh every 5 seconds
  clearInterval(SPY_AUTO_REFRESH);
  SPY_AUTO_REFRESH = setInterval(admSpyRefreshMsgs, 5000);
}

async function admSpyRefreshMsgs() {
  if (!SPY_ROOM || !SPY_USER_A) return;
  try {
    const d = await api('GET', '/admin/messages/' + SPY_USER_A.uid + '?room=' + encodeURIComponent(SPY_ROOM) + '&page=1&limit=60');
    const msgs = d.messages || [];
    const stream = document.getElementById('spy-msg-stream');
    if (!msgs.length) {
      stream.innerHTML = '<div class="spy-empty">Нет сообщений в этой переписке</div>';
      return;
    }
    stream.innerHTML = msgs.map(m => {
      const isA = m.from === SPY_USER_A.uid;
      return `<div class="spy-msg ${isA ? 'from-a' : 'from-b'}">
        <div class="spy-msg-meta">${isA ? '👤 ' + escHtml(SPY_USER_A.name) : '💬 Собеседник'} · ${m.time||new Date(m.timestamp).toLocaleTimeString('ru')}</div>
        ${escHtml(m.text||'[медиа]')}
        ${m.shadowMuted ? '<span style="font-size:9px;color:var(--text3);display:block;margin-top:3px">👻 теневой мьют</span>' : ''}
      </div>`;
    }).join('');
    stream.scrollTop = stream.scrollHeight;
  } catch {}
}

function admSpyRefresh() {
  if (SPY_ROOM) admSpyRefreshMsgs();
  else admSpyLoad();
}

async function admSpyClearRoom() {
  if (!SPY_ROOM || !SPY_USER_A) return;
  const ok = await admShowConfirm('🗑 Удалить переписку?', 'Все сообщения в этой переписке будут удалены навсегда.');
  if (!ok) return;
  try {
    await api('DELETE', '/admin/messages/' + SPY_USER_A.uid);
    admToast('success', 'Удалено', 'Переписка очищена');
    admSpyRefreshMsgs();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admSpyInject() {
  const text = document.getElementById('spy-inject-text').value.trim();
  const side = document.getElementById('spy-inject-as').value;
  if (!text) return;
  if (!SPY_USER_A || !SPY_ROOM) { admToast('warn', 'Ошибка', 'Сначала откройте переписку'); return; }
  const uid = side === 'a' ? SPY_USER_A.uid : SPY_ROOM.split(':').find(id => id !== SPY_USER_A.uid);
  if (!uid) { admToast('warn', 'Ошибка', 'Не определён собеседник'); return; }
  try {
    await api('POST', '/admin/impersonate', { fromUid: uid, text, targetUid: side === 'a' ? SPY_ROOM.split(':').find(id => id !== SPY_USER_A.uid) : SPY_USER_A.uid });
    document.getElementById('spy-inject-text').value = '';
    admToast('success', '⚡ Инъекция', 'Сообщение вставлено в переписку');
    setTimeout(admSpyRefreshMsgs, 600);
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ══════════════════════════════════
// 👥 MULTI-ACCOUNT DETECTION
// ══════════════════════════════════
async function admLoadMultiAccounts() {
  const el = document.getElementById('adm-multi-results');
  el.innerHTML = '<div style="text-align:center;color:var(--text3);padding:30px"><div style="font-size:32px;margin-bottom:8px">🔍</div>Сканирование...</div>';
  try {
    const d = await api('GET', '/admin/multi-accounts');
    const groups = d.groups || [];
    const stats = document.getElementById('adm-multi-stats');
    stats.innerHTML = `
      <div style="background:rgba(255,201,72,.06);border:1px solid rgba(255,201,72,.15);border-radius:8px;padding:10px 14px;text-align:center">
        <div style="font-size:20px;font-weight:800;color:var(--yellow)">${groups.length}</div>
        <div style="font-size:10px;color:var(--text3)">Подозрительных IP</div>
      </div>
      <div style="background:rgba(255,107,118,.06);border:1px solid rgba(255,107,118,.15);border-radius:8px;padding:10px 14px;text-align:center">
        <div style="font-size:20px;font-weight:800;color:var(--red)">${groups.reduce((s,g)=>s+g.users.length,0)}</div>
        <div style="font-size:10px;color:var(--text3)">Подозрительных аккаунтов</div>
      </div>
      <div style="background:rgba(124,107,255,.06);border:1px solid rgba(124,107,255,.15);border-radius:8px;padding:10px 14px;text-align:center">
        <div style="font-size:20px;font-weight:800;color:var(--accent)">${d.totalChecked||0}</div>
        <div style="font-size:10px;color:var(--text3)">Проверено IP</div>
      </div>
    `;
    if (!groups.length) {
      el.innerHTML = '<div style="text-align:center;color:var(--green);padding:40px"><div style="font-size:36px;margin-bottom:8px">✅</div>Мультиаккаунты не обнаружены</div>';
      return;
    }
    el.innerHTML = groups.map(g => `
      <div class="multi-group">
        <div class="multi-group-ip">
          <span>🌐 ${escHtml(g.ip)}</span>
          <span class="multi-risk ${g.users.length >= 3 ? 'high' : 'medium'}">${g.users.length >= 3 ? '🔴 ВЫСОКИЙ РИСК' : '⚠️ ПОДОЗРЕНИЕ'}</span>
          <span style="margin-left:auto;font-size:10px;color:var(--text3)">${g.users.length} аккаунтов</span>
        </div>
        ${g.users.map(u => `
          <div class="multi-account-row">
            <div class="adm-ava" style="width:26px;height:26px;font-size:11px;flex-shrink:0">${(u.name||'?')[0]}</div>
            <div style="flex:1;min-width:0">
              <div style="font-size:12px;font-weight:700">${escHtml(u.name)}</div>
              <div style="font-size:10px;color:var(--text3)">${escHtml(u.username||'')} · ${new Date(u.createdAt||0).toLocaleDateString('ru')}</div>
            </div>
            ${u.banned ? '<span style="font-size:9px;color:var(--red)">🚫 БАН</span>' : ''}
            <div style="display:flex;gap:4px">
              <button class="adm-btn neutral" style="font-size:10px;padding:3px 7px" onclick="admShowUserInfo('${u.uid}')">👤</button>
              <button class="adm-btn danger" style="font-size:10px;padding:3px 7px" onclick="admOpenBan('${u.uid}','${escHtml(u.name)}')">🚫</button>
            </div>
          </div>
        `).join('')}
        <div style="margin-top:8px;display:flex;gap:6px">
          <button class="adm-btn danger" style="font-size:10px" onclick="admMultiBanAll('${g.ip}')">🚫 Забанить всех с этого IP</button>
          <button class="adm-btn warn" style="font-size:10px" onclick="admAddIPBanDirect('${g.ip}')">🔒 IP-бан</button>
        </div>
      </div>
    `).join('');
  } catch(e) { admToast('error', 'Ошибка', e.message); el.innerHTML = `<div style="color:var(--red);padding:20px">Ошибка: ${e.message}</div>`; }
}

async function admMultiBanAll(ip) {
  const ok = await admShowConfirm('🚫 Массовый бан?', `Заблокировать всех пользователей с IP ${ip}?`);
  if (!ok) return;
  try {
    const d = await api('POST', '/admin/multi-ban', { ip, reason: 'Мультиаккаунт' });
    admToast('success', '🚫 Забанено', `${d.banned} аккаунтов заблокировано`);
    admLoadMultiAccounts();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

function admAddIPBanDirect(ip) {
  document.getElementById('adm-ip-inp').value = ip;
  document.getElementById('adm-ip-reason').value = 'Мультиаккаунт';
  admAddIPBan();
}

// ══════════════════════════════════
// 🌍 GEOIP LOOKUP
// ══════════════════════════════════
async function admGeoLookup() {
  const val = document.getElementById('geoip-search-uid').value.trim();
  if (!val) return;
  const area = document.getElementById('geoip-result-area');
  area.innerHTML = '<div style="text-align:center;color:var(--text3);padding:30px"><div style="font-size:32px;margin-bottom:8px">🔍</div>Определяю...</div>';

  try {
    // Try to get user's IPs first
    let ips = [];
    let userName = '';
    if (val.startsWith('u_') || val.startsWith('@')) {
      try {
        const d = await api('GET', '/admin/users?q=' + encodeURIComponent(val.replace('@','')) + '&limit=1');
        if (d.users && d.users[0]) {
          const uid = d.users[0].uid;
          userName = d.users[0].name;
          const info = await api('GET', '/admin/users/' + uid + '/info');
          ips = (info.ipHistory || []).slice(0,5).map(i => i.ip);
        }
      } catch {}
    }
    // If direct IP
    if (!ips.length) ips = [val];

    // Geo lookup via public API (client-side)
    const results = [];
    for (const ip of ips.slice(0,3)) {
      if (!ip || ip === '::1' || ip.startsWith('127.') || ip.startsWith('192.168.') || ip.startsWith('10.')) {
        results.push({ ip, local: true });
        continue;
      }
      try {
        const r = await fetch('https://ipapi.co/' + ip + '/json/');
        const geo = await r.json();
        results.push({ ip, ...geo });
      } catch {
        results.push({ ip, error: true });
      }
    }

    const countryFlags = { RU:'🇷🇺', US:'🇺🇸', DE:'🇩🇪', UA:'🇺🇦', GB:'🇬🇧', FR:'🇫🇷', CN:'🇨🇳', JP:'🇯🇵', KZ:'🇰🇿', BY:'🇧🇾', TR:'🇹🇷', PL:'🇵🇱', NL:'🇳🇱', SE:'🇸🇪', CA:'🇨🇦', AU:'🇦🇺', BR:'🇧🇷', IN:'🇮🇳', KR:'🇰🇷', IT:'🇮🇹', ES:'🇪🇸', CZ:'🇨🇿', FI:'🇫🇮', NO:'🇳🇴', DK:'🇩🇰', SK:'🇸🇰', HU:'🇭🇺', RO:'🇷🇴', BG:'🇧🇬', HR:'🇭🇷' };

    area.innerHTML = `
      ${userName ? `<div style="font-size:13px;font-weight:700;margin-bottom:12px;color:var(--text2)">👤 ${escHtml(userName)}</div>` : ''}
      ${results.map(geo => `
        <div class="geoip-card">
          <div style="display:flex;align-items:center;gap:10px">
            <span class="geoip-flag">${geo.local ? '🏠' : (countryFlags[geo.country_code] || '🌐')}</span>
            <div>
              <div style="font-size:14px;font-weight:700">${geo.local ? 'Локальная сеть' : (geo.city||'—') + (geo.region ? ', ' + geo.region : '') + (geo.country_name ? ' · ' + geo.country_name : '')}</div>
              <div style="font-family:monospace;font-size:11px;color:var(--text3)">${geo.ip}</div>
            </div>
            ${geo.org && !geo.local ? `<div style="margin-left:auto;font-size:10px;color:var(--text3);text-align:right;max-width:140px">${escHtml(geo.org)}</div>` : ''}
          </div>
          ${!geo.local && !geo.error ? `<div class="geoip-info">
            <div class="geoip-field"><span class="geoip-label">Страна</span><span class="geoip-val">${geo.country_name||'—'}</span></div>
            <div class="geoip-field"><span class="geoip-label">Регион</span><span class="geoip-val">${geo.region||'—'}</span></div>
            <div class="geoip-field"><span class="geoip-label">Город</span><span class="geoip-val">${geo.city||'—'}</span></div>
            <div class="geoip-field"><span class="geoip-label">Провайдер</span><span class="geoip-val" style="font-size:10px">${geo.org||'—'}</span></div>
            <div class="geoip-field"><span class="geoip-label">Часовой пояс</span><span class="geoip-val">${geo.timezone||'—'}</span></div>
            <div class="geoip-field"><span class="geoip-label">Тип сети</span><span class="geoip-val">${geo.asn||'—'}</span></div>
          </div>` : geo.local ? '' : `<div style="font-size:11px;color:var(--text3);margin-top:6px">Не удалось определить</div>`}
          <div style="margin-top:8px;display:flex;gap:6px">
            <button class="adm-btn neutral" style="font-size:10px" onclick="navigator.clipboard.writeText('${geo.ip}');admToast('success','Скопировано','IP скопирован')">📋 Копировать IP</button>
            ${!geo.local ? `<button class="adm-btn danger" style="font-size:10px" onclick="admAddIPBanDirect('${geo.ip}')">🔒 IP-бан</button>` : ''}
          </div>
        </div>
      `).join('')}
    `;
  } catch(e) {
    area.innerHTML = `<div style="color:var(--red);padding:20px">Ошибка: ${e.message}</div>`;
  }
}

// ══════════════════════════════════
// 📡 LIVE FEED
// ══════════════════════════════════
let LIVE_FEED_PAUSED = false;
let LF_MSGS = 0, LF_JOINS = 0, LF_BANS = 0, LF_WARNS = 0;
let LIVE_FEED_ACTIVE = false;

function admStartLiveFeed() {
  if (LIVE_FEED_ACTIVE) return;
  LIVE_FEED_ACTIVE = true;
  // Hook into SSE events
  admPushFeed('join', '🟢', 'Live Feed запущен — мониторинг активен');
}

function admPushFeed(type, icon, text, user) {
  if (LIVE_FEED_PAUSED) return;
  const filter = document.getElementById('livefeed-filter');
  if (filter && filter.value && filter.value !== type) return;
  const container = document.getElementById('live-feed-container');
  if (!container) return;
  const time = new Date().toLocaleTimeString('ru', {hour:'2-digit',minute:'2-digit',second:'2-digit'});
  const item = document.createElement('div');
  item.className = 'live-feed-item ' + (type||'');
  item.innerHTML = `
    <div class="live-feed-icon">${icon}</div>
    <div class="live-feed-text">
      ${user ? `<strong>${escHtml(user)}</strong> — ` : ''}${escHtml(text)}
    </div>
    <div class="live-feed-time">${time}</div>
  `;
  container.insertBefore(item, container.firstChild);
  // Keep max 200 items
  while (container.children.length > 200) container.removeChild(container.lastChild);
  // Update counters
  if (type === 'msg') { LF_MSGS++; const el = document.getElementById('lf-msgs-count'); if(el) el.textContent = LF_MSGS; }
  if (type === 'join') { LF_JOINS++; const el = document.getElementById('lf-joins-count'); if(el) el.textContent = LF_JOINS; }
  if (type === 'ban') { LF_BANS++; const el = document.getElementById('lf-bans-count'); if(el) el.textContent = LF_BANS; }
  if (type === 'warn') { LF_WARNS++; const el = document.getElementById('lf-warns-count'); if(el) el.textContent = LF_WARNS; }
}

function admToggleFeedPause() {
  LIVE_FEED_PAUSED = !LIVE_FEED_PAUSED;
  const btn = document.getElementById('livefeed-pause-btn');
  if (btn) btn.textContent = LIVE_FEED_PAUSED ? '▶️ Продолжить' : '⏸ Пауза';
  admToast(LIVE_FEED_PAUSED ? 'warn' : 'success', LIVE_FEED_PAUSED ? '⏸ Пауза' : '▶️ Продолжен', 'Live Feed ' + (LIVE_FEED_PAUSED ? 'приостановлен' : 'возобновлён'));
}

function admClearFeed() {
  const c = document.getElementById('live-feed-container');
  if (c) c.innerHTML = '';
  LF_MSGS = LF_JOINS = LF_BANS = LF_WARNS = 0;
  ['lf-msgs-count','lf-joins-count','lf-bans-count','lf-warns-count'].forEach(id => { const el = document.getElementById(id); if(el) el.textContent = '0'; });
}

// Hook admin actions to live feed
const _origAdmConfirmBan = window.admConfirmBan;
if (typeof admConfirmBan === 'function') {
  const __origBan = admConfirmBan;
  window.admConfirmBan = async function() {
    admPushFeed('ban', '🚫', 'Выдан бан пользователю');
    return __origBan.apply(this, arguments);
  };
}

// ══════════════════════════════════
// 🛡️ AUTOMOD
// ══════════════════════════════════
let AUTOMOD_RULES = JSON.parse(localStorage.getItem('pz_automod_rules') || '[]');
let AUTOMOD_ENABLED = JSON.parse(localStorage.getItem('pz_automod_enabled') || 'true');
let AUTOMOD_STATS = { total: 0, today: 0, byAction: {} };

function admLoadAutomodRules() {
  AUTOMOD_RULES = JSON.parse(localStorage.getItem('pz_automod_rules') || '[]');
  AUTOMOD_ENABLED = JSON.parse(localStorage.getItem('pz_automod_enabled') || 'true');
  const toggle = document.getElementById('automod-enabled');
  if (toggle) toggle.checked = AUTOMOD_ENABLED;
  admRenderAutomodRules();
}

function admRenderAutomodRules() {
  const list = document.getElementById('automod-rules-list');
  const count = document.getElementById('automod-count');
  if (!list) return;
  if (count) count.textContent = AUTOMOD_RULES.length;
  if (!AUTOMOD_RULES.length) {
    list.innerHTML = '<div style="text-align:center;color:var(--text3);padding:30px;font-size:13px">Правил нет — сообщения не фильтруются</div>';
    return;
  }
  const actionLabels = { delete:'🗑 Удалить', warn:'⚠️ Варн', mute:'🔇 Мьют', ban:'🚫 Бан' };
  const matchLabels = { contains:'содержит', exact:'точно', regex:'регекс', startswith:'начинается' };
  list.innerHTML = AUTOMOD_RULES.map((r, i) => `
    <div class="automod-rule">
      <div class="automod-rule-word">${escHtml(r.word)}</div>
      <span style="font-size:10px;color:var(--text3)">${matchLabels[r.match]||r.match}</span>
      <span class="automod-action-badge ${r.action}">${actionLabels[r.action]||r.action}</span>
      <span style="font-size:10px;color:var(--text3);margin-left:auto">${r.hits||0} срабатываний</span>
      <button onclick="admAutomodRemove(${i})" style="background:none;border:none;color:var(--text3);cursor:pointer;font-size:16px;padding:2px 4px;line-height:1" title="Удалить правило">×</button>
    </div>
  `).join('');
}

function admAddAutomodRule() {
  const word = document.getElementById('automod-word').value.trim();
  const action = document.getElementById('automod-action').value;
  const match = document.getElementById('automod-match').value;
  if (!word) { admToast('warn', '⚠️', 'Введите слово или фразу'); return; }
  if (AUTOMOD_RULES.find(r => r.word === word)) { admToast('warn', 'Уже есть', 'Такое правило уже существует'); return; }
  AUTOMOD_RULES.push({ word, action, match, hits: 0, createdAt: Date.now() });
  localStorage.setItem('pz_automod_rules', JSON.stringify(AUTOMOD_RULES));
  document.getElementById('automod-word').value = '';
  admRenderAutomodRules();
  admToast('success', '✅ Добавлено', 'Правило «' + word + '» создано');

  // Also send to server
  api('POST', '/admin/automod/rules', { word, action, match }).catch(() => {});
}

function admAutomodRemove(i) {
  const rule = AUTOMOD_RULES[i];
  AUTOMOD_RULES.splice(i, 1);
  localStorage.setItem('pz_automod_rules', JSON.stringify(AUTOMOD_RULES));
  admRenderAutomodRules();
  admToast('success', '🗑 Удалено', 'Правило «' + (rule?.word||'') + '» удалено');
}

function admAutomodToggle(on) {
  AUTOMOD_ENABLED = on;
  localStorage.setItem('pz_automod_enabled', JSON.stringify(on));
  admToast(on ? 'success' : 'warn', on ? '🛡️ Автомод включён' : '⚠️ Автомод отключён', '');
}

function admAutomodClearAll() {
  if (!confirm('Удалить все правила автомодерации?')) return;
  AUTOMOD_RULES = [];
  localStorage.setItem('pz_automod_rules', JSON.stringify([]));
  admRenderAutomodRules();
  admToast('success', '🗑 Очищено', 'Все правила удалены');
}

const AUTOMOD_PRESETS = {
  spam: [
    { word: 'купить', action: 'warn', match: 'contains' },
    { word: 'заработок', action: 'warn', match: 'contains' },
    { word: 'https://t.me/', action: 'delete', match: 'contains' },
    { word: '@everyone', action: 'delete', match: 'exact' },
  ],
  links: [
    { word: 'http://', action: 'delete', match: 'contains' },
    { word: 'https://', action: 'delete', match: 'contains' },
    { word: '.ru/', action: 'delete', match: 'contains' },
  ],
  caps: [
    { word: '^[А-ЯA-Z\\s!?]{20,}$', action: 'delete', match: 'regex' },
  ],
  flood: [
    { word: 'аааа', action: 'delete', match: 'contains' },
    { word: '....', action: 'delete', match: 'contains' },
    { word: '!!!!', action: 'delete', match: 'contains' },
  ]
};

function admAutomodPreset(name) {
  const rules = AUTOMOD_PRESETS[name] || [];
  let added = 0;
  rules.forEach(r => {
    if (!AUTOMOD_RULES.find(x => x.word === r.word)) {
      AUTOMOD_RULES.push({ ...r, hits: 0, createdAt: Date.now() });
      added++;
    }
  });
  localStorage.setItem('pz_automod_rules', JSON.stringify(AUTOMOD_RULES));
  admRenderAutomodRules();
  admToast('success', '⚡ Пресет применён', 'Добавлено ' + added + ' правил');
}

// ══════════════════════════════════
// 🎖️ ROLES
// ══════════════════════════════════
let ADM_ROLES = JSON.parse(localStorage.getItem('pz_roles') || '{}');
let SELECTED_ROLE = 'none', ROLES_TARGET_UID = null;

function admLoadRoles() {
  ADM_ROLES = JSON.parse(localStorage.getItem('pz_roles') || '{}');
  const list = document.getElementById('roles-list');
  const count = document.getElementById('roles-count');
  const entries = Object.entries(ADM_ROLES).filter(([,r]) => r !== 'none');
  if (count) count.textContent = entries.length;
  if (!entries.length) {
    list.innerHTML = '<div style="text-align:center;color:var(--text3);padding:30px">Нет назначенных ролей</div>';
    return;
  }
  const roleIcons = { vip: '👑', mod: '🛡️', dev: '⚡', ghost: '👻' };
  const roleNames = { vip: 'VIP', mod: 'Модератор', dev: 'Разработчик', ghost: 'Призрак' };
  list.innerHTML = entries.map(([uid, role]) => `
    <div style="display:flex;align-items:center;gap:10px;padding:10px 14px;background:rgba(255,255,255,.02);border-radius:10px;border:1px solid var(--border);margin-bottom:6px">
      <span style="font-size:20px">${roleIcons[role]||'?'}</span>
      <div style="flex:1">
        <div style="font-size:12px;font-weight:700">UID: ${uid.slice(0,12)}...</div>
        <span class="role-badge ${role}">${roleIcons[role]} ${roleNames[role]||role}</span>
      </div>
      <button class="adm-btn neutral" style="font-size:10px" onclick="admRemoveRole('${uid}')">Снять</button>
    </div>
  `).join('');
}

async function admRoleFindUser() {
  const val = document.getElementById('roles-user-inp').value.trim();
  if (!val) return;
  try {
    const d = await api('GET', '/admin/users?q=' + encodeURIComponent(val.replace('@','')) + '&limit=1');
    if (!d.users || !d.users[0]) { admToast('warn', 'Не найден', 'Пользователь не существует'); return; }
    const u = d.users[0];
    ROLES_TARGET_UID = u.uid;
    const currentRole = ADM_ROLES[u.uid] || 'none';
    const preview = document.getElementById('roles-user-preview');
    preview.style.display = 'block';
    preview.innerHTML = `
      <div style="display:flex;align-items:center;gap:10px">
        <div class="adm-ava" style="flex-shrink:0">${(u.name||'?')[0]}</div>
        <div>
          <div style="font-size:13px;font-weight:700">${escHtml(u.name)}</div>
          <div style="font-size:11px;color:var(--text3)">${escHtml(u.username||u.uid)}</div>
        </div>
        <div style="margin-left:auto;font-size:12px;color:var(--text3)">Текущая роль: <strong style="color:var(--text2)">${currentRole}</strong></div>
      </div>
    `;
    // Select current role
    admSelectRole(currentRole, document.querySelector('.role-opt[data-role="' + currentRole + '"]'));
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

function admSelectRole(role, btn) {
  SELECTED_ROLE = role;
  document.querySelectorAll('.role-opt').forEach(b => b.classList.remove('on'));
  if (btn) btn.classList.add('on');
}

function admAssignRole() {
  if (!ROLES_TARGET_UID) { admToast('warn', '⚠️', 'Сначала найдите пользователя'); return; }
  ADM_ROLES[ROLES_TARGET_UID] = SELECTED_ROLE;
  localStorage.setItem('pz_roles', JSON.stringify(ADM_ROLES));
  // Send to server
  api('POST', '/admin/user-role', { uid: ROLES_TARGET_UID, role: SELECTED_ROLE }).catch(() => {});
  admToast('success', '🎖️ Роль назначена', 'Роль «' + SELECTED_ROLE + '» установлена');
  admLoadRoles();
}

function admRemoveRole(uid) {
  delete ADM_ROLES[uid];
  localStorage.setItem('pz_roles', JSON.stringify(ADM_ROLES));
  api('POST', '/admin/user-role', { uid, role: 'none' }).catch(() => {});
  admLoadRoles();
  admToast('success', '✅ Роль снята', '');
}

// ══════════════════════════════════
// 🎭 IMPERSONATE
// ══════════════════════════════════
function admOpenImpersonate(uid, name) {
  document.getElementById('imp-uid').value = uid;
  document.getElementById('imp-target-uid').value = '';
  document.getElementById('imp-text').value = '';
  document.getElementById('imp-preview').classList.remove('show');
  document.getElementById('adm-impersonate-modal').classList.add('on');
}

function admImpersonatePreview() {
  const text = document.getElementById('imp-text').value;
  const prev = document.getElementById('imp-preview');
  const prevText = document.getElementById('imp-preview-text');
  if (text.trim()) {
    prev.classList.add('show');
    prevText.textContent = text;
  } else {
    prev.classList.remove('show');
  }
}

async function admConfirmImpersonate() {
  const fromUid = document.getElementById('imp-uid').value;
  const targetVal = document.getElementById('imp-target-uid').value.trim();
  const text = document.getElementById('imp-text').value.trim();
  if (!targetVal) { admToast('warn', '⚠️', 'Укажите получателя'); return; }
  if (!text) { admToast('warn', '⚠️', 'Введите текст'); return; }
  try {
    // Resolve target
    let targetUid = targetVal;
    if (!targetVal.startsWith('u_')) {
      const d = await api('GET', '/admin/users?q=' + encodeURIComponent(targetVal.replace('@','')) + '&limit=1');
      if (d.users && d.users[0]) targetUid = d.users[0].uid;
    }
    await api('POST', '/admin/impersonate', { fromUid, text, targetUid });
    document.getElementById('adm-impersonate-modal').classList.remove('on');
    admToast('success', '🎭 Отправлено', 'Сообщение отправлено под маскировкой');
    admPushFeed('warn', '🎭', 'Использована маскировка — инъекция сообщения');
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ══════════════════════════════════
// 👻 SHADOW MUTE
// ══════════════════════════════════
function admOpenShadowMute(uid, name) {
  document.getElementById('shadowmute-uid').value = uid;
  document.getElementById('shadowmute-name-hint').textContent = name;
  document.getElementById('adm-shadowmute-modal').classList.add('on');
}

async function admConfirmShadowMute() {
  const uid = document.getElementById('shadowmute-uid').value;
  const hours = parseInt(document.getElementById('shadowmute-duration').value) || 0;
  try {
    await api('POST', '/admin/shadow-mute', { uid, hours });
    document.getElementById('adm-shadowmute-modal').classList.remove('on');
    admToast('success', '👻 Теневой мьют применён', hours ? 'На ' + hours + ' часов' : 'Навсегда');
    admPushFeed('ban', '👻', 'Применён теневой мьют');
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

// ══════════════════════════════════
// 🔗 Hook SSE events to Live Feed
// ══════════════════════════════════
// Intercept admin actions
const _admToastOrig = admToast;
window.admToast = function(type, title, text) {
  _admToastOrig(type, title, text);
  // Mirror significant events to live feed
  if (type === 'success' && title.includes('Бан')) admPushFeed('ban', '🚫', title + ': ' + text);
  if (type === 'success' && title.includes('кик')) admPushFeed('leave', '👢', title + ': ' + text);
  if (type === 'success' && title.includes('Варн')) admPushFeed('warn', '⚠️', title + ': ' + text);
};

// ══════════════════════════════════
// Hook SSE to live feed
// ══════════════════════════════════
const _origHandleSSE = window.handleSSEEvent;
if (typeof handleSSEEvent === 'function') {
  window.handleSSEEvent = function(event, data) {
    // Forward to live feed
    if (event === 'presence') {
      if (data.status === 'online') admPushFeed('join', '🟢', 'Онлайн', data.name || data.uid);
      else if (data.status === 'offline') admPushFeed('leave', '⚫', 'Оффлайн', data.name || data.uid);
    }
    if (event === 'message') admPushFeed('msg', '💬', (data.text||'[медиа]').slice(0,60), data.fromName);
    return _origHandleSSE ? _origHandleSSE.apply(this, arguments) : undefined;
  };
}

// Patch users render to show role badges and shadow mute
const _origAdmRenderUsers = window.admRenderUsers;
if (typeof admRenderUsers === 'function') {
  window.admRenderUsers = function(users) {
    ADM_ROLES = JSON.parse(localStorage.getItem('pz_roles') || '{}');
    _origAdmRenderUsers(users);
    // After render, inject role badges
    setTimeout(() => {
      users.forEach(u => {
        const role = ADM_ROLES[u.uid];
        if (!role || role === 'none') return;
        const roleIcons = { vip: '👑', mod: '🛡️', dev: '⚡', ghost: '👻' };
        // Find name cell and add badge
        const rows = document.querySelectorAll('#adm-users-tbody tr');
        rows.forEach(row => {
          if (row.innerHTML.includes(u.uid)) {
            const nameCell = row.querySelector('td:first-child');
            if (nameCell && !nameCell.querySelector('.role-badge')) {
              const badge = document.createElement('span');
              badge.className = 'role-badge ' + role;
              badge.textContent = roleIcons[role];
              badge.title = role;
              badge.style.marginLeft = '6px';
              const nameEl = nameCell.querySelector('strong');
              if (nameEl) nameEl.appendChild(badge);
            }
          }
        });
      });
    }, 100);
  };
}

// ══════════════════════════════════
// ✅ VERIFIED BADGES (ГАЛОЧКИ)
// ══════════════════════════════════
let VERIFY_TARGET_UID = null;

async function admFindVerifyUser() {
  const val = document.getElementById('verify-user-inp').value.trim();
  if (!val) return;
  try {
    const d = await api('GET', '/admin/users?q=' + encodeURIComponent(val.replace('@','')) + '&limit=1');
    if (!d.users || !d.users[0]) { admToast('warn', 'Не найден', 'Пользователь не существует'); return; }
    const u = d.users[0];
    VERIFY_TARGET_UID = u.uid;
    const isVerifiedNow = VERIFIED_USERS.has(u.uid);
    const preview = document.getElementById('verify-user-preview');
    preview.style.display = 'block';
    preview.innerHTML = `
      <div style="display:flex;align-items:center;gap:10px">
        <div class="adm-ava" style="flex-shrink:0">${(u.name||'?')[0]}</div>
        <div>
          <div style="font-size:13px;font-weight:700;display:flex;align-items:center;gap:6px">
            ${escHtml(u.name)}
            ${isVerifiedNow ? '<div class="verified-badge" style="width:14px;height:14px"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>' : ''}
          </div>
          <div style="font-size:11px;color:var(--text3)">${escHtml(u.username||u.uid)}</div>
        </div>
        <div style="margin-left:auto;font-size:12px;color:var(--text3)">
          Галочка: <strong style="color:${isVerifiedNow?'var(--green)':'var(--red)'}">
            ${isVerifiedNow ? '✅ Есть' : '❌ Нет'}
          </strong>
        </div>
      </div>
    `;
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admVerifyUser(grant) {
  if (!VERIFY_TARGET_UID) { admToast('warn', '⚠️', 'Сначала найдите пользователя'); return; }
  try {
    await api('POST', '/admin/verified', { uid: VERIFY_TARGET_UID, verified: grant });
    if (grant) {
      VERIFIED_USERS.add(VERIFY_TARGET_UID);
    } else {
      VERIFIED_USERS.delete(VERIFY_TARGET_UID);
    }
    // Update contacts in memory
    const contact = typeof CONTACTS !== 'undefined' ? CONTACTS.find(c => c.id === VERIFY_TARGET_UID) : null;
    if (contact) contact.verified = grant;
    // Re-render chat list
    if (typeof renderChatList === 'function') renderChatList(CONTACTS);
    admToast('success', grant ? '✅ Галочка выдана' : '❌ Галочка снята', '');
    admLoadVerifiedList();
    // Re-find user to update preview
    admFindVerifyUser();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

async function admLoadVerifiedList() {
  try {
    const d = await api('GET', '/admin/verified-list');
    const verified = d.verified || [];
    VERIFIED_USERS = new Set(verified);
    const cnt = document.getElementById('verified-count');
    const list = document.getElementById('verified-list');
    if (!list) return;
    if (cnt) cnt.textContent = verified.length;
    if (!verified.length) {
      list.innerHTML = '<div style="text-align:center;color:var(--text3);padding:20px;font-size:12px">Нет верифицированных</div>';
      return;
    }
    list.innerHTML = verified.map(uid => `
      <div style="display:flex;align-items:center;gap:10px;padding:8px 12px;background:rgba(79,195,247,.04);border-radius:10px;border:1px solid rgba(79,195,247,.15);margin-bottom:6px">
        <div class="verified-badge" style="width:16px;height:16px;flex-shrink:0"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>
        <div style="flex:1;font-size:12px;font-family:monospace;color:var(--text2)">${uid}</div>
        <button class="adm-btn danger" style="font-size:10px;padding:3px 10px" onclick="admQuickUnverify('${uid}')">Снять</button>
      </div>
    `).join('');
  } catch {}
}

async function admQuickUnverify(uid) {
  try {
    await api('POST', '/admin/verified', { uid, verified: false });
    VERIFIED_USERS.delete(uid);
    const contact = typeof CONTACTS !== 'undefined' ? CONTACTS.find(c => c.id === uid) : null;
    if (contact) contact.verified = false;
    if (typeof renderChatList === 'function') renderChatList(CONTACTS);
    admToast('success', '❌ Галочка снята', '');
    admLoadVerifiedList();
  } catch(e) { admToast('error', 'Ошибка', e.message); }
}

console.log('[ADMIN v3] Новые функции загружены: Шпион / Мульти-аккаунты / ГеоIP / Live Feed / Автомод / Роли / Маскировка / Теневой мьют / Верификация ✓');
</script>

</body>
</html>